<!DOCTYPE html> <html lang=en data-darkreader-mode=dynamic data-darkreader-scheme=dark autocopy=true style><!--
 Page saved with SingleFile 
 url: https://getbookmarklets.com/ 
 saved date: Sun Oct 12 2025 18:11:42 GMT-0700 (Pacific Daylight Time)
--><meta charset=utf-8><style class="darkreader darkreader--user-agent" media=screen>@layer{html{background-color:var(--darkreader-background-ffffff,#181a1b)!important}html{color-scheme:dark!important}iframe{color-scheme:dark!important}html,body{background-color:var(--darkreader-background-ffffff,#181a1b)}html,body{border-color:var(--darkreader-border-4c4c4c,#736b5e);color:var(--darkreader-text-000000,#e8e6e3)}a{color:var(--darkreader-text-0040ff,#3391ff)}table{border-color:var(--darkreader-border-808080,#545b5e)}mark{color:var(--darkreader-text-000000,#e8e6e3)}::placeholder{color:var(--darkreader-text-a9a9a9,#b2aba1)}input:-webkit-autofill,textarea:-webkit-autofill,select:-webkit-autofill{background-color:var(--darkreader-background-faffbd,#404400)!important;color:var(--darkreader-text-000000,#e8e6e3)!important}::selection{background-color:var(--darkreader-background-0060d4,#004daa)!important;color:var(--darkreader-text-ffffff,#e8e6e3)!important}::-moz-selection{background-color:var(--darkreader-background-0060d4,#004daa)!important;color:var(--darkreader-text-ffffff,#e8e6e3)!important}}</style><style class="darkreader darkreader--variables" media=screen>:root{--darkreader-neutral-background:var(--darkreader-background-ffffff,#181a1b);--darkreader-neutral-text:var(--darkreader-text-000000,#e8e6e3);--darkreader-selection-background:var(--darkreader-background-0060d4,#004daa);--darkreader-selection-text:var(--darkreader-text-ffffff,#e8e6e3)}</style>
<title>Get Bookmarklets | https://getbookmarklets.com/</title>
<style>html{font-size:14px}body{margin:0;padding:0;font-family:DM Sans,sans-serif;display:flex;flex-direction:column;min-height:100vh;align-items:stretch;--primary-color:#1761a7;--primary-hover-color:#004f99;--secondary-color:#EBF7FF;--secondary-hover-color:#e1f4ff}.box{background-color:white;border-radius:2rem;box-shadow:0 0.5rem 1.5rem 0 rgba(6,81,126,0.18);padding:2rem}</style><style class="darkreader darkreader--sync" media=screen>body{--darkreader-bg--primary-color:var(--darkreader-background-1761a7,#124e86);--darkreader-bg--primary-hover-color:var(--darkreader-background-004f99,#003f7a);--secondary-color:#EBF7FF;--secondary-hover-color:#e1f4ff}.box{background-color:var(--darkreader-background-ffffff,#181a1b);box-shadow:var(--darkreader-background-06517e2e,rgba(5,65,101,0.18)) 0px 0.5rem 1.5rem 0px}</style>
<meta name=viewport content="width=device-width">
<style>span.svelte-raupzi{color:#06517e;font-family:Roboto,sans-serif;font-size:2rem;font-style:normal;font-weight:700}header.svelte-139cmml{padding:0 1em 0 0;display:flex;gap:2em;justify-content:space-between;align-items:center}.logo_links.svelte-139cmml{display:flex;align-items:stretch;overflow:auto}.logo.svelte-139cmml{padding:1em}.logo.svelte-139cmml>a:where(.svelte-139cmml){text-decoration:none}.logo.svelte-139cmml>a:where(.svelte-139cmml):hover{opacity:.8}#content.svelte-139cmml{background:#2c4657;padding:2rem;flex-grow:1}a.svelte-139cmml{color:#333}footer.svelte-139cmml{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:1rem;padding:1rem;font-size:large}.social.svelte-139cmml{display:flex;gap:1rem}</style><style class="darkreader darkreader--sync" media=screen>span.svelte-raupzi{color:var(--darkreader-text-06517e,#76c8f8)}.logo.svelte-139cmml>a:where(.svelte-139cmml){text-decoration-color:currentcolor}#content.svelte-139cmml{background-color:var(--darkreader-background-2c4657,#233846);background-image:none}a.svelte-139cmml{color:var(--darkreader-text-333333,#c8c3bc)}</style>
<style>div.svelte-unqhbb{background-color:var(--background-color);padding:1.2rem;border:0;cursor:pointer;color:var(--color);text-align:center;font-size:1rem;font-weight:700;border-radius:.4rem;box-shadow:0 .3rem .9rem #06517e2e}div.svelte-unqhbb:not([disabled=true]):hover{background-color:var(--background-hover-color)}div[disabled=true].svelte-unqhbb{opacity:.5;cursor:not-allowed}a.svelte-1xwhxdh{text-decoration:none;display:block}</style><style class="darkreader darkreader--sync" media=screen>div.svelte-unqhbb{background-color:var(--darkreader-bg--background-color,var(--darkreader-background-ffffff,#181a1b));border-color:currentcolor;color:var(--darkreader-text--color,var(--darkreader-text-000000,#e8e6e3));box-shadow:var(--darkreader-background-06517e2e,rgba(5,65,101,0.18)) 0px 0.3rem 0.9rem}div.svelte-unqhbb:not([disabled="true"]):hover{background-color:var(--darkreader-bg--background-hover-color,var(--darkreader-background-ffffff,#181a1b))}a.svelte-1xwhxdh{text-decoration-color:currentcolor}</style>
<style>#content:has(.introduction){background:#fff;padding:0}.introduction.svelte-1dueqvt{padding:2rem}.introduction.svelte-1dueqvt>div:where(.svelte-1dueqvt){max-width:1000px;margin:auto}.scripts.svelte-1dueqvt{background:#2c4657;padding:2rem}.scripts.svelte-1dueqvt>div:where(.svelte-1dueqvt){display:flex;flex-direction:column;gap:1rem;max-width:1000px;margin:auto}.scripts.svelte-1dueqvt .box:where(.svelte-1dueqvt){display:flex;flex-direction:column;gap:1rem}li.svelte-1dueqvt:has(code){line-height:2}li.svelte-1dueqvt:has(code) code:where(.svelte-1dueqvt){background-color:#c7c7c7;padding:.2rem .5rem}summary.svelte-1dueqvt{text-decoration:underline}</style><style class="darkreader darkreader--sync" media=screen>#content:has(.introduction){background-color:var(--darkreader-background-ffffff,#181a1b);background-image:none}.scripts.svelte-1dueqvt{background-color:var(--darkreader-background-2c4657,#233846);background-image:none}li.svelte-1dueqvt:has(code) code:where(.svelte-1dueqvt){background-color:var(--darkreader-background-c7c7c7,#383c3f)}summary.svelte-1dueqvt{text-decoration-color:currentcolor}</style>
<style>details.svelte-27attn>summary{cursor:pointer;width:fit-content}details.svelte-27attn>summary>*{display:inline}details.svelte-27attn>summary:hover{opacity:.7}.install.svelte-nfnxt8{display:flex;gap:1rem;flex-wrap:wrap}span.label.svelte-nfnxt8:after{content:"Install bookmarklet";color:#fff;min-width:10rem}a:hover span.label.svelte-nfnxt8:after{content:"Drag to bookmarks"}span.name.svelte-nfnxt8{position:absolute;opacity:0;pointer-events:none}/*!-----------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.46.0(21007360cad28648bdf46282a2592cb47c3a7a6f)
 * Released under the MIT license
 * https://github.com/microsoft/vscode/blob/main/LICENSE.txt
 *-----------------------------------------------------------*/@keyframes codicon-spin{to{transform:rotate(1turn)}}@keyframes monaco-findInput-highlight-0{0%{background:#fdff00cc}to{background:transparent}}@keyframes monaco-findInput-highlight-1{0%{background:#fdff00cc}99%{background:transparent}}@keyframes monaco-findInput-highlight-dark-0{0%{background:#ffffff70}to{background:transparent}}@keyframes monaco-findInput-highlight-dark-1{0%{background:#ffffff70}99%{background:transparent}}@keyframes progress{0%{transform:translate(0) scaleX(1)}50%{transform:translate(2500%) scaleX(3)}to{transform:translate(4900%) scaleX(1)}}:root{--vscode-sash-size:4px;--vscode-sash-hover-size:4px}@keyframes monaco-cursor-smooth{0%,20%{opacity:1}60%,to{opacity:0}}@keyframes monaco-cursor-phase{0%,20%{opacity:1}90%,to{opacity:0}}@keyframes monaco-cursor-expand{0%,20%{transform:scaleY(1)}80%,to{transform:scaleY(0)}}@keyframes fadein{0%{opacity:0;visibility:visible}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeOut{0%{opacity:1}to{opacity:0}}/*!
  Theme: StackOverflow Dark
  Description: Dark theme as used on stackoverflow.com
  Author: stackoverflow.com
  Maintainer: @Hirse
  Website: https://github.com/StackExchange/Stacks
  License: MIT
  Updated: 2021-05-15

  Updated for @stackoverflow/stacks v0.64.0
  Code Blocks: /blob/v0.64.0/lib/css/components/_stacks-code-blocks.less
  Colors: /blob/v0.64.0/lib/css/exports/_stacks-constants-colors.less
*/.hljs-subst{color:#fff}.hljs-comment{color:#999}.hljs-attr,.hljs-doctag,.hljs-keyword{color:#88aece}.hljs-number,.hljs-type{color:#f08d49}.hljs-regexp,.hljs-string,.hljs-variable{color:#b5bd68}.hljs-meta{color:#88aece}.hljs-built_in,.hljs-literal,.hljs-title{color:#f08d49}.source_editor.svelte-1udr1bn{display:flex;flex-direction:column;gap:1rem}.source.svelte-1udr1bn{position:relative}.source.svelte-1udr1bn button:where(.svelte-1udr1bn){display:none;font-size:medium;color:#fff;position:absolute;top:.5rem;right:.5rem;padding:.5rem;border:2px dashed white;border-radius:.5rem;background-color:#1e1e1eb0;box-sizing:border-box;text-align:center;cursor:pointer}.source.svelte-1udr1bn:where(.svelte-1udr1bn):hover:has(code:not(:hover)) button:where(.svelte-1udr1bn){display:block}pre.svelte-1udr1bn{background-color:#1e1e1e;color:#fff;padding:1rem;border-radius:1em;overflow:auto;max-height:70vh;min-height:5rem;font-size:medium;margin:0}article.svelte-7rw83y{display:flex;flex-direction:column;gap:1rem}h1.svelte-7rw83y,p.svelte-7rw83y{margin:0}.title_row.svelte-7rw83y{display:flex;flex-direction:row;align-items:center;gap:1rem;align-self:stretch;overflow:hidden;flex-wrap:wrap}.title_row.svelte-7rw83y .title:where(.svelte-7rw83y){display:flex;flex-grow:1;text-overflow:ellipsis;overflow:hidden;flex-basis:15rem}.title_row.svelte-7rw83y .title:where(.svelte-7rw83y) a:where(.svelte-7rw83y){text-decoration:none}.title_row.svelte-7rw83y .title:where(.svelte-7rw83y) a:where(.svelte-7rw83y):where(.svelte-7rw83y):hover{opacity:.7}.title_row.svelte-7rw83y .title:where(.svelte-7rw83y) :where(.svelte-7rw83y){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.source_url.svelte-7rw83y{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.source_url.svelte-7rw83y span:where(.svelte-7rw83y){font-weight:700}.script-details{font-size:larger}.script-details>summary.source:before{content:"View "}.script-details>summary:not(.hidden)+*{margin-top:1rem}</style><style class="darkreader darkreader--sync" media=screen>span.label.svelte-nfnxt8::after{color:var(--darkreader-text-ffffff,#e8e6e3)}:root{--vscode-sash-size:4px;--vscode-sash-hover-size:4px}.hljs-subst{color:var(--darkreader-text-ffffff,#e8e6e3)}.hljs-comment{color:var(--darkreader-text-999999,#a8a095)}.hljs-attr,.hljs-doctag,.hljs-keyword{color:var(--darkreader-text-88aece,#88afce)}.hljs-number,.hljs-type{color:var(--darkreader-text-f08d49,#f19250)}.hljs-regexp,.hljs-string,.hljs-variable{color:var(--darkreader-text-b5bd68,#bac172)}.hljs-meta{color:var(--darkreader-text-88aece,#88afce)}.hljs-built_in,.hljs-literal,.hljs-title{color:var(--darkreader-text-f08d49,#f19250)}.source.svelte-1udr1bn button:where(.svelte-1udr1bn){color:var(--darkreader-text-ffffff,#e8e6e3);border-top-color:var(--darkreader-border-ffffff,#303436);border-right-color:var(--darkreader-border-ffffff,#303436);border-bottom-color:var(--darkreader-border-ffffff,#303436);border-left-color:var(--darkreader-border-ffffff,#303436);background-color:var(--darkreader-background-1e1e1eb0,rgba(23,24,25,0.69))}pre.svelte-1udr1bn{background-color:var(--darkreader-background-1e1e1e,#171819);color:var(--darkreader-text-ffffff,#e8e6e3)}.title_row.svelte-7rw83y .title:where(.svelte-7rw83y) a:where(.svelte-7rw83y){text-decoration-color:currentcolor}</style>
<style>button.svelte-rcq3hf{background-color:var(--background-color);width:100%;padding:1.2rem;border:0;cursor:pointer;color:var(--color);text-align:center;font-size:1rem;font-weight:700;border-radius:.4rem;box-shadow:0 .3rem .9rem #06517e2e}button.svelte-rcq3hf:not(:disabled):hover{background-color:var(--background-hover-color)}button.svelte-rcq3hf:disabled{opacity:.5;cursor:not-allowed}</style><style class="darkreader darkreader--sync" media=screen>button.svelte-rcq3hf{background-color:var(--darkreader-bg--background-color,var(--darkreader-background-ffffff,#181a1b));border-color:currentcolor;color:var(--darkreader-text--color,var(--darkreader-text-000000,#e8e6e3));box-shadow:var(--darkreader-background-06517e2e,rgba(5,65,101,0.18)) 0px 0.3rem 0.9rem}button.svelte-rcq3hf:not(:disabled):hover{background-color:var(--darkreader-bg--background-hover-color,var(--darkreader-background-ffffff,#181a1b))}</style>
<style>@keyframes monaco-cursor-smooth{0%,20%{opacity:1}60%,to{opacity:0}}@keyframes monaco-cursor-phase{0%,20%{opacity:1}90%,to{opacity:0}}@keyframes monaco-cursor-expand{0%,20%{transform:scaleY(1)}80%,to{transform:scaleY(0)}}:root{--vscode-sash-size:4px;--vscode-sash-hover-size:4px}@keyframes monaco-findInput-highlight-0{0%{background:#fdff00cc}to{background:transparent}}@keyframes monaco-findInput-highlight-1{0%{background:#fdff00cc}99%{background:transparent}}@keyframes monaco-findInput-highlight-dark-0{0%{background:#ffffff70}to{background:transparent}}@keyframes monaco-findInput-highlight-dark-1{0%{background:#ffffff70}99%{background:transparent}}@keyframes progress{0%{transform:translate(0) scaleX(1)}50%{transform:translate(2500%) scaleX(3)}to{transform:translate(4900%) scaleX(1)}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeOut{0%{opacity:1}to{opacity:0}}@keyframes codicon-spin{to{transform:rotate(360deg)}}@keyframes fadein{0%{opacity:0;visibility:visible}to{opacity:1}}</style><style class="darkreader darkreader--sync" media=screen>:root{--vscode-sash-size:4px;--vscode-sash-hover-size:4px}</style>
<meta name=darkreader content=c214e4ebe6e446ddb29fda9733419835><style class="darkreader darkreader--override" media=screen>::placeholder{opacity:0.5!important}:host{--d2l-border-color:var(--darkreader-bg--d2l-color-gypsum)!important;--d2l-button-icon-background-color-hover:var(--darkreader-bg--d2l-color-gypsum)!important;--d2l-color-ferrite:var(--darkreader-neutral-text)!important;--d2l-color-sylvite:var(--darkreader-bg--d2l-color-sylvite)!important;--d2l-dropdown-background-color:var(--darkreader-neutral-background)!important;--d2l-dropdown-border-color:var(--darkreader-border--d2l-color-mica)!important;--d2l-input-backgroud-color:var(--darkreader-neutral-background)!important;--d2l-menu-border-color:var(--darkreader-bg--d2l-color-gypsum)!important;--d2l-tooltip-background-color:var(--darkreader-neutral-background)!important;--d2l-tooltip-border-color:var(--darkreader-bg--d2l-color-gypsum)!important}</style><meta name=referrer content=no-referrer><link rel=icon href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAQAAABpN6lAAAAAAXNSR0IArs4c6QAABd1JREFUeNrtXdtt6zgQVQkuwSWkhJTgElxCSnAJLiEluASXkP+IYgQDgiAIAiEYEARBOLuL7N3cm3XGpI4moR9nvvITmENyzjyp5I477rjjjkhgl+nKbMw23f8uZms26couk+uFXZqnbGecgSgu25mnq1NEuk73BkHykq7tIrl82IXZiLsun4bnCz8L5sk4A04uVgmvj+bFYBZxZpNcFuzCbA1mlRf7kFwK0pV5M1CQpyR+2EW2M9CS7DlyZvgwemryEq0K7PIX19+kCszm/efdpAp+Ed5NqmAq4VkUqND8KzUK2DBzuEs8ECXh5XDocQoDWpQwviI7R3ESXoEO5zCg9jwNr4/Jl4iQ8HJ08MWACua8vJ20BHESXo0RYeh8zsE2+R8iJLwDekzBiENs1yCc8CwaCKBVkO6Td8RJeAUGcBhxiOMMhBOeRYsP6Kkg3UdJeCVGzIUeVlb1MjrCO2JeuDNcENXeC4RHQLwGTmv5D6E2/4AOOujkS/CgsvzAo08QHn0GNsrL5wmPR0swgfLyLRymYECDHAYWJY4edGgEmdn0hSy/nLj3TTBxFt9lBfxNn51IeP3JG12cV9mXkq4Ugh0dwhtRw3whLSQcv8MM2gc2upfRIZdodDoVbtSPP094o0eaQ8Kg7w2ma73o/uiV6BKhT4TnI75qIuGVMDCxK+D8/jtMgYMN8CmqL5ml5xTA3/9m0t4XMMGSo8FIGEEV+1+Rzk64VJ9crFZXAWYr78lIOzvhYv84CSWhANoAdoSzw8mHx2GJzCB5AQrK2eGlxoheNy1mnubZ/xEljIIcUOjmhLJn0UHlnR1edElQKna5WQkv0vYp6d/3pLOjL/ZBUwEqe5+j+CU8Xb7NUPObzgA9bNDCa3QYT/wXh5K4AIoKKCEigPIKHD2yhDb8AixUFdBAQjt7xWAMVEL2nBCgFVCTFQPeqtjljyqgUKsY1ESrFKGA0Ciw4SoG7PVydjFTJWAqC/RkxUBGy99/3g+wkFEKFQMejrcAfDZoONfBoVoiL7/nDEh9AG1Q9F+gw5wYYTkrwIfDpdfPbNHAoQeF8IoQ0rV+RQgDfhbFd7RNSxXhGj+LjnOF+ZSI/fEzkOtXhtOVAWcHwtsjChSo0OI8atYb5PPCx1ktey3UG6mqEN8ZoH8NjrDh/51PiPCtMQfBveHLpAXBBMkHeEOoqQIHOzn3WOk7xHbpk9gYAKovaGrg3eh3jPvNgVh0CMX4/vPjVsDrI9cPzJfKHKcAfv+D67bBRk+WgVCAYiwgd3P0YnhUBhVAZVSEAmj7L6uhRIMjuv+kRX2StDhPs9BlAeWxdz5zKBKochzAC99r3BPFcbo9hhe+17jWjQW0x995Ms11u0TlKNCRC+V7jVsYIh9AUiDf8cWXynLdjFC68iiLCCVLapKY7zZ8Uc0DNB5D7brDNT3THcAroBMn+/UniUfkTG2IJ8Hu5I9yOIQTnsrodLbTDYMEohoC2KHCGPP7AZICJPTKwzWW7w/kAyEJnf5gFb//vBEUoD9cw1WG9RVQ8k9nyL3GbF2YH5VxkNBLhMdnjVkHWL9DCGiFpzPozjA+AOI7hHKPG5sLhEe6uzz781XB3stsNWjgMEwkvAPxlpw6EVYgwBIev3zeDFqM0EKHPI6XBO2Cit4VCI9ifr5LTL9HqA3PLjiiHYodmz2AAz9gke7VH9g27nuuQRPb3vu+HNGCADFNmu0Ys8f3h8gq4EvksrwR8R55BngV8NOk29C958/Am8bjGSOqS3lNPl3Nn9o8wl7S9wSy3ZxFrS5OwmOuwYdU6CGhRQETJ+HN1yuSo4L7YxByQAeHEhYmXsLz8QpJiZ3wfMYnCImf8ObqGbrqz6ecc4tu4AM6gbbg0gjPL1/s2T12mYTn5xec7SC9ZMLz5gR3tYTnB7vMnq+W8PztQbq/0e/GfToJ7kYX/5tZXGe7G/x25IncwSbdG/c1y5vtlS7984l4ffzbPqzN5l3++etqjvsdd9xxFfgLb6Q29nbWlxEAAAAASUVORK5CYII="><style>.sf-hidden{display:none!important}</style><link rel=canonical href=https://getbookmarklets.com/><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"></head>
 <body data-sveltekit-preload-data=hover>
 <div style=display:contents><header class=svelte-139cmml><div class="logo_links svelte-139cmml"><div class="logo svelte-139cmml"><a href=https://getbookmarklets.com/ aria-label=logo class=svelte-139cmml><span class=svelte-raupzi>Get Bookmarklets</span></a></div></div> <div id=right-menu><a href=https://getbookmarklets.com/scripts/add class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled>Add Script</div></div></a></div></header> <div id=content class=svelte-139cmml><div class="introduction svelte-1dueqvt"><div class=svelte-1dueqvt><h1>Welcome!</h1> <p>This is a place to share bookmarklets.</p> <hr> <h2>How this site works</h2> <p>Scripts are saved as URLs.</p> <p>To add a script</p> <ol><li class=svelte-1dueqvt>Go to <a href=https://getbookmarklets.com/scripts/add>Add script</a>.</li> <li class=svelte-1dueqvt>Paste the URL of a RAW JavaScript file.</ol> <p>You can add optional metadata using userscript-like comments. <br>Supported tags:</p> <ul><li class=svelte-1dueqvt><code class=svelte-1dueqvt>// @name</code> – if not present, defaults to the URL's filename.</li> <li class=svelte-1dueqvt><code class=svelte-1dueqvt>// @description</code></li> <li class=svelte-1dueqvt><code class=svelte-1dueqvt>// @image</code> – URL to an image that will be displayed on this site. You can add multiple images.</li> <li class=svelte-1dueqvt><code class=svelte-1dueqvt>// @video</code> – URL to a video. You can add many.</ul> <details class=svelte-27attn><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=svelte-1dueqvt><h2>What, How, Why?</h2></summary> <h3>What are Bookmarklets?</h3> <p>They are small JavaScript programs stored as browser bookmarks.</p> <p>When you click the bookmark, the code runs on the current web page, to do things like:</p> <ul><li class=svelte-1dueqvt>modify the page</li> <li class=svelte-1dueqvt>automate actions</li> <li class=svelte-1dueqvt>extract information.</ul> <h3>How to install a bookmarklet</h3> <p>There are multiple ways:</p> <ul><li class=svelte-1dueqvt>Drag the <strong>Install</strong> button to your browser's bookmarks toolbar.</li> <li class=svelte-1dueqvt>(Firefox only) Right-click the <strong>Install</strong> button and select <strong>"Bookmark link"</strong>.</li> <li class=svelte-1dueqvt>Manually add a new bookmark. Right-click the <strong>Install</strong> button and select <strong>"Copy link address"</strong>, then create a new bookmark and paste the URL in the URL field.</ul> <h3>Why bookmarklets?</h3> <p>Bookmarklets and Userscripts should ideally be implemented as Web Extensions, but verifying that extensions <i>only do</i> what they claim is hard. Although permissions aim to address this issue, they are too broad. So often, a better option is to read and verify the code ourselves.</p> <p>However, verifying extensions has two challenges: <strong>1.</strong> Learning how extensions work and its APIs <strong>2.</strong> Accessing the source code. Especially relevant for extensions that can be written as a one-line bookmarklet, it's harder to verify them than to write them as a bookmarklet.</p> <p>Narrowing permissions' scope would help, but it requires significant coordination and effort, making it feasible only for the most common requested permissions.</p> <p>Extension platforms should make it easy to read the code, it's the best way to tell what an extension can do. But until then, bookmarklets and userscripts remain better options for many tasks.</p></details></div></div> <div class="scripts svelte-1dueqvt"><div class=svelte-1dueqvt><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://gist.githubusercontent.com/rmtbb/e42d870a59a7f98091e734674831072b/raw/969070d210c72cb58b63b4ccb60949e75339a4bc/ChatGPT%20Canvas%20HTML%20Renderer%20from%20Clipboard.url title="ChatGPT Canvas HTML Renderer From Clipboard" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>ChatGPT Canvas HTML Renderer From Clipboard</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">ChatGPT Canvas HTML Renderer From Clipboard</span></div></div></a> <a href=https://gist.githubusercontent.com/rmtbb/e42d870a59a7f98091e734674831072b/raw/969070d210c72cb58b63b4ccb60949e75339a4bc/ChatGPT%20Canvas%20HTML%20Renderer%20from%20Clipboard.url class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://gist.githubusercontent.com/rmtbb/e42d870a59a7f98091e734674831072b/raw/969070d210c72cb58b63b4ccb60949e75339a4bc/ChatGPT%20Canvas%20HTML%20Renderer%20from%20Clipboard.url rel=nofollow class=svelte-7rw83y>https://gist.githubusercontent.com/rmtbb/e42d870a59a7f98091e734674831072b/raw/969070d210c72cb58b63b4ccb60949e75339a4bc/ChatGPT Canvas HTML Renderer from Clipboard.url</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript>(<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>try</span> {
        navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">readText</span>().<span class="hljs-title function_">then</span>(<span class=hljs-keyword>function</span>(<span class=hljs-params>t</span>) {
            <span class=hljs-keyword>if</span> (t) {
                <span class=hljs-keyword>var</span> e = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">open</span>(<span class=hljs-string>""</span>, <span class=hljs-string>"_blank"</span>, <span class=hljs-string>"width=800,height=600"</span>);
                e.<span class=hljs-property>document</span>.<span class="hljs-title function_">open</span>(), e.<span class=hljs-property>document</span>.<span class="hljs-title function_">write</span>(t), e.<span class=hljs-property>document</span>.<span class="hljs-title function_">close</span>()
            } <span class=hljs-keyword>else</span> <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Clipboard is empty. Please copy some text to the clipboard first."</span>)
        }).<span class="hljs-title function_">catch</span>(<span class=hljs-keyword>function</span>(<span class=hljs-params>t</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Failed to read clipboard contents: "</span>, t), <span class="hljs-title function_">alert</span>(<span class=hljs-string>"An error occurred while trying to access the clipboard. Please ensure your browser allows clipboard access."</span>)
        })
    } <span class=hljs-keyword>catch</span> (t) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"An error occurred:"</span>, t), <span class="hljs-title function_">alert</span>(<span class=hljs-string>"An error occurred while trying to open the new window with the clipboard content."</span>)
    }
})(); <span class=hljs-comment>//bookmarklet_title: HTML Preview from Clipboard</span></code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/userscripts/Ask%20Claude.user.js title="Ask Claude" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Ask Claude</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Ask Claude</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/userscripts/Ask%20Claude.user.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Add menu options to process selected text using Claude's API with different prompts. I DO NOT RECOMMEND using this as a bookmarklet, you will be exposing your API keys to the webpage.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/userscripts/Ask%20Claude.user.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/userscripts/Ask Claude.user.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary>Show Media</summary></details> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// ==UserScript==</span>
<span class=hljs-comment>// @name         Ask Claude</span>
<span class=hljs-comment>// @version      0.1</span>
<span class=hljs-comment>// @description  Add menu options to process selected text using Claude's API with different prompts. I DO NOT RECOMMEND using this as a bookmarklet, you will be exposing your API keys to the webpage.</span>
<span class=hljs-comment>// @video        https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/userscripts/Summarize%20with%20claude.mp4</span>
<span class=hljs-comment>// @match        *://*/*</span>
<span class=hljs-comment>// @grant        GM.xmlHttpRequest</span>
<span class=hljs-comment>// @grant        GM.getValue</span>
<span class=hljs-comment>// @grant        GM.setValue</span>
<span class=hljs-comment>// @grant        GM.registerMenuCommand</span>
<span class=hljs-comment>// @inject-into  content</span>
<span class=hljs-comment>// ==/UserScript==</span>
<span class=hljs-meta>
'use strict'</span>;

<span class=hljs-keyword>const</span> <span class="hljs-variable constant_">CLAUDE_API_ENDPOINT</span> = <span class=hljs-string>"https://api.anthropic.com/v1/messages"</span>;
<span class=hljs-keyword>const</span> <span class="hljs-variable constant_">MODEL</span> = <span class=hljs-string>"claude-3-5-sonnet-20240620"</span>;
<span class=hljs-keyword>const</span> <span class="hljs-variable constant_">MAX_TOKENS</span> = <span class=hljs-number>4096</span>;

<span class=hljs-comment>// Define different configurations for various commands</span>
<span class=hljs-keyword>const</span> <span class="hljs-variable constant_">COMMANDS</span> = [{
        <span class=hljs-attr>name</span>: <span class=hljs-string>"Summarize"</span>,
        <span class=hljs-attr>getSystemPrompt</span>: <span class=hljs-function>() =&gt;</span> <span class=hljs-string>"What are the questions that this text tries to answer? Capture the main points and core meaning of the text.\n\nWhen formulating your questions:\n\na. Address the central theme or argument\nb. Identify key supporting ideas\nc. Highlight facts and evidences\nd. Reveal the author's purpose or perspective\ne. Explore any significant implications or conclusions\n\nAnswer all of your generated questions one-by-one in detail."</span>,
    },
    {
        <span class=hljs-attr>name</span>: <span class=hljs-string>"Ask"</span>,
        <span class=hljs-attr>getSystemPrompt</span>: <span class=hljs-function>() =&gt;</span> <span class="hljs-title function_">prompt</span>(<span class=hljs-string>"Enter a prompt for Claude:"</span>)
    },
];

<span class=hljs-comment>// Register menu commands</span>
<span class="hljs-variable constant_">COMMANDS</span>.<span class="hljs-title function_">forEach</span>(<span class=hljs-function><span class=hljs-params>command</span> =&gt;</span> {
    <span class="hljs-variable constant_">GM</span>.<span class="hljs-title function_">registerMenuCommand</span>(command.<span class=hljs-property>name</span>, <span class=hljs-function>() =&gt;</span> {
        <span class=hljs-keyword>const</span> selectedText = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>().<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">trim</span>();
        <span class=hljs-keyword>if</span> (!selectedText)
            <span class=hljs-keyword>return</span> <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Please select some text first."</span>);
        <span class="hljs-title function_">queryClaude</span>(selectedText, command.<span class="hljs-title function_">getSystemPrompt</span>());
    });
});

<span class=hljs-keyword>async</span> <span class=hljs-keyword>function</span> <span class="hljs-title function_">queryClaude</span>(<span class=hljs-params>prompt, systemPrompt</span>) {
    <span class=hljs-keyword>const</span> apiKey = <span class=hljs-keyword>await</span> <span class="hljs-title function_">getApiKey</span>();

    <span class=hljs-keyword>const</span> requestBody = {
        <span class=hljs-attr>model</span>: <span class="hljs-variable constant_">MODEL</span>,
        <span class=hljs-attr>max_tokens</span>: <span class="hljs-variable constant_">MAX_TOKENS</span>,
        <span class=hljs-attr>temperature</span>: <span class=hljs-number>0</span>,
        <span class=hljs-attr>system</span>: systemPrompt,
        <span class=hljs-attr>messages</span>: [{
            <span class=hljs-attr>role</span>: <span class=hljs-string>"user"</span>,
            <span class=hljs-attr>content</span>: [{
                <span class=hljs-attr>type</span>: <span class=hljs-string>"text"</span>,
                <span class=hljs-attr>text</span>: prompt
            }]
        }],
        <span class=hljs-attr>stream</span>: <span class=hljs-literal>true</span>
    };

    <span class=hljs-keyword>const</span> popover = <span class="hljs-title function_">displayPopover</span>(<span class=hljs-string>"Loading..."</span>);

    <span class=hljs-keyword>try</span> {
        <span class=hljs-keyword>const</span> response = <span class=hljs-keyword>await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-variable constant_">CLAUDE_API_ENDPOINT</span>, {
            <span class=hljs-attr>method</span>: <span class=hljs-string>'POST'</span>,
            <span class=hljs-attr>headers</span>: {
                <span class=hljs-string>'Content-Type'</span>: <span class=hljs-string>'application/json'</span>,
                <span class=hljs-string>'x-api-key'</span>: apiKey,
                <span class=hljs-string>'anthropic-version'</span>: <span class=hljs-string>'2023-06-01'</span>
            },
            <span class=hljs-attr>body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(requestBody)
        });

        <span class=hljs-keyword>if</span> (!response.<span class=hljs-property>ok</span>) {
            <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Error</span>(<span class=hljs-string>`HTTP error! status: <span class=hljs-subst>${response.status}</span>`</span>);
        }

        <span class=hljs-keyword>const</span> reader = response.<span class=hljs-property>body</span>.<span class="hljs-title function_">getReader</span>();
        <span class=hljs-keyword>const</span> decoder = <span class=hljs-keyword>new</span> <span class="hljs-title class_">TextDecoder</span>();
        <span class=hljs-keyword>let</span> accumulatedText = <span class=hljs-string>""</span>;

        <span class=hljs-keyword>while</span> (<span class=hljs-literal>true</span>) {
            <span class=hljs-keyword>const</span> {
                done,
                value
            } = <span class=hljs-keyword>await</span> reader.<span class="hljs-title function_">read</span>();
            <span class=hljs-keyword>if</span> (done) <span class=hljs-keyword>break</span>;

            <span class=hljs-keyword>const</span> chunk = decoder.<span class="hljs-title function_">decode</span>(value, {
                <span class=hljs-attr>stream</span>: <span class=hljs-literal>true</span>
            });
            <span class=hljs-keyword>const</span> lines = chunk.<span class="hljs-title function_">split</span>(<span class=hljs-string>'\n'</span>);

            <span class=hljs-keyword>for</span> (<span class=hljs-keyword>const</span> line <span class=hljs-keyword>of</span> lines) {
                <span class=hljs-keyword>if</span> (line.<span class="hljs-title function_">startsWith</span>(<span class=hljs-string>'data: '</span>)) {
                    <span class=hljs-keyword>const</span> data = line.<span class="hljs-title function_">slice</span>(<span class=hljs-number>6</span>);
                    <span class=hljs-keyword>if</span> (data !== <span class=hljs-string>'[DONE]'</span>) {
                        <span class=hljs-keyword>try</span> {
                            <span class=hljs-keyword>const</span> parsed = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);
                            <span class=hljs-keyword>if</span> (parsed.<span class=hljs-property>type</span> === <span class=hljs-string>'content_block_delta'</span> &amp;&amp; parsed.<span class=hljs-property>delta</span>.<span class=hljs-property>type</span> === <span class=hljs-string>'text_delta'</span>) {
                                accumulatedText += parsed.<span class=hljs-property>delta</span>.<span class=hljs-property>text</span>;
                                popover.<span class="hljs-title function_">update</span>(accumulatedText);
                            }
                        } <span class=hljs-keyword>catch</span> (e) {
                            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>'Error parsing JSON:'</span>, e);
                        }
                    }
                }
            }
        }
    } <span class=hljs-keyword>catch</span> (error) {
        <span class="hljs-title function_">alert</span>(<span class=hljs-string>`Error: <span class=hljs-subst>${error.message}</span>\n\n<span class=hljs-subst>${error.stack}</span>`</span>);
    }
};

<span class=hljs-keyword>async</span> <span class=hljs-keyword>function</span> <span class="hljs-title function_">getApiKey</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>const</span> apiKey = <span class=hljs-keyword>await</span> <span class="hljs-variable constant_">GM</span>.<span class="hljs-title function_">getValue</span>(<span class=hljs-string>"anthropicApiKey"</span>, <span class=hljs-string>""</span>);
    <span class=hljs-keyword>if</span> (!apiKey) {
        <span class=hljs-keyword>const</span> newApiKey = <span class="hljs-title function_">prompt</span>(<span class=hljs-string>"Enter your Anthropic API key:"</span>);
        <span class=hljs-keyword>if</span> (!newApiKey) <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Error</span>(<span class=hljs-string>"Empty API key"</span>);
        <span class=hljs-keyword>await</span> <span class="hljs-variable constant_">GM</span>.<span class="hljs-title function_">setValue</span>(<span class=hljs-string>"anthropicApiKey"</span>, newApiKey);
        <span class=hljs-keyword>return</span> newApiKey;
    }
    <span class=hljs-keyword>return</span> apiKey;
}

<span class=hljs-keyword>function</span> <span class="hljs-title function_">displayPopover</span>(<span class=hljs-params>text</span>) {
    <span class=hljs-keyword>const</span> popover = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'div'</span>);
    popover.<span class="hljs-title function_">setAttribute</span>(<span class=hljs-string>'popover'</span>, <span class=hljs-string>"auto"</span>);
    popover.<span class=hljs-property>style</span>.<span class=hljs-property>cssText</span> = <span class=hljs-string>`
        max-width: 80vw;
        max-height: 80vh;
        margin: auto;
        overflow: auto;
        z-index: 9999;
        padding: 1em;
        border: 2px solid black;
    `</span>;

    <span class=hljs-keyword>const</span> responsePre = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'pre'</span>);
    responsePre.<span class=hljs-property>textContent</span> = text;
    responsePre.<span class=hljs-property>style</span>.<span class=hljs-property>cssText</span> = <span class=hljs-string>`
        text-wrap: wrap;
    `</span>;

    popover.<span class="hljs-title function_">appendChild</span>(responsePre);
    <span class="hljs-variable language_">document</span>.<span class=hljs-property>documentElement</span>.<span class="hljs-title function_">appendChild</span>(popover);

    popover.<span class="hljs-title function_">showPopover</span>();

    <span class=hljs-keyword>return</span> {
        <span class="hljs-title function_">update</span>(<span class=hljs-params>newText</span>) {
            responsePre.<span class=hljs-property>textContent</span> = newText;
        },
        <span class="hljs-title function_">close</span>(<span class=hljs-params></span>) {
            <span class="hljs-variable language_">document</span>.<span class=hljs-property>documentElement</span>.<span class="hljs-title function_">removeChild</span>(popover);
        }
    }
}</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/bettysteger/playstation-adventskalender/refs/heads/main/code-redeem.js title="Code Redeem" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Code Redeem</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Code Redeem</span></div></div></a> <a href=https://raw.githubusercontent.com/bettysteger/playstation-adventskalender/refs/heads/main/code-redeem.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/bettysteger/playstation-adventskalender/refs/heads/main/code-redeem.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/bettysteger/playstation-adventskalender/refs/heads/main/code-redeem.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-keyword>async</span> <span class=hljs-keyword>function</span> <span class="hljs-title function_">redeemCodes</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>let</span> codes = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">prompt</span>(<span class=hljs-string>'Paste the codes here'</span>);
    <span class=hljs-keyword>if</span> (!codes || !codes.<span class=hljs-property>length</span>) {
        <span class=hljs-keyword>return</span>;
    }

    <span class=hljs-keyword>const</span> re = <span class=hljs-regexp>/^[A-Z0-9]{3}-[A-Z0-9]{3}-[A-Z0-9]{3}$/</span>; <span class=hljs-comment>// XXX-XXX-XXX</span>
    codes = codes.<span class="hljs-title function_">split</span>(<span class=hljs-regexp>/\s+/</span>).<span class="hljs-title function_">filter</span>(<span class=hljs-function><span class=hljs-params>code</span> =&gt;</span> re.<span class="hljs-title function_">test</span>(code));
    <span class=hljs-keyword>if</span> (!codes.<span class=hljs-property>length</span>) {
        <span class=hljs-keyword>return</span>;
    }

    <span class=hljs-keyword>for</span> (<span class=hljs-keyword>const</span> code <span class=hljs-keyword>of</span> codes) {
        <span class=hljs-keyword>let</span> menuBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'button[aria-label="Code einlösen"]'</span>);
        <span class=hljs-keyword>if</span> (!menuBtn) { <span class=hljs-comment>// mobile</span>
            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'a[data-href="redeem-code"]'</span>).<span class="hljs-title function_">click</span>();
        } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (!menuBtn.<span class=hljs-property>attributes</span>[<span class=hljs-string>'aria-describedby'</span>]) {
            menuBtn.<span class="hljs-title function_">click</span>();
            <span class=hljs-keyword>await</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Promise</span>(<span class=hljs-function><span class=hljs-params>resolve</span> =&gt;</span> <span class=hljs-built_in>setTimeout</span>(resolve, <span class=hljs-number>100</span>));
        }
        <span class=hljs-keyword>const</span> codeInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>'form-code-input'</span>) || <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>'redeem-code-input'</span>);
        codeInput.<span class=hljs-property>value</span> = code;
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'button[type="submit"][data-mn="redeem code"]'</span>).<span class="hljs-title function_">click</span>();
        <span class=hljs-keyword>await</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Promise</span>(<span class=hljs-function><span class=hljs-params>resolve</span> =&gt;</span> <span class=hljs-built_in>setTimeout</span>(resolve, <span class=hljs-number>1000</span>));
    }
}
<span class="hljs-title function_">redeemCodes</span>();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href="https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%3D%3DUserScript%3D%3D%0A%2F%2F%20%40name%20%20%20%20%20%20%20%20%20Discord%20Token%20Login%0A%2F%2F%20%40version%20%20%20%20%20%201.0%0A%2F%2F%20%40description%20%20A%20script%20for%20logging%20in%20with%20a%20Discord%20token%0A%2F%2F%20%40author%20%20%20%20%20%20%20KeiraOMG0%20%0A%2F%2F%20%40match%20%20%20%20%20%20%20%20https%3A%2F%2Fdiscord.com%2F*%0A%2F%2F%20%40grant%20%20%20%20%20%20%20%20none%0A%2F%2F%20%3D%3D%2FUserScript%3D%3D%0A%0A(function()%20%7B%0A%20%20%20%20'use%20strict'%3B%0A%0A%20%20%20%20function%20login()%20%7B%0A%20%20%20%20%20%20%20%20const%20token%20%3D%20prompt(%22Enter%20your%20token%3A%22)%3B%0A%20%20%20%20%20%20%20%20if%20(token)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20setInterval(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.body.appendChild(document.createElement('iframe')).contentWindow.localStorage.token%20%3D%20%60%24%7Btoken%7D%60%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%2050)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20location.reload()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%202500)%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alert(%22No%20token%20provided.%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20login()%3B%0A%7D)()%3B%0A" title="Discord Token Login" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Discord Token Login</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Discord Token Login</span></div></div></a> <a href="data:text/javascript,%2F%2F%20%3D%3DUserScript%3D%3D%0A%2F%2F%20%40name%20%20%20%20%20%20%20%20%20Discord%20Token%20Login%0A%2F%2F%20%40version%20%20%20%20%20%201.0%0A%2F%2F%20%40description%20%20A%20script%20for%20logging%20in%20with%20a%20Discord%20token%0A%2F%2F%20%40author%20%20%20%20%20%20%20KeiraOMG0%20%0A%2F%2F%20%40match%20%20%20%20%20%20%20%20https%3A%2F%2Fdiscord.com%2F*%0A%2F%2F%20%40grant%20%20%20%20%20%20%20%20none%0A%2F%2F%20%3D%3D%2FUserScript%3D%3D%0A%0A(function()%20%7B%0A%20%20%20%20'use%20strict'%3B%0A%0A%20%20%20%20function%20login()%20%7B%0A%20%20%20%20%20%20%20%20const%20token%20%3D%20prompt(%22Enter%20your%20token%3A%22)%3B%0A%20%20%20%20%20%20%20%20if%20(token)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20setInterval(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.body.appendChild(document.createElement('iframe')).contentWindow.localStorage.token%20%3D%20%60%24%7Btoken%7D%60%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%2050)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20location.reload()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%202500)%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alert(%22No%20token%20provided.%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20login()%3B%0A%7D)()%3B%0A" class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>A script for logging in with a Discord token</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href="data:text/javascript,%2F%2F%20%3D%3DUserScript%3D%3D%0A%2F%2F%20%40name%20%20%20%20%20%20%20%20%20Discord%20Token%20Login%0A%2F%2F%20%40version%20%20%20%20%20%201.0%0A%2F%2F%20%40description%20%20A%20script%20for%20logging%20in%20with%20a%20Discord%20token%0A%2F%2F%20%40author%20%20%20%20%20%20%20KeiraOMG0%20%0A%2F%2F%20%40match%20%20%20%20%20%20%20%20https%3A%2F%2Fdiscord.com%2F*%0A%2F%2F%20%40grant%20%20%20%20%20%20%20%20none%0A%2F%2F%20%3D%3D%2FUserScript%3D%3D%0A%0A(function()%20%7B%0A%20%20%20%20'use%20strict'%3B%0A%0A%20%20%20%20function%20login()%20%7B%0A%20%20%20%20%20%20%20%20const%20token%20%3D%20prompt(%22Enter%20your%20token%3A%22)%3B%0A%20%20%20%20%20%20%20%20if%20(token)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20setInterval(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.body.appendChild(document.createElement('iframe')).contentWindow.localStorage.token%20%3D%20%60%24%7Btoken%7D%60%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%2050)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20location.reload()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%202500)%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alert(%22No%20token%20provided.%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20login()%3B%0A%7D)()%3B%0A" rel=nofollow class=svelte-7rw83y>data:text/javascript,// ==UserScript==
// @name Discord Token Login
// @version 1.0
// @description A script for logging in with a Discord token
// @author KeiraOMG0 
// @match https://discord.com/*
// @grant none
// ==/UserScript==
(function() {
 'use strict';
 function login() {
 const token = prompt("Enter your token:");
 if (token) {
 setInterval(() =&gt; {
 document.body.appendChild(document.createElement('iframe')).contentWindow.localStorage.token = `${token}`;
 }, 50);
 setTimeout(() =&gt; {
 location.reload();
 }, 2500);
 } else {
 alert("No token provided.");
 }
 }
 login();
})();
</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// ==UserScript==</span>
<span class=hljs-comment>// @name         Discord Token Login</span>
<span class=hljs-comment>// @version      1.0</span>
<span class=hljs-comment>// @description  A script for logging in with a Discord token</span>
<span class=hljs-comment>// @author       KeiraOMG0 </span>
<span class=hljs-comment>// @match        https://discord.com/*</span>
<span class=hljs-comment>// @grant        none</span>
<span class=hljs-comment>// ==/UserScript==</span>

(<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-string>'use strict'</span>;

    <span class=hljs-keyword>function</span> <span class="hljs-title function_">login</span>(<span class=hljs-params></span>) {
        <span class=hljs-keyword>const</span> token = <span class="hljs-title function_">prompt</span>(<span class=hljs-string>"Enter your token:"</span>);
        <span class=hljs-keyword>if</span> (token) {
            <span class=hljs-built_in>setInterval</span>(<span class=hljs-function>() =&gt;</span> {
                <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'iframe'</span>)).<span class=hljs-property>contentWindow</span>.<span class=hljs-property>localStorage</span>.<span class=hljs-property>token</span> = <span class=hljs-string>`<span class=hljs-subst>${token}</span>`</span>;
            }, <span class=hljs-number>50</span>);
            <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> {
                location.<span class="hljs-title function_">reload</span>();
            }, <span class=hljs-number>2500</span>);
        } <span class=hljs-keyword>else</span> {
            <span class="hljs-title function_">alert</span>(<span class=hljs-string>"No token provided."</span>);
        }
    }

    <span class="hljs-title function_">login</span>();
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20Unnamed%0A%2F%2F%20%40description%20%0A%0A%2F%2F%20your%20code%20here%0Aalert(%22hi%22)%0A title=Unnamed data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Unnamed</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Unnamed</span></div></div></a> <a href=data:text/javascript,%2F%2F%20%40name%20Unnamed%0A%2F%2F%20%40description%20%0A%0A%2F%2F%20your%20code%20here%0Aalert(%22hi%22)%0A class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=data:text/javascript,%2F%2F%20%40name%20Unnamed%0A%2F%2F%20%40description%20%0A%0A%2F%2F%20your%20code%20here%0Aalert(%22hi%22)%0A rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name Unnamed
// @description 
// your code here
alert("hi")
</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Unnamed</span>
<span class=hljs-comment>// @description </span>

<span class=hljs-comment>// your code here</span>
<span class="hljs-title function_">alert</span>(<span class=hljs-string>"hi"</span>)</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href="https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20DrawBattle%20Spectator%20Bookmarklet%0A%2F%2F%20%40description%20Hides%20words%20and%20guesses%20while%20guessing%2C%20and%20allows%20you%20to%20modify%2Fstart%20the%20game%20as%20a%20spectator.%0A(function%20()%20%7B%0A%20%20%20%20var%20s%20%3D%20document.createElement('style')%3B%0A%20%20%20%20s.innerText%20%3D%20%22._wordChoiceButton_1lq6a_62%2C%20._headerWord_1ayx6_10%2C%20._guessText_pth0h_32%3Anot(._recap_16dww_121%20._guessText_pth0h_32)%2C%20._wordChoice_1i1b3_11%20%7B%20display%3A%20none%20%7D%22%3B%0A%20%20%20%20document.head.appendChild(s)%3B%0A%20%20%20%20const%20disabledElems%20%3D%20document.querySelectorAll('select%3Adisabled%2C%20button%3Adisabled%2C%20input%3Adisabled')%3B%0A%20%20%20%20disabledElems.forEach(elem%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20elem.disabled%20%3D%20false%3B%0A%20%20%20%20%7D)%3B%0A%20%20%20%20alert('Spectator%20features%20enabled!%20Words%20and%20guesses%20will%20be%20hidden%20while%20guessing%2C%20and%20you%20can%20modify%2Fstart%20the%20game%20as%20a%20spectator.')%3B%0A%7D)()%3B" title="DrawBattle Spectator Bookmarklet" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>DrawBattle Spectator Bookmarklet</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">DrawBattle Spectator Bookmarklet</span></div></div></a> <a href="data:text/javascript,%2F%2F%20%40name%20DrawBattle%20Spectator%20Bookmarklet%0A%2F%2F%20%40description%20Hides%20words%20and%20guesses%20while%20guessing%2C%20and%20allows%20you%20to%20modify%2Fstart%20the%20game%20as%20a%20spectator.%0A(function%20()%20%7B%0A%20%20%20%20var%20s%20%3D%20document.createElement('style')%3B%0A%20%20%20%20s.innerText%20%3D%20%22._wordChoiceButton_1lq6a_62%2C%20._headerWord_1ayx6_10%2C%20._guessText_pth0h_32%3Anot(._recap_16dww_121%20._guessText_pth0h_32)%2C%20._wordChoice_1i1b3_11%20%7B%20display%3A%20none%20%7D%22%3B%0A%20%20%20%20document.head.appendChild(s)%3B%0A%20%20%20%20const%20disabledElems%20%3D%20document.querySelectorAll('select%3Adisabled%2C%20button%3Adisabled%2C%20input%3Adisabled')%3B%0A%20%20%20%20disabledElems.forEach(elem%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20elem.disabled%20%3D%20false%3B%0A%20%20%20%20%7D)%3B%0A%20%20%20%20alert('Spectator%20features%20enabled!%20Words%20and%20guesses%20will%20be%20hidden%20while%20guessing%2C%20and%20you%20can%20modify%2Fstart%20the%20game%20as%20a%20spectator.')%3B%0A%7D)()%3B" class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Hides words and guesses while guessing, and allows you to modify/start the game as a spectator.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href="data:text/javascript,%2F%2F%20%40name%20DrawBattle%20Spectator%20Bookmarklet%0A%2F%2F%20%40description%20Hides%20words%20and%20guesses%20while%20guessing%2C%20and%20allows%20you%20to%20modify%2Fstart%20the%20game%20as%20a%20spectator.%0A(function%20()%20%7B%0A%20%20%20%20var%20s%20%3D%20document.createElement('style')%3B%0A%20%20%20%20s.innerText%20%3D%20%22._wordChoiceButton_1lq6a_62%2C%20._headerWord_1ayx6_10%2C%20._guessText_pth0h_32%3Anot(._recap_16dww_121%20._guessText_pth0h_32)%2C%20._wordChoice_1i1b3_11%20%7B%20display%3A%20none%20%7D%22%3B%0A%20%20%20%20document.head.appendChild(s)%3B%0A%20%20%20%20const%20disabledElems%20%3D%20document.querySelectorAll('select%3Adisabled%2C%20button%3Adisabled%2C%20input%3Adisabled')%3B%0A%20%20%20%20disabledElems.forEach(elem%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20elem.disabled%20%3D%20false%3B%0A%20%20%20%20%7D)%3B%0A%20%20%20%20alert('Spectator%20features%20enabled!%20Words%20and%20guesses%20will%20be%20hidden%20while%20guessing%2C%20and%20you%20can%20modify%2Fstart%20the%20game%20as%20a%20spectator.')%3B%0A%7D)()%3B" rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name DrawBattle Spectator Bookmarklet
// @description Hides words and guesses while guessing, and allows you to modify/start the game as a spectator.
(function () {
 var s = document.createElement('style');
 s.innerText = "._wordChoiceButton_1lq6a_62, ._headerWord_1ayx6_10, ._guessText_pth0h_32:not(._recap_16dww_121 ._guessText_pth0h_32), ._wordChoice_1i1b3_11 { display: none }";
 document.head.appendChild(s);
 const disabledElems = document.querySelectorAll('select:disabled, button:disabled, input:disabled');
 disabledElems.forEach(elem =&gt; {
 elem.disabled = false;
 });
 alert('Spectator features enabled! Words and guesses will be hidden while guessing, and you can modify/start the game as a spectator.');
})();</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name DrawBattle Spectator Bookmarklet</span>
<span class=hljs-comment>// @description Hides words and guesses while guessing, and allows you to modify/start the game as a spectator.</span>
(<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>var</span> s = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'style'</span>);
    s.<span class=hljs-property>innerText</span> = <span class=hljs-string>"._wordChoiceButton_1lq6a_62, ._headerWord_1ayx6_10, ._guessText_pth0h_32:not(._recap_16dww_121 ._guessText_pth0h_32), ._wordChoice_1i1b3_11 { display: none }"</span>;
    <span class="hljs-variable language_">document</span>.<span class=hljs-property>head</span>.<span class="hljs-title function_">appendChild</span>(s);
    <span class=hljs-keyword>const</span> disabledElems = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>'select:disabled, button:disabled, input:disabled'</span>);
    disabledElems.<span class="hljs-title function_">forEach</span>(<span class=hljs-function><span class=hljs-params>elem</span> =&gt;</span> {
        elem.<span class=hljs-property>disabled</span> = <span class=hljs-literal>false</span>;
    });
    <span class="hljs-title function_">alert</span>(<span class=hljs-string>'Spectator features enabled! Words and guesses will be hidden while guessing, and you can modify/start the game as a spectator.'</span>);
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20Unnamed%0A%2F%2F%20%40description%20%0A%0A%2F%2F%20your%20code%20here%0A%2F%2F%20your%20code%20here%0A%2F%2F%20your%20code%20here%0A title=Unnamed data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Unnamed</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Unnamed</span></div></div></a> <a href=data:text/javascript,%2F%2F%20%40name%20Unnamed%0A%2F%2F%20%40description%20%0A%0A%2F%2F%20your%20code%20here%0A%2F%2F%20your%20code%20here%0A%2F%2F%20your%20code%20here%0A class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=data:text/javascript,%2F%2F%20%40name%20Unnamed%0A%2F%2F%20%40description%20%0A%0A%2F%2F%20your%20code%20here%0A%2F%2F%20your%20code%20here%0A%2F%2F%20your%20code%20here%0A rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name Unnamed
// @description 
// your code here
// your code here
// your code here
</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Unnamed</span>
<span class=hljs-comment>// @description </span>

<span class=hljs-comment>// your code here</span>
<span class=hljs-comment>// your code here</span>
<span class=hljs-comment>// your code here</span></code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/go%20offline.js title="Go Offline" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Go Offline</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Go Offline</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/go%20offline.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Adds a restrictive policy to the page to block all connections and tries to stop open connections. Beware that this is not foolproof, it doesn't block already opened connections like websockets, it also doesn't affect some workers. Works better in Firefox.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/go%20offline.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/go offline.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Go Offline</span>
<span class=hljs-comment>// @description Adds a restrictive policy to the page to block all connections and tries to stop open connections. Beware that this is not foolproof, it doesn't block already opened connections like websockets, it also doesn't affect some workers. Works better in Firefox.</span>

(<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>const</span> meta = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'meta'</span>);
    meta.<span class=hljs-property>httpEquiv</span> = <span class=hljs-string>'Content-Security-Policy'</span>;
    meta.<span class=hljs-property>content</span> = <span class=hljs-string>"default-src 'unsafe-eval' data: blob:;"</span>;
    <span class="hljs-variable language_">document</span>.<span class=hljs-property>head</span>.<span class="hljs-title function_">appendChild</span>(meta);

    <span class=hljs-comment>/* stop open connections. In Firefox, this will also close many web sockets */</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">stop</span>();
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Convert%20images%20to%20base64%20DataURL%20markdown%20embedding.js title="Convert Images To Base64 DataURL Markdown Embedding" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Convert Images To Base64 DataURL Markdown Embedding</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Convert Images To Base64 DataURL Markdown Embedding</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Convert%20images%20to%20base64%20DataURL%20markdown%20embedding.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Convert%20images%20to%20base64%20DataURL%20markdown%20embedding.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Convert images to base64 DataURL markdown embedding.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript>(<span class=hljs-keyword>async</span> <span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>function</span> <span class="hljs-title function_">getBase64Image</span>(<span class=hljs-params>img</span>) {
        <span class=hljs-keyword>const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"canvas"</span>);
        <span class=hljs-keyword>const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class=hljs-string>"2d"</span>);
        ctx.<span class="hljs-title function_">drawImage</span>(img, <span class=hljs-number>0</span>, <span class=hljs-number>0</span>);
        <span class=hljs-keyword>const</span> dataURL = canvas.<span class="hljs-title function_">toDataURL</span>(<span class=hljs-string>"image/png"</span>);
        <span class=hljs-keyword>return</span> dataURL;
    }

    <span class=hljs-keyword>const</span> <span class="hljs-title function_">getBase64FromUrl</span> = <span class=hljs-keyword>async</span> (<span class=hljs-params>url</span>) =&gt; {
        <span class=hljs-keyword>const</span> data = <span class=hljs-keyword>await</span> <span class="hljs-title function_">fetch</span>(url);
        <span class=hljs-keyword>const</span> blob = <span class=hljs-keyword>await</span> data.<span class="hljs-title function_">blob</span>();
        <span class=hljs-keyword>return</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Promise</span>(<span class=hljs-function>(<span class=hljs-params>resolve</span>) =&gt;</span> {
            <span class=hljs-keyword>const</span> reader = <span class=hljs-keyword>new</span> <span class="hljs-title class_">FileReader</span>();
            reader.<span class="hljs-title function_">readAsDataURL</span>(blob);
            reader.<span class=hljs-property>onloadend</span> = <span class=hljs-function>() =&gt;</span> {
                <span class=hljs-keyword>const</span> base64data = reader.<span class=hljs-property>result</span>;
                <span class="hljs-title function_">resolve</span>(base64data);
            }
        });
    }

    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>'img'</span>).<span class="hljs-title function_">forEach</span>(<span class=hljs-keyword>async</span> img =&gt; {
        <span class=hljs-keyword>let</span> base64;
        <span class=hljs-keyword>try</span> {
            base64 = <span class="hljs-title function_">getBase64Image</span>(img);
        } <span class=hljs-keyword>catch</span> (error) {
            base64 = <span class=hljs-keyword>await</span> <span class="hljs-title function_">getBase64FromUrl</span>(img.<span class=hljs-property>src</span>);
        };
        <span class=hljs-keyword>const</span> markdown = <span class=hljs-string>`![<span class=hljs-subst>${img.alt}</span>](<span class=hljs-subst>${base64}</span>)`</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(markdown, img);
    })
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://gist.githubusercontent.com/thde/12c8e6f692c6fe6dbc38b37ef27dfa2b/raw/bb35d8c7943f65a52ca93d6b9bb1e9a45e0c7bbe/bandcamp-purchases-export.js title="Bandcamp Purchase Export" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Bandcamp Purchase Export</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Bandcamp Purchase Export</span></div></div></a> <a href=https://gist.githubusercontent.com/thde/12c8e6f692c6fe6dbc38b37ef27dfa2b/raw/bb35d8c7943f65a52ca93d6b9bb1e9a45e0c7bbe/bandcamp-purchases-export.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Allows to export Bandcamp purchases as a CSV file.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://gist.githubusercontent.com/thde/12c8e6f692c6fe6dbc38b37ef27dfa2b/raw/bb35d8c7943f65a52ca93d6b9bb1e9a45e0c7bbe/bandcamp-purchases-export.js rel=nofollow class=svelte-7rw83y>https://gist.githubusercontent.com/thde/12c8e6f692c6fe6dbc38b37ef27dfa2b/raw/bb35d8c7943f65a52ca93d6b9bb1e9a45e0c7bbe/bandcamp-purchases-export.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Bandcamp Purchase Export</span>
<span class=hljs-comment>// @description  Allows to export Bandcamp purchases as a CSV file.</span>

<span class=hljs-keyword>const</span> <span class="hljs-title function_">main</span> = <span class=hljs-keyword>async</span> (<span class=hljs-params></span>) =&gt; {
    <span class=hljs-keyword>const</span> currentRates = <span class="hljs-title function_">rates</span>(<span class=hljs-string>"CHF"</span>);
    <span class=hljs-keyword>await</span> <span class="hljs-title function_">loadAllPurchases</span>();

    <span class=hljs-keyword>const</span> allPurchases = <span class="hljs-title function_">purchases</span>(<span class=hljs-keyword>await</span> currentRates);
    <span class=hljs-keyword>if</span> (allPurchases.<span class=hljs-property>length</span> == <span class=hljs-number>0</span>) {
        <span class="hljs-title function_">alert</span>(
            <span class=hljs-string>"No purchase has been found on the current page!\nEnsure you're on Bandcamp's purchases page, before running this bookmarklet."</span>,
        );
        <span class=hljs-keyword>return</span>;
    }

    <span class="hljs-title function_">download</span>(<span class=hljs-string>"bandcamp-purchases.csv"</span>, <span class="hljs-title function_">convertToCSV</span>(allPurchases));
};

<span class=hljs-keyword>const</span> <span class="hljs-title function_">loadAllPurchases</span> = <span class=hljs-keyword>async</span> (<span class=hljs-params>timeoutMS = <span class=hljs-number>1000</span></span>) =&gt; {
    <span class=hljs-keyword>const</span> allButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".view-all-button"</span>);
    <span class=hljs-keyword>if</span> (allButton != <span class=hljs-literal>null</span>) {
        allButton.<span class="hljs-title function_">click</span>();
        <span class=hljs-keyword>await</span> <span class="hljs-title function_">sleep</span>(timeoutMS);
    }

    <span class=hljs-comment>// scroll to bottom of page to trigger loading of additional purchases</span>
    <span class=hljs-keyword>while</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>innerHeight</span> + <span class="hljs-variable language_">window</span>.<span class=hljs-property>scrollY</span> &lt; <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class=hljs-property>offsetHeight</span> - <span class=hljs-number>2</span>) {
        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">scrollTo</span>(<span class=hljs-number>0</span>, <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class=hljs-property>scrollHeight</span>, {
            <span class=hljs-attr>behavior</span>: <span class=hljs-string>"smooth"</span>
        });
        <span class=hljs-keyword>await</span> <span class="hljs-title function_">sleep</span>(timeoutMS);
    }
};

<span class=hljs-keyword>const</span> <span class="hljs-title function_">purchases</span> = (<span class=hljs-params>rates</span>) =&gt; [...<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>".purchases-item"</span>)].<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
    <span class=hljs-keyword>const</span> s = e
        .<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".purchases-item-total strong:last-child"</span>)
        .<span class=hljs-property>innerText</span>.<span class="hljs-title function_">split</span>(<span class=hljs-string>" "</span>);
    <span class=hljs-keyword>const</span> purchaseDate = <span class=hljs-keyword>new</span> <span class="hljs-title class_">Date</span>(
        e.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".purchases-item-date"</span>).<span class=hljs-property>innerText</span>.<span class="hljs-title function_">trim</span>(),
    );

    <span class=hljs-keyword>const</span> currency = s[<span class=hljs-number>1</span>].<span class="hljs-title function_">trim</span>();
    <span class=hljs-keyword>const</span> amount = <span class=hljs-built_in>parseFloat</span>(s[<span class=hljs-number>0</span>].<span class="hljs-title function_">replace</span>(<span class=hljs-regexp>/[^\d.-]/g</span>, <span class=hljs-string>""</span>));

    <span class=hljs-keyword>return</span> {
        <span class=hljs-attr>date</span>: purchaseDate.<span class="hljs-title function_">toLocaleDateString</span>(<span class=hljs-string>"de-CH"</span>),
        <span class=hljs-attr>currency</span>: rates.<span class=hljs-property>base</span>,
        <span class=hljs-attr>amount</span>: currency == rates.<span class=hljs-property>base</span> ?
            amount :
            (amount * rates.<span class=hljs-property>rates</span>[currency]).<span class="hljs-title function_">toFixed</span>(<span class=hljs-number>2</span>),
        <span class=hljs-attr>originalCurrency</span>: currency,
        <span class=hljs-attr>originalAmount</span>: amount,
        <span class=hljs-attr>title</span>: e.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".purchases-item-title"</span>).<span class=hljs-property>innerText</span>.<span class="hljs-title function_">trim</span>(),
    };
});

<span class=hljs-keyword>const</span> <span class="hljs-title function_">convertToCSV</span> = (<span class=hljs-params>elements, separator = <span class=hljs-string>","</span></span>) =&gt; [<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(elements[<span class=hljs-number>0</span>]), ...elements.<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>line</span>) =&gt;</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(line))]
    .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>line</span>) =&gt;</span>
        line
        .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>element</span>) =&gt;</span> {
            <span class=hljs-keyword>if</span> (<span class=hljs-keyword>typeof</span> element !== <span class=hljs-string>"string"</span>) <span class=hljs-keyword>return</span> element;
            <span class=hljs-keyword>return</span> <span class=hljs-string>`"`</span> + element.<span class="hljs-title function_">replaceAll</span>(<span class=hljs-string>`"`</span>, <span class=hljs-string>`""`</span>) + <span class=hljs-string>`"`</span>;
        })
        .<span class="hljs-title function_">join</span>(separator),
    )
    .<span class="hljs-title function_">join</span>(<span class=hljs-string>"\n"</span>);

<span class=hljs-keyword>const</span> <span class="hljs-title function_">download</span> = (<span class=hljs-params>filename, text</span>) =&gt; {
    <span class=hljs-keyword>const</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"a"</span>);
    element.<span class="hljs-title function_">setAttribute</span>(
        <span class=hljs-string>"href"</span>,
        <span class=hljs-string>"data:text/csv;charset=utf-8,"</span> + <span class=hljs-built_in>encodeURIComponent</span>(text),
    );
    element.<span class="hljs-title function_">setAttribute</span>(<span class=hljs-string>"download"</span>, filename);

    element.<span class=hljs-property>style</span>.<span class=hljs-property>display</span> = <span class=hljs-string>"none"</span>;
    <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(element);

    element.<span class="hljs-title function_">click</span>();

    <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">removeChild</span>(element);
};

<span class=hljs-keyword>const</span> <span class="hljs-title function_">rates</span> = <span class=hljs-keyword>async</span> (<span class=hljs-params>base</span>) =&gt; {
    <span class=hljs-keyword>const</span> resp = <span class=hljs-keyword>await</span> <span class="hljs-title function_">fetch</span>(<span class=hljs-string>`https://api.frankfurter.app/latest?from=<span class=hljs-subst>${base}</span>`</span>);
    <span class=hljs-keyword>return</span> <span class=hljs-keyword>await</span> resp.<span class="hljs-title function_">json</span>();
};

<span class=hljs-keyword>const</span> <span class="hljs-title function_">sleep</span> = (<span class=hljs-params>ms</span>) =&gt; <span class=hljs-keyword>new</span> <span class="hljs-title class_">Promise</span>(<span class=hljs-function>(<span class=hljs-params>r</span>) =&gt;</span> <span class=hljs-built_in>setTimeout</span>(r, ms));

<span class="hljs-title function_">main</span>();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href="https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20Import%2FExport%20progress%20in%20Lean's%20Natural%20Number%20Game%20(nng4)%0A%2F%2F%20%40description%20Shows%20a%20prompt%20with%20the%20saved%20data%20in%20localstorage%20that%20can%20be%20updated.%20Game%3A%20https%3A%2F%2Fadam.math.hhu.de%2F%23%2Fg%2Fleanprover-community%2Fnng4%0A%0Aconst%20progress%20%3D%20localStorage.getItem('game_progress')%3B%0Aconst%20newProgress%20%3D%20prompt('Current%20save%20(copy%20it%20or%20paste%20a%20new%20one)%3A'%2C%20progress)%3B%0Aif(newProgress)%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20JSON.parse(newProgress)%3B%0A%20%20%20%20%20%20%20%20localStorage.setItem('game_progress'%2C%20newProgress)%3B%0A%20%20%20%20%20%20%20%20alert('Imported!')%3B%0A%20%20%20%20%7D%20catch(e)%20%7B%0A%20%20%20%20%20%20%20%20alert('Invalid%20JSON!')%3B%0A%20%20%20%20%7D%0A%7D" title="Import/Export progress in Lean's Natural Number Game (nng4)" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Import/Export progress in Lean's Natural Number Game (nng4)</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Import/Export progress in Lean's Natural Number Game (nng4)</span></div></div></a> <a href="data:text/javascript,%2F%2F%20%40name%20Import%2FExport%20progress%20in%20Lean's%20Natural%20Number%20Game%20(nng4)%0A%2F%2F%20%40description%20Shows%20a%20prompt%20with%20the%20saved%20data%20in%20localstorage%20that%20can%20be%20updated.%20Game%3A%20https%3A%2F%2Fadam.math.hhu.de%2F%23%2Fg%2Fleanprover-community%2Fnng4%0A%0Aconst%20progress%20%3D%20localStorage.getItem('game_progress')%3B%0Aconst%20newProgress%20%3D%20prompt('Current%20save%20(copy%20it%20or%20paste%20a%20new%20one)%3A'%2C%20progress)%3B%0Aif(newProgress)%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20JSON.parse(newProgress)%3B%0A%20%20%20%20%20%20%20%20localStorage.setItem('game_progress'%2C%20newProgress)%3B%0A%20%20%20%20%20%20%20%20alert('Imported!')%3B%0A%20%20%20%20%7D%20catch(e)%20%7B%0A%20%20%20%20%20%20%20%20alert('Invalid%20JSON!')%3B%0A%20%20%20%20%7D%0A%7D" class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Shows a prompt with the saved data in localstorage that can be updated. Game: https://adam.math.hhu.de/#/g/leanprover-community/nng4</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href="data:text/javascript,%2F%2F%20%40name%20Import%2FExport%20progress%20in%20Lean's%20Natural%20Number%20Game%20(nng4)%0A%2F%2F%20%40description%20Shows%20a%20prompt%20with%20the%20saved%20data%20in%20localstorage%20that%20can%20be%20updated.%20Game%3A%20https%3A%2F%2Fadam.math.hhu.de%2F%23%2Fg%2Fleanprover-community%2Fnng4%0A%0Aconst%20progress%20%3D%20localStorage.getItem('game_progress')%3B%0Aconst%20newProgress%20%3D%20prompt('Current%20save%20(copy%20it%20or%20paste%20a%20new%20one)%3A'%2C%20progress)%3B%0Aif(newProgress)%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20JSON.parse(newProgress)%3B%0A%20%20%20%20%20%20%20%20localStorage.setItem('game_progress'%2C%20newProgress)%3B%0A%20%20%20%20%20%20%20%20alert('Imported!')%3B%0A%20%20%20%20%7D%20catch(e)%20%7B%0A%20%20%20%20%20%20%20%20alert('Invalid%20JSON!')%3B%0A%20%20%20%20%7D%0A%7D" rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name Import/Export progress in Lean's Natural Number Game (nng4)
// @description Shows a prompt with the saved data in localstorage that can be updated. Game: https://adam.math.hhu.de/#/g/leanprover-community/nng4
const progress = localStorage.getItem('game_progress');
const newProgress = prompt('Current save (copy it or paste a new one):', progress);
if(newProgress) {
 try {
 JSON.parse(newProgress);
 localStorage.setItem('game_progress', newProgress);
 alert('Imported!');
 } catch(e) {
 alert('Invalid JSON!');
 }
}</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Import/Export progress in Lean's Natural Number Game (nng4)</span>
<span class=hljs-comment>// @description Shows a prompt with the saved data in localstorage that can be updated. Game: https://adam.math.hhu.de/#/g/leanprover-community/nng4</span>

<span class=hljs-keyword>const</span> progress = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class=hljs-string>'game_progress'</span>);
<span class=hljs-keyword>const</span> newProgress = <span class="hljs-title function_">prompt</span>(<span class=hljs-string>'Current save (copy it or paste a new one):'</span>, progress);
<span class=hljs-keyword>if</span> (newProgress) {
    <span class=hljs-keyword>try</span> {
        <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(newProgress);
        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class=hljs-string>'game_progress'</span>, newProgress);
        <span class="hljs-title function_">alert</span>(<span class=hljs-string>'Imported!'</span>);
    } <span class=hljs-keyword>catch</span> (e) {
        <span class="hljs-title function_">alert</span>(<span class=hljs-string>'Invalid JSON!'</span>);
    }
}</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href="https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20Guess%20the%20number%0A%0Ajavascript%3A%20(function()%20%7B%0A%20%20let%20randomNumber%20%3D%20Math.floor(Math.random()%20*%2010)%20%2B%201%3B%20%2F%2F%20Number%20between%201%20and%2010%0A%20%20let%20guess%3B%0A%0A%20%20while%20(true)%20%7B%0A%20%20%20%20guess%20%3D%20prompt(%22Guess%20a%20number%20between%201%20and%2010%3A%22)%3B%0A%0A%20%20%20%20if%20(guess%20%3D%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20alert(%22Game%20canceled!%22)%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20guess%20%3D%20parseInt(guess)%3B%0A%0A%20%20%20%20if%20(isNaN(guess))%20%7B%0A%20%20%20%20%20%20alert(%22That's%20not%20a%20number!%22)%3B%0A%20%20%20%20%20%20continue%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(guess%20%3D%3D%3D%20randomNumber)%20%7B%0A%20%20%20%20%20%20alert(%22You%20guessed%20it!%22)%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%20else%20if%20(guess%20%3C%20randomNumber)%20%7B%0A%20%20%20%20%20%20alert(%22Too%20low!%22)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20alert(%22Too%20high!%22)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D)()%3B%0A" title="Guess the number" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Guess the number</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Guess the number</span></div></div></a> <a href="data:text/javascript,%2F%2F%20%40name%20Guess%20the%20number%0A%0Ajavascript%3A%20(function()%20%7B%0A%20%20let%20randomNumber%20%3D%20Math.floor(Math.random()%20*%2010)%20%2B%201%3B%20%2F%2F%20Number%20between%201%20and%2010%0A%20%20let%20guess%3B%0A%0A%20%20while%20(true)%20%7B%0A%20%20%20%20guess%20%3D%20prompt(%22Guess%20a%20number%20between%201%20and%2010%3A%22)%3B%0A%0A%20%20%20%20if%20(guess%20%3D%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20alert(%22Game%20canceled!%22)%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20guess%20%3D%20parseInt(guess)%3B%0A%0A%20%20%20%20if%20(isNaN(guess))%20%7B%0A%20%20%20%20%20%20alert(%22That's%20not%20a%20number!%22)%3B%0A%20%20%20%20%20%20continue%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(guess%20%3D%3D%3D%20randomNumber)%20%7B%0A%20%20%20%20%20%20alert(%22You%20guessed%20it!%22)%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%20else%20if%20(guess%20%3C%20randomNumber)%20%7B%0A%20%20%20%20%20%20alert(%22Too%20low!%22)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20alert(%22Too%20high!%22)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D)()%3B%0A" class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href="data:text/javascript,%2F%2F%20%40name%20Guess%20the%20number%0A%0Ajavascript%3A%20(function()%20%7B%0A%20%20let%20randomNumber%20%3D%20Math.floor(Math.random()%20*%2010)%20%2B%201%3B%20%2F%2F%20Number%20between%201%20and%2010%0A%20%20let%20guess%3B%0A%0A%20%20while%20(true)%20%7B%0A%20%20%20%20guess%20%3D%20prompt(%22Guess%20a%20number%20between%201%20and%2010%3A%22)%3B%0A%0A%20%20%20%20if%20(guess%20%3D%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20alert(%22Game%20canceled!%22)%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20guess%20%3D%20parseInt(guess)%3B%0A%0A%20%20%20%20if%20(isNaN(guess))%20%7B%0A%20%20%20%20%20%20alert(%22That's%20not%20a%20number!%22)%3B%0A%20%20%20%20%20%20continue%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(guess%20%3D%3D%3D%20randomNumber)%20%7B%0A%20%20%20%20%20%20alert(%22You%20guessed%20it!%22)%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%20else%20if%20(guess%20%3C%20randomNumber)%20%7B%0A%20%20%20%20%20%20alert(%22Too%20low!%22)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20alert(%22Too%20high!%22)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D)()%3B%0A" rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name Guess the number
javascript: (function() {
 let randomNumber = Math.floor(Math.random() * 10) + 1; // Number between 1 and 10
 let guess;
 while (true) {
 guess = prompt("Guess a number between 1 and 10:");
 if (guess === null) {
 alert("Game canceled!");
 return;
 }
 guess = parseInt(guess);
 if (isNaN(guess)) {
 alert("That's not a number!");
 continue;
 }
 if (guess === randomNumber) {
 alert("You guessed it!");
 return;
 } else if (guess &lt; randomNumber) {
 alert("Too low!");
 } else {
 alert("Too high!");
 }
 }
})();
</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Guess the number</span>

<span class=hljs-attr>javascript</span>: (<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>let</span> randomNumber = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class=hljs-number>10</span>) + <span class=hljs-number>1</span>; <span class=hljs-comment>// Number between 1 and 10</span>
    <span class=hljs-keyword>let</span> guess;

    <span class=hljs-keyword>while</span> (<span class=hljs-literal>true</span>) {
        guess = <span class="hljs-title function_">prompt</span>(<span class=hljs-string>"Guess a number between 1 and 10:"</span>);

        <span class=hljs-keyword>if</span> (guess === <span class=hljs-literal>null</span>) {
            <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Game canceled!"</span>);
            <span class=hljs-keyword>return</span>;
        }

        guess = <span class=hljs-built_in>parseInt</span>(guess);

        <span class=hljs-keyword>if</span> (<span class=hljs-built_in>isNaN</span>(guess)) {
            <span class="hljs-title function_">alert</span>(<span class=hljs-string>"That's not a number!"</span>);
            <span class=hljs-keyword>continue</span>;
        }

        <span class=hljs-keyword>if</span> (guess === randomNumber) {
            <span class="hljs-title function_">alert</span>(<span class=hljs-string>"You guessed it!"</span>);
            <span class=hljs-keyword>return</span>;
        } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (guess &lt; randomNumber) {
            <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Too low!"</span>);
        } <span class=hljs-keyword>else</span> {
            <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Too high!"</span>);
        }
    }
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/userscripts/summarize%20with%20claude.js title="Summarize with Claude" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Summarize with Claude</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Summarize with Claude</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/userscripts/summarize%20with%20claude.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>This userscript adds a menu option to summarize selected text using Claude's API. I DO NOT RECOMMEND using this as a bookmarklet, you will be exposing your API keys to the webpage.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/userscripts/summarize%20with%20claude.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/userscripts/summarize with claude.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary>Show Media</summary></details> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// ==UserScript==</span>
<span class=hljs-comment>// @name         Summarize with Claude</span>
<span class=hljs-comment>// @version      0.1</span>
<span class=hljs-comment>// @description  This userscript adds a menu option to summarize selected text using Claude's API. I DO NOT RECOMMEND using this as a bookmarklet, you will be exposing your API keys to the webpage.</span>
<span class=hljs-comment>// @video        https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/userscripts/Summarize%20with%20claude.mp4</span>
<span class=hljs-comment>// @match        *://*/*</span>
<span class=hljs-comment>// @grant        GM.xmlHttpRequest</span>
<span class=hljs-comment>// @grant        GM.getValue</span>
<span class=hljs-comment>// @grant        GM.setValue</span>
<span class=hljs-comment>// @grant        GM.registerMenuCommand</span>
<span class=hljs-comment>// @inject-into  content</span>
<span class=hljs-comment>// ==/UserScript==</span>
<span class=hljs-meta>
'use strict'</span>;

<span class=hljs-keyword>const</span> <span class="hljs-variable constant_">CLAUDE_API_ENDPOINT</span> = <span class=hljs-string>"https://api.anthropic.com/v1/messages"</span>;
<span class=hljs-keyword>const</span> <span class="hljs-variable constant_">MODEL</span> = <span class=hljs-string>"claude-3-5-sonnet-20240620"</span>;
<span class=hljs-keyword>const</span> <span class="hljs-variable constant_">MAX_TOKENS</span> = <span class=hljs-number>4096</span>;
<span class=hljs-keyword>const</span> <span class="hljs-variable constant_">SYSTEM_PROMPT</span> = <span class=hljs-string>"Make a comprehensive summary"</span>;

<span class=hljs-keyword>async</span> <span class=hljs-keyword>function</span> <span class="hljs-title function_">getApiKey</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>const</span> apiKey = <span class=hljs-keyword>await</span> <span class="hljs-variable constant_">GM</span>.<span class="hljs-title function_">getValue</span>(<span class=hljs-string>"anthropicApiKey"</span>, <span class=hljs-string>""</span>);
    <span class=hljs-keyword>if</span> (!apiKey) {
        <span class=hljs-keyword>const</span> newApiKey = <span class="hljs-title function_">prompt</span>(<span class=hljs-string>"Enter your Anthropic API key:"</span>);
        <span class=hljs-keyword>if</span> (!newApiKey) <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Error</span>(<span class=hljs-string>"Empty API key"</span>);
        <span class=hljs-keyword>await</span> <span class="hljs-variable constant_">GM</span>.<span class="hljs-title function_">setValue</span>(<span class=hljs-string>"anthropicApiKey"</span>, newApiKey);
        <span class=hljs-keyword>return</span> newApiKey;
    }
    <span class=hljs-keyword>return</span> apiKey;
}

<span class=hljs-keyword>function</span> <span class="hljs-title function_">displayPopover</span>(<span class=hljs-params>text</span>) {
    <span class=hljs-keyword>const</span> popover = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'div'</span>);
    popover.<span class="hljs-title function_">setAttribute</span>(<span class=hljs-string>'popover'</span>, <span class=hljs-string>"auto"</span>);
    popover.<span class=hljs-property>style</span>.<span class=hljs-property>cssText</span> = <span class=hljs-string>`
        max-width: 80vw;
        max-height: 80vh;
        margin: auto;
        overflow: auto;
        z-index: 9999;
        padding: 1em;
        border: 2px solid black;
    `</span>;

    <span class=hljs-keyword>const</span> responsePre = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'pre'</span>);
    responsePre.<span class=hljs-property>textContent</span> = text;
    responsePre.<span class=hljs-property>style</span>.<span class=hljs-property>cssText</span> = <span class=hljs-string>`
        text-wrap: wrap;
    `</span>;

    popover.<span class="hljs-title function_">appendChild</span>(responsePre);
    <span class="hljs-variable language_">document</span>.<span class=hljs-property>documentElement</span>.<span class="hljs-title function_">appendChild</span>(popover);

    popover.<span class="hljs-title function_">showPopover</span>();

    <span class=hljs-keyword>return</span> {
        <span class="hljs-title function_">update</span>(<span class=hljs-params>newText</span>) {
            responsePre.<span class=hljs-property>textContent</span> = newText;
        },
        <span class="hljs-title function_">close</span>(<span class=hljs-params></span>) {
            <span class="hljs-variable language_">document</span>.<span class=hljs-property>documentElement</span>.<span class="hljs-title function_">removeChild</span>(popover);
        }
    }
}

<span class=hljs-keyword>async</span> <span class=hljs-keyword>function</span> <span class="hljs-title function_">queryClaude</span>(<span class=hljs-params>prompt</span>) {
    <span class=hljs-keyword>const</span> apiKey = <span class=hljs-keyword>await</span> <span class="hljs-title function_">getApiKey</span>();

    <span class=hljs-keyword>const</span> requestBody = {
        <span class=hljs-attr>model</span>: <span class="hljs-variable constant_">MODEL</span>,
        <span class=hljs-attr>max_tokens</span>: <span class="hljs-variable constant_">MAX_TOKENS</span>,
        <span class=hljs-attr>temperature</span>: <span class=hljs-number>0</span>,
        <span class=hljs-attr>system</span>: <span class="hljs-variable constant_">SYSTEM_PROMPT</span>,
        <span class=hljs-attr>messages</span>: [{
            <span class=hljs-attr>role</span>: <span class=hljs-string>"user"</span>,
            <span class=hljs-attr>content</span>: [{
                <span class=hljs-attr>type</span>: <span class=hljs-string>"text"</span>,
                <span class=hljs-attr>text</span>: prompt
            }]
        }]
    };

    <span class=hljs-keyword>const</span> popover = <span class="hljs-title function_">displayPopover</span>(<span class=hljs-string>"Loading..."</span>);

    <span class="hljs-variable constant_">GM</span>.<span class="hljs-title function_">xmlHttpRequest</span>({
        <span class=hljs-attr>method</span>: <span class=hljs-string>"POST"</span>,
        <span class=hljs-attr>url</span>: <span class="hljs-variable constant_">CLAUDE_API_ENDPOINT</span>,
        <span class=hljs-attr>headers</span>: {
            <span class=hljs-string>"Content-Type"</span>: <span class=hljs-string>"application/json"</span>,
            <span class=hljs-string>"x-api-key"</span>: apiKey,
            <span class=hljs-string>"anthropic-version"</span>: <span class=hljs-string>"2023-06-01"</span>
        },
        <span class=hljs-attr>data</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(requestBody),
        <span class=hljs-attr>onload</span>: <span class=hljs-keyword>function</span>(<span class=hljs-params>response</span>) {
            <span class=hljs-keyword>if</span> (response.<span class=hljs-property>status</span> === <span class=hljs-number>200</span>) {
                <span class=hljs-keyword>const</span> result = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(response.<span class=hljs-property>responseText</span>);
                popover.<span class="hljs-title function_">update</span>(result.<span class=hljs-property>content</span>[<span class=hljs-number>0</span>].<span class=hljs-property>text</span>);
            } <span class=hljs-keyword>else</span> {
                popover.<span class="hljs-title function_">close</span>();
                <span class="hljs-title function_">alert</span>(<span class=hljs-string>`Error: <span class=hljs-subst>${response.status}</span> <span class=hljs-subst>${response.statusText}</span>\n\n<span class=hljs-subst>${response.responseText}</span>`</span>);
            }
        },
        <span class=hljs-attr>onerror</span>: <span class=hljs-keyword>function</span>(<span class=hljs-params>error</span>) {
            popover.<span class="hljs-title function_">close</span>();
            <span class="hljs-title function_">alert</span>(<span class=hljs-string>`Error: <span class=hljs-subst>${error}</span>`</span>);
        }
    });
}

<span class="hljs-variable constant_">GM</span>.<span class="hljs-title function_">registerMenuCommand</span>(<span class=hljs-string>"Summarize"</span>, <span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>const</span> selectedText = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>().<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">trim</span>();
    <span class=hljs-keyword>if</span> (selectedText) {
        <span class="hljs-title function_">queryClaude</span>(selectedText);
    } <span class=hljs-keyword>else</span> {
        <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Please select some text first."</span>);
    }
})</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/edit%20page.js title="Edit Page" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Edit Page</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Edit Page</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/edit%20page.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>This script makes the entire page editable, by adding the contentEditable attribute to the body element.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/edit%20page.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/edit page.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Edit Page</span>
<span class=hljs-comment>// @description This script makes the entire page editable, by adding the contentEditable attribute to the body element.</span>

<span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class=hljs-property>contentEditable</span> = <span class=hljs-literal>true</span>;
<span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class=hljs-property>spellcheck</span> = <span class=hljs-literal>false</span>;</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href="https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20Ingress%20passcodes%20auto-inserter%0A%2F%2F%20%40description%20copy%20passcodes%20from%20%60ingress.fandom.com%2Fwiki%2FPasscode%60%20and%20then%20mass-inserts%20them%20in%20the%20intel%20map%0A%0A(()%20%3D%3E%20%7B%0A%20%20%20%20const%20PASSCODE_TAG%20%3D%20'%23%23%23INGRESS_PASSCODES%23%23%23%5Cn'%3B%0A%0A%20%20%20%20if%20(window.location.href.includes('ingress.fandom.com%2Fwiki%2FPasscode'))%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20On%20wiki%20page%20-%20copy%20passcodes%20with%20tag%0A%20%20%20%20%20%20%20%20const%20passcodes%20%3D%20%5B...document.querySelectorAll(%22li%3Ecode%3Ebig%22)%5D.map(x%20%3D%3E%20x.textContent)%3B%0A%20%20%20%20%20%20%20%20navigator.clipboard.writeText(PASSCODE_TAG%20%2B%20passcodes.join('%5Cn'))%0A%20%20%20%20%20%20%20%20%20%20%20%20.then(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert('Passcodes%20copied%20to%20clipboard!%20Now%20go%20to%20Intel%20map%20to%20use%20them.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20.catch(err%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error('Failed%20to%20copy%20passcodes%3A'%2C%20err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert('Failed%20to%20copy%20passcodes%20to%20clipboard.%20Check%20console%20for%20details.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%20else%20if%20(window.location.href.includes('intel.ingress.com%2Fintel'))%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20On%20Intel%20map%20-%20read%20and%20validate%20passcodes%0A%20%20%20%20%20%20%20%20navigator.clipboard.readText()%0A%20%20%20%20%20%20%20%20%20%20%20%20.then(text%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!text.startsWith(PASSCODE_TAG))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('Incompatible%20clipboard%20content.%5Cn%5CnPlease%20go%20first%20to%20the%20Ingress%20Wiki%20(%20https%3A%2F%2Fingress.fandom.com%2Fwiki%2FPasscode%20)%20and%20run%20this%20script.%5CnThen%20come%20back%20to%20the%20Intel%20map%20and%20run%20this%20script%20again.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20passcodes%20%3D%20text%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.substring(PASSCODE_TAG.length)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.split('%5Cn')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.filter(code%20%3D%3E%20code.trim())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(passcodes.length%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('No%20valid%20passcodes%20found%20in%20clipboard.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.log(%60Found%20%24%7Bpasscodes.length%7D%20passcodes%20to%20process%60)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20processPasscodes(passcodes%2C%200)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20.catch(err%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error('Failed%20to%20process%20passcodes%3A'%2C%20err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert(err.message%20%7C%7C%20'Failed%20to%20read%20passcodes%20from%20clipboard.%20Check%20console%20for%20details.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20alert(%0A%60Please%20go%20first%20to%20the%20Ingress%20Wiki%20(%20https%3A%2F%2Fingress.fandom.com%2Fwiki%2FPasscode%20)%20and%20run%20this%20script%20to%20copy%20the%20passcodes%20to%20clipboard.%0A%0AThen%20go%20to%20the%20Intel%20map%20(%20https%3A%2F%2Fintel.ingress.com%2Fintel%20)%20and%20run%20this%20script%20again%20to%20enter%20the%20passcodes%20automatically.%60)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Function%20to%20process%20each%20passcode%20with%20delay%0A%20%20%20%20function%20processPasscodes(codes%2C%20index)%20%7B%0A%20%20%20%20%20%20%20%20console.log(%60Processing%20passcode%20%24%7Bindex%20%2B%201%7D%20of%20%24%7Bcodes.length%7D%3A%20%24%7Bcodes%5Bindex%5D%7D%60)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20(index%20%3E%3D%20codes.length)%20return%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20const%20code%20%3D%20codes%5Bindex%5D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20Find%20passcode%20input%20field%0A%20%20%20%20%20%20%20%20const%20inputField%20%3D%20document.getElementById('passcode')%3B%0A%20%20%20%20%20%20%20%20const%20submitButton%20%3D%20document.getElementById('submit')%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20(inputField%20%26%26%20submitButton)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Set%20the%20passcode%0A%20%20%20%20%20%20%20%20%20%20%20%20inputField.value%20%3D%20code%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Trigger%20input%20event%20to%20activate%20the%20submit%20button%0A%20%20%20%20%20%20%20%20%20%20%20%20inputField.dispatchEvent(new%20Event('input'%2C%20%7Bbubbles%3A%20true%7D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Submit%20the%20form%0A%20%20%20%20%20%20%20%20%20%20%20%20submitButton.click()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Wait%20and%20process%20the%20next%20code%0A%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20processPasscodes(codes%2C%20index%20%2B%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%203000)%3B%20%2F%2F%203%20second%20delay%20between%20submissions%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alert(%22Passcode%20input%20not%20found.%20Try%20clicking%20the%20passcode%20button%20in%20the%20Ingress%20UI%20first.%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)()%3B%0A" title="Ingress passcodes auto-inserter" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Ingress passcodes auto-inserter</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Ingress passcodes auto-inserter</span></div></div></a> <a href="data:text/javascript,%2F%2F%20%40name%20Ingress%20passcodes%20auto-inserter%0A%2F%2F%20%40description%20copy%20passcodes%20from%20%60ingress.fandom.com%2Fwiki%2FPasscode%60%20and%20then%20mass-inserts%20them%20in%20the%20intel%20map%0A%0A(()%20%3D%3E%20%7B%0A%20%20%20%20const%20PASSCODE_TAG%20%3D%20'%23%23%23INGRESS_PASSCODES%23%23%23%5Cn'%3B%0A%0A%20%20%20%20if%20(window.location.href.includes('ingress.fandom.com%2Fwiki%2FPasscode'))%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20On%20wiki%20page%20-%20copy%20passcodes%20with%20tag%0A%20%20%20%20%20%20%20%20const%20passcodes%20%3D%20%5B...document.querySelectorAll(%22li%3Ecode%3Ebig%22)%5D.map(x%20%3D%3E%20x.textContent)%3B%0A%20%20%20%20%20%20%20%20navigator.clipboard.writeText(PASSCODE_TAG%20%2B%20passcodes.join('%5Cn'))%0A%20%20%20%20%20%20%20%20%20%20%20%20.then(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert('Passcodes%20copied%20to%20clipboard!%20Now%20go%20to%20Intel%20map%20to%20use%20them.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20.catch(err%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error('Failed%20to%20copy%20passcodes%3A'%2C%20err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert('Failed%20to%20copy%20passcodes%20to%20clipboard.%20Check%20console%20for%20details.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%20else%20if%20(window.location.href.includes('intel.ingress.com%2Fintel'))%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20On%20Intel%20map%20-%20read%20and%20validate%20passcodes%0A%20%20%20%20%20%20%20%20navigator.clipboard.readText()%0A%20%20%20%20%20%20%20%20%20%20%20%20.then(text%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!text.startsWith(PASSCODE_TAG))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('Incompatible%20clipboard%20content.%5Cn%5CnPlease%20go%20first%20to%20the%20Ingress%20Wiki%20(%20https%3A%2F%2Fingress.fandom.com%2Fwiki%2FPasscode%20)%20and%20run%20this%20script.%5CnThen%20come%20back%20to%20the%20Intel%20map%20and%20run%20this%20script%20again.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20passcodes%20%3D%20text%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.substring(PASSCODE_TAG.length)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.split('%5Cn')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.filter(code%20%3D%3E%20code.trim())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(passcodes.length%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('No%20valid%20passcodes%20found%20in%20clipboard.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.log(%60Found%20%24%7Bpasscodes.length%7D%20passcodes%20to%20process%60)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20processPasscodes(passcodes%2C%200)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20.catch(err%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error('Failed%20to%20process%20passcodes%3A'%2C%20err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert(err.message%20%7C%7C%20'Failed%20to%20read%20passcodes%20from%20clipboard.%20Check%20console%20for%20details.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20alert(%0A%60Please%20go%20first%20to%20the%20Ingress%20Wiki%20(%20https%3A%2F%2Fingress.fandom.com%2Fwiki%2FPasscode%20)%20and%20run%20this%20script%20to%20copy%20the%20passcodes%20to%20clipboard.%0A%0AThen%20go%20to%20the%20Intel%20map%20(%20https%3A%2F%2Fintel.ingress.com%2Fintel%20)%20and%20run%20this%20script%20again%20to%20enter%20the%20passcodes%20automatically.%60)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Function%20to%20process%20each%20passcode%20with%20delay%0A%20%20%20%20function%20processPasscodes(codes%2C%20index)%20%7B%0A%20%20%20%20%20%20%20%20console.log(%60Processing%20passcode%20%24%7Bindex%20%2B%201%7D%20of%20%24%7Bcodes.length%7D%3A%20%24%7Bcodes%5Bindex%5D%7D%60)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20(index%20%3E%3D%20codes.length)%20return%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20const%20code%20%3D%20codes%5Bindex%5D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20Find%20passcode%20input%20field%0A%20%20%20%20%20%20%20%20const%20inputField%20%3D%20document.getElementById('passcode')%3B%0A%20%20%20%20%20%20%20%20const%20submitButton%20%3D%20document.getElementById('submit')%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20(inputField%20%26%26%20submitButton)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Set%20the%20passcode%0A%20%20%20%20%20%20%20%20%20%20%20%20inputField.value%20%3D%20code%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Trigger%20input%20event%20to%20activate%20the%20submit%20button%0A%20%20%20%20%20%20%20%20%20%20%20%20inputField.dispatchEvent(new%20Event('input'%2C%20%7Bbubbles%3A%20true%7D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Submit%20the%20form%0A%20%20%20%20%20%20%20%20%20%20%20%20submitButton.click()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Wait%20and%20process%20the%20next%20code%0A%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20processPasscodes(codes%2C%20index%20%2B%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%203000)%3B%20%2F%2F%203%20second%20delay%20between%20submissions%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alert(%22Passcode%20input%20not%20found.%20Try%20clicking%20the%20passcode%20button%20in%20the%20Ingress%20UI%20first.%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)()%3B%0A" class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>copy passcodes from `ingress.fandom.com/wiki/Passcode` and then mass-inserts them in the intel map</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href="data:text/javascript,%2F%2F%20%40name%20Ingress%20passcodes%20auto-inserter%0A%2F%2F%20%40description%20copy%20passcodes%20from%20%60ingress.fandom.com%2Fwiki%2FPasscode%60%20and%20then%20mass-inserts%20them%20in%20the%20intel%20map%0A%0A(()%20%3D%3E%20%7B%0A%20%20%20%20const%20PASSCODE_TAG%20%3D%20'%23%23%23INGRESS_PASSCODES%23%23%23%5Cn'%3B%0A%0A%20%20%20%20if%20(window.location.href.includes('ingress.fandom.com%2Fwiki%2FPasscode'))%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20On%20wiki%20page%20-%20copy%20passcodes%20with%20tag%0A%20%20%20%20%20%20%20%20const%20passcodes%20%3D%20%5B...document.querySelectorAll(%22li%3Ecode%3Ebig%22)%5D.map(x%20%3D%3E%20x.textContent)%3B%0A%20%20%20%20%20%20%20%20navigator.clipboard.writeText(PASSCODE_TAG%20%2B%20passcodes.join('%5Cn'))%0A%20%20%20%20%20%20%20%20%20%20%20%20.then(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert('Passcodes%20copied%20to%20clipboard!%20Now%20go%20to%20Intel%20map%20to%20use%20them.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20.catch(err%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error('Failed%20to%20copy%20passcodes%3A'%2C%20err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert('Failed%20to%20copy%20passcodes%20to%20clipboard.%20Check%20console%20for%20details.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%20else%20if%20(window.location.href.includes('intel.ingress.com%2Fintel'))%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20On%20Intel%20map%20-%20read%20and%20validate%20passcodes%0A%20%20%20%20%20%20%20%20navigator.clipboard.readText()%0A%20%20%20%20%20%20%20%20%20%20%20%20.then(text%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!text.startsWith(PASSCODE_TAG))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('Incompatible%20clipboard%20content.%5Cn%5CnPlease%20go%20first%20to%20the%20Ingress%20Wiki%20(%20https%3A%2F%2Fingress.fandom.com%2Fwiki%2FPasscode%20)%20and%20run%20this%20script.%5CnThen%20come%20back%20to%20the%20Intel%20map%20and%20run%20this%20script%20again.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20passcodes%20%3D%20text%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.substring(PASSCODE_TAG.length)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.split('%5Cn')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.filter(code%20%3D%3E%20code.trim())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(passcodes.length%20%3D%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error('No%20valid%20passcodes%20found%20in%20clipboard.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.log(%60Found%20%24%7Bpasscodes.length%7D%20passcodes%20to%20process%60)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20processPasscodes(passcodes%2C%200)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20.catch(err%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error('Failed%20to%20process%20passcodes%3A'%2C%20err)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert(err.message%20%7C%7C%20'Failed%20to%20read%20passcodes%20from%20clipboard.%20Check%20console%20for%20details.')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20alert(%0A%60Please%20go%20first%20to%20the%20Ingress%20Wiki%20(%20https%3A%2F%2Fingress.fandom.com%2Fwiki%2FPasscode%20)%20and%20run%20this%20script%20to%20copy%20the%20passcodes%20to%20clipboard.%0A%0AThen%20go%20to%20the%20Intel%20map%20(%20https%3A%2F%2Fintel.ingress.com%2Fintel%20)%20and%20run%20this%20script%20again%20to%20enter%20the%20passcodes%20automatically.%60)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Function%20to%20process%20each%20passcode%20with%20delay%0A%20%20%20%20function%20processPasscodes(codes%2C%20index)%20%7B%0A%20%20%20%20%20%20%20%20console.log(%60Processing%20passcode%20%24%7Bindex%20%2B%201%7D%20of%20%24%7Bcodes.length%7D%3A%20%24%7Bcodes%5Bindex%5D%7D%60)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20(index%20%3E%3D%20codes.length)%20return%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20const%20code%20%3D%20codes%5Bindex%5D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20Find%20passcode%20input%20field%0A%20%20%20%20%20%20%20%20const%20inputField%20%3D%20document.getElementById('passcode')%3B%0A%20%20%20%20%20%20%20%20const%20submitButton%20%3D%20document.getElementById('submit')%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20(inputField%20%26%26%20submitButton)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Set%20the%20passcode%0A%20%20%20%20%20%20%20%20%20%20%20%20inputField.value%20%3D%20code%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Trigger%20input%20event%20to%20activate%20the%20submit%20button%0A%20%20%20%20%20%20%20%20%20%20%20%20inputField.dispatchEvent(new%20Event('input'%2C%20%7Bbubbles%3A%20true%7D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Submit%20the%20form%0A%20%20%20%20%20%20%20%20%20%20%20%20submitButton.click()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Wait%20and%20process%20the%20next%20code%0A%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20processPasscodes(codes%2C%20index%20%2B%201)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%203000)%3B%20%2F%2F%203%20second%20delay%20between%20submissions%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alert(%22Passcode%20input%20not%20found.%20Try%20clicking%20the%20passcode%20button%20in%20the%20Ingress%20UI%20first.%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)()%3B%0A" rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name Ingress passcodes auto-inserter
// @description copy passcodes from `ingress.fandom.com/wiki/Passcode` and then mass-inserts them in the intel map
(() =&gt; {
 const PASSCODE_TAG = '###INGRESS_PASSCODES###\n';
 if (window.location.href.includes('ingress.fandom.com/wiki/Passcode')) {
 // On wiki page - copy passcodes with tag
 const passcodes = [...document.querySelectorAll("li&gt;code&gt;big")].map(x =&gt; x.textContent);
 navigator.clipboard.writeText(PASSCODE_TAG + passcodes.join('\n'))
 .then(() =&gt; {
 alert('Passcodes copied to clipboard! Now go to Intel map to use them.');
 })
 .catch(err =&gt; {
 console.error('Failed to copy passcodes:', err);
 alert('Failed to copy passcodes to clipboard. Check console for details.');
 });
 } else if (window.location.href.includes('intel.ingress.com/intel')) {
 // On Intel map - read and validate passcodes
 navigator.clipboard.readText()
 .then(text =&gt; {
 if (!text.startsWith(PASSCODE_TAG)) {
 throw new Error('Incompatible clipboard content.\n\nPlease go first to the Ingress Wiki ( https://ingress.fandom.com/wiki/Passcode ) and run this script.\nThen come back to the Intel map and run this script again.');
 }
 const passcodes = text
 .substring(PASSCODE_TAG.length)
 .split('\n')
 .filter(code =&gt; code.trim());
 
 if (passcodes.length === 0) {
 throw new Error('No valid passcodes found in clipboard.');
 }
 console.log(`Found ${passcodes.length} passcodes to process`);
 processPasscodes(passcodes, 0);
 })
 .catch(err =&gt; {
 console.error('Failed to process passcodes:', err);
 alert(err.message || 'Failed to read passcodes from clipboard. Check console for details.');
 });
 } else {
 alert(
`Please go first to the Ingress Wiki ( https://ingress.fandom.com/wiki/Passcode ) and run this script to copy the passcodes to clipboard.
Then go to the Intel map ( https://intel.ingress.com/intel ) and run this script again to enter the passcodes automatically.`);
 }
 // Function to process each passcode with delay
 function processPasscodes(codes, index) {
 console.log(`Processing passcode ${index + 1} of ${codes.length}: ${codes[index]}`);
 
 if (index &gt;= codes.length) return;
 
 const code = codes[index];
 
 // Find passcode input field
 const inputField = document.getElementById('passcode');
 const submitButton = document.getElementById('submit');
 
 if (inputField &amp;&amp; submitButton) {
 // Set the passcode
 inputField.value = code;
 
 // Trigger input event to activate the submit button
 inputField.dispatchEvent(new Event('input', {bubbles: true}));
 
 // Submit the form
 submitButton.click();
 
 // Wait and process the next code
 setTimeout(() =&gt; {
 processPasscodes(codes, index + 1);
 }, 3000); // 3 second delay between submissions
 } else {
 alert("Passcode input not found. Try clicking the passcode button in the Ingress UI first.");
 }
 }
})();
</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Ingress passcodes auto-inserter</span>
<span class=hljs-comment>// @description copy passcodes from `ingress.fandom.com/wiki/Passcode` and then mass-inserts them in the intel map</span>

(<span class=hljs-function>() =&gt;</span> {
    <span class=hljs-keyword>const</span> <span class="hljs-variable constant_">PASSCODE_TAG</span> = <span class=hljs-string>'###INGRESS_PASSCODES###\n'</span>;

    <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>location</span>.<span class=hljs-property>href</span>.<span class="hljs-title function_">includes</span>(<span class=hljs-string>'ingress.fandom.com/wiki/Passcode'</span>)) {
        <span class=hljs-comment>// On wiki page - copy passcodes with tag</span>
        <span class=hljs-keyword>const</span> passcodes = [...<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>"li&gt;code&gt;big"</span>)].<span class="hljs-title function_">map</span>(<span class=hljs-function><span class=hljs-params>x</span> =&gt;</span> x.<span class=hljs-property>textContent</span>);
        navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">writeText</span>(<span class="hljs-variable constant_">PASSCODE_TAG</span> + passcodes.<span class="hljs-title function_">join</span>(<span class=hljs-string>'\n'</span>))
            .<span class="hljs-title function_">then</span>(<span class=hljs-function>() =&gt;</span> {
                <span class="hljs-title function_">alert</span>(<span class=hljs-string>'Passcodes copied to clipboard! Now go to Intel map to use them.'</span>);
            })
            .<span class="hljs-title function_">catch</span>(<span class=hljs-function><span class=hljs-params>err</span> =&gt;</span> {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>'Failed to copy passcodes:'</span>, err);
                <span class="hljs-title function_">alert</span>(<span class=hljs-string>'Failed to copy passcodes to clipboard. Check console for details.'</span>);
            });
    } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>location</span>.<span class=hljs-property>href</span>.<span class="hljs-title function_">includes</span>(<span class=hljs-string>'intel.ingress.com/intel'</span>)) {
        <span class=hljs-comment>// On Intel map - read and validate passcodes</span>
        navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">readText</span>()
            .<span class="hljs-title function_">then</span>(<span class=hljs-function><span class=hljs-params>text</span> =&gt;</span> {
                <span class=hljs-keyword>if</span> (!text.<span class="hljs-title function_">startsWith</span>(<span class="hljs-variable constant_">PASSCODE_TAG</span>)) {
                    <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Error</span>(<span class=hljs-string>'Incompatible clipboard content.\n\nPlease go first to the Ingress Wiki ( https://ingress.fandom.com/wiki/Passcode ) and run this script.\nThen come back to the Intel map and run this script again.'</span>);
                }
                <span class=hljs-keyword>const</span> passcodes = text
                    .<span class="hljs-title function_">substring</span>(<span class="hljs-variable constant_">PASSCODE_TAG</span>.<span class=hljs-property>length</span>)
                    .<span class="hljs-title function_">split</span>(<span class=hljs-string>'\n'</span>)
                    .<span class="hljs-title function_">filter</span>(<span class=hljs-function><span class=hljs-params>code</span> =&gt;</span> code.<span class="hljs-title function_">trim</span>());

                <span class=hljs-keyword>if</span> (passcodes.<span class=hljs-property>length</span> === <span class=hljs-number>0</span>) {
                    <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Error</span>(<span class=hljs-string>'No valid passcodes found in clipboard.'</span>);
                }

                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class=hljs-string>`Found <span class=hljs-subst>${passcodes.length}</span> passcodes to process`</span>);
                <span class="hljs-title function_">processPasscodes</span>(passcodes, <span class=hljs-number>0</span>);
            })
            .<span class="hljs-title function_">catch</span>(<span class=hljs-function><span class=hljs-params>err</span> =&gt;</span> {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>'Failed to process passcodes:'</span>, err);
                <span class="hljs-title function_">alert</span>(err.<span class=hljs-property>message</span> || <span class=hljs-string>'Failed to read passcodes from clipboard. Check console for details.'</span>);
            });
    } <span class=hljs-keyword>else</span> {
        <span class="hljs-title function_">alert</span>(
            <span class=hljs-string>`Please go first to the Ingress Wiki ( https://ingress.fandom.com/wiki/Passcode ) and run this script to copy the passcodes to clipboard.

Then go to the Intel map ( https://intel.ingress.com/intel ) and run this script again to enter the passcodes automatically.`</span>);
    }

    <span class=hljs-comment>// Function to process each passcode with delay</span>
    <span class=hljs-keyword>function</span> <span class="hljs-title function_">processPasscodes</span>(<span class=hljs-params>codes, index</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class=hljs-string>`Processing passcode <span class=hljs-subst>${index + <span class=hljs-number>1</span>}</span> of <span class=hljs-subst>${codes.length}</span>: <span class=hljs-subst>${codes[index]}</span>`</span>);

        <span class=hljs-keyword>if</span> (index &gt;= codes.<span class=hljs-property>length</span>) <span class=hljs-keyword>return</span>;

        <span class=hljs-keyword>const</span> code = codes[index];

        <span class=hljs-comment>// Find passcode input field</span>
        <span class=hljs-keyword>const</span> inputField = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>'passcode'</span>);
        <span class=hljs-keyword>const</span> submitButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>'submit'</span>);

        <span class=hljs-keyword>if</span> (inputField &amp;&amp; submitButton) {
            <span class=hljs-comment>// Set the passcode</span>
            inputField.<span class=hljs-property>value</span> = code;

            <span class=hljs-comment>// Trigger input event to activate the submit button</span>
            inputField.<span class="hljs-title function_">dispatchEvent</span>(<span class=hljs-keyword>new</span> <span class="hljs-title class_">Event</span>(<span class=hljs-string>'input'</span>, {
                <span class=hljs-attr>bubbles</span>: <span class=hljs-literal>true</span>
            }));

            <span class=hljs-comment>// Submit the form</span>
            submitButton.<span class="hljs-title function_">click</span>();

            <span class=hljs-comment>// Wait and process the next code</span>
            <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> {
                <span class="hljs-title function_">processPasscodes</span>(codes, index + <span class=hljs-number>1</span>);
            }, <span class=hljs-number>3000</span>); <span class=hljs-comment>// 3 second delay between submissions</span>
        } <span class=hljs-keyword>else</span> {
            <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Passcode input not found. Try clicking the passcode button in the Ingress UI first."</span>);
        }
    }
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href="https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20Uppercaser%0A%2F%2F%20%40description%20Transforms%20selected%20text%20to%20upper%20or%20lower%20case.%20Only%20works%20on%20inputs%20or%20textareas%0A%0Alet%20text%20%3D%20''%3B%0Alet%20el%20%3D%20document.activeElement%3B%0A%0Aif(el.tagName%20%3D%3D%3D%20'TEXTAREA'%20%7C%7C%20el.tagName%20%3D%3D%3D%20'INPUT')%20%7B%0A%20%20%20%20let%20start%20%3D%20el.selectionStart%3B%0A%20%20%20%20let%20end%20%3D%20el.selectionEnd%3B%0A%20%20%20%20text%20%3D%20el.value.substring(start%2C%20end)%3B%0A%20%20%20%20%0A%20%20%20%20if(text%20%3D%3D%3D%20text.toUpperCase())%20%7B%0A%20%20%20%20%20%20%20%20el.setRangeText(text.toLowerCase()%2C%20start%2C%20end%2C%20'preserve')%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20el.setRangeText(text.toUpperCase()%2C%20start%2C%20end%2C%20'preserve')%3B%0A%20%20%20%20%7D%0A%7D%20else%20%7B%0A%20%20%20%20let%20sel%20%3D%20window.getSelection()%3B%0A%20%20%20%20text%20%3D%20sel.toString()%3B%0A%20%20%20%20%0A%20%20%20%20if(text%20%3D%3D%3D%20text.toUpperCase())%20%7B%0A%20%20%20%20%20%20%20%20document.execCommand('insertText'%2C%20false%2C%20text.toLowerCase())%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20document.execCommand('insertText'%2C%20false%2C%20text.toUpperCase())%3B%0A%20%20%20%20%7D%0A%7D" title=Uppercaser data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Uppercaser</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Uppercaser</span></div></div></a> <a href="data:text/javascript,%2F%2F%20%40name%20Uppercaser%0A%2F%2F%20%40description%20Transforms%20selected%20text%20to%20upper%20or%20lower%20case.%20Only%20works%20on%20inputs%20or%20textareas%0A%0Alet%20text%20%3D%20''%3B%0Alet%20el%20%3D%20document.activeElement%3B%0A%0Aif(el.tagName%20%3D%3D%3D%20'TEXTAREA'%20%7C%7C%20el.tagName%20%3D%3D%3D%20'INPUT')%20%7B%0A%20%20%20%20let%20start%20%3D%20el.selectionStart%3B%0A%20%20%20%20let%20end%20%3D%20el.selectionEnd%3B%0A%20%20%20%20text%20%3D%20el.value.substring(start%2C%20end)%3B%0A%20%20%20%20%0A%20%20%20%20if(text%20%3D%3D%3D%20text.toUpperCase())%20%7B%0A%20%20%20%20%20%20%20%20el.setRangeText(text.toLowerCase()%2C%20start%2C%20end%2C%20'preserve')%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20el.setRangeText(text.toUpperCase()%2C%20start%2C%20end%2C%20'preserve')%3B%0A%20%20%20%20%7D%0A%7D%20else%20%7B%0A%20%20%20%20let%20sel%20%3D%20window.getSelection()%3B%0A%20%20%20%20text%20%3D%20sel.toString()%3B%0A%20%20%20%20%0A%20%20%20%20if(text%20%3D%3D%3D%20text.toUpperCase())%20%7B%0A%20%20%20%20%20%20%20%20document.execCommand('insertText'%2C%20false%2C%20text.toLowerCase())%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20document.execCommand('insertText'%2C%20false%2C%20text.toUpperCase())%3B%0A%20%20%20%20%7D%0A%7D" class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Transforms selected text to upper or lower case. Only works on inputs or textareas</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href="data:text/javascript,%2F%2F%20%40name%20Uppercaser%0A%2F%2F%20%40description%20Transforms%20selected%20text%20to%20upper%20or%20lower%20case.%20Only%20works%20on%20inputs%20or%20textareas%0A%0Alet%20text%20%3D%20''%3B%0Alet%20el%20%3D%20document.activeElement%3B%0A%0Aif(el.tagName%20%3D%3D%3D%20'TEXTAREA'%20%7C%7C%20el.tagName%20%3D%3D%3D%20'INPUT')%20%7B%0A%20%20%20%20let%20start%20%3D%20el.selectionStart%3B%0A%20%20%20%20let%20end%20%3D%20el.selectionEnd%3B%0A%20%20%20%20text%20%3D%20el.value.substring(start%2C%20end)%3B%0A%20%20%20%20%0A%20%20%20%20if(text%20%3D%3D%3D%20text.toUpperCase())%20%7B%0A%20%20%20%20%20%20%20%20el.setRangeText(text.toLowerCase()%2C%20start%2C%20end%2C%20'preserve')%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20el.setRangeText(text.toUpperCase()%2C%20start%2C%20end%2C%20'preserve')%3B%0A%20%20%20%20%7D%0A%7D%20else%20%7B%0A%20%20%20%20let%20sel%20%3D%20window.getSelection()%3B%0A%20%20%20%20text%20%3D%20sel.toString()%3B%0A%20%20%20%20%0A%20%20%20%20if(text%20%3D%3D%3D%20text.toUpperCase())%20%7B%0A%20%20%20%20%20%20%20%20document.execCommand('insertText'%2C%20false%2C%20text.toLowerCase())%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20document.execCommand('insertText'%2C%20false%2C%20text.toUpperCase())%3B%0A%20%20%20%20%7D%0A%7D" rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name Uppercaser
// @description Transforms selected text to upper or lower case. Only works on inputs or textareas
let text = '';
let el = document.activeElement;
if(el.tagName === 'TEXTAREA' || el.tagName === 'INPUT') {
 let start = el.selectionStart;
 let end = el.selectionEnd;
 text = el.value.substring(start, end);
 
 if(text === text.toUpperCase()) {
 el.setRangeText(text.toLowerCase(), start, end, 'preserve');
 } else {
 el.setRangeText(text.toUpperCase(), start, end, 'preserve');
 }
} else {
 let sel = window.getSelection();
 text = sel.toString();
 
 if(text === text.toUpperCase()) {
 document.execCommand('insertText', false, text.toLowerCase());
 } else {
 document.execCommand('insertText', false, text.toUpperCase());
 }
}</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Uppercaser</span>
<span class=hljs-comment>// @description Transforms selected text to upper or lower case. Only works on inputs or textareas</span>

<span class=hljs-keyword>let</span> text = <span class=hljs-string>''</span>;
<span class=hljs-keyword>let</span> el = <span class="hljs-variable language_">document</span>.<span class=hljs-property>activeElement</span>;

<span class=hljs-keyword>if</span> (el.<span class=hljs-property>tagName</span> === <span class=hljs-string>'TEXTAREA'</span> || el.<span class=hljs-property>tagName</span> === <span class=hljs-string>'INPUT'</span>) {
    <span class=hljs-keyword>let</span> start = el.<span class=hljs-property>selectionStart</span>;
    <span class=hljs-keyword>let</span> end = el.<span class=hljs-property>selectionEnd</span>;
    text = el.<span class=hljs-property>value</span>.<span class="hljs-title function_">substring</span>(start, end);

    <span class=hljs-keyword>if</span> (text === text.<span class="hljs-title function_">toUpperCase</span>()) {
        el.<span class="hljs-title function_">setRangeText</span>(text.<span class="hljs-title function_">toLowerCase</span>(), start, end, <span class=hljs-string>'preserve'</span>);
    } <span class=hljs-keyword>else</span> {
        el.<span class="hljs-title function_">setRangeText</span>(text.<span class="hljs-title function_">toUpperCase</span>(), start, end, <span class=hljs-string>'preserve'</span>);
    }
} <span class=hljs-keyword>else</span> {
    <span class=hljs-keyword>let</span> sel = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>();
    text = sel.<span class="hljs-title function_">toString</span>();

    <span class=hljs-keyword>if</span> (text === text.<span class="hljs-title function_">toUpperCase</span>()) {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(<span class=hljs-string>'insertText'</span>, <span class=hljs-literal>false</span>, text.<span class="hljs-title function_">toLowerCase</span>());
    } <span class=hljs-keyword>else</span> {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(<span class=hljs-string>'insertText'</span>, <span class=hljs-literal>false</span>, text.<span class="hljs-title function_">toUpperCase</span>());
    }
}</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Id%20Linker.js title="Show Id Links" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Show Id Links</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Show Id Links</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Id%20Linker.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Add anchor links to all elements with an `id` attribute. Clicking the anchors will scroll to the element. Run again to remove anchors.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Id%20Linker.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Id Linker.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary>Show Media</summary></details> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Show Id Links</span>
<span class=hljs-comment>// @description Add anchor links to all elements with an `id` attribute. Clicking the anchors will scroll to the element. Run again to remove anchors.</span>
<span class=hljs-comment>// @image https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/bookmarklets/Id%20Linker.1.png</span>
<span class=hljs-comment>// @image https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/bookmarklets/Id%20Linker.2.png</span>

(<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-string>'use strict'</span>;

    <span class=hljs-comment>// Check if anchors are already added</span>
    <span class=hljs-keyword>if</span> (!!<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'a[data-id-linker]'</span>)) {
        <span class=hljs-comment>// Remove all id-linker anchors and styles inserted in a previous run</span>
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>'a[data-id-linker]'</span>).<span class="hljs-title function_">forEach</span>(<span class=hljs-function><span class=hljs-params>x</span> =&gt;</span> x.<span class="hljs-title function_">remove</span>());
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>'id-linker-styles'</span>).<span class="hljs-title function_">remove</span>();
        <span class=hljs-keyword>return</span>;
    }

    <span class=hljs-comment>/**
     * Add anchors to all elements with an `id` attribute
     */</span>
    <span class=hljs-keyword>const</span> idElements = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>'[id]'</span>);
    idElements.<span class="hljs-title function_">forEach</span>(<span class=hljs-function><span class=hljs-params>element</span> =&gt;</span> {
        <span class=hljs-keyword>const</span> {
            id
        } = element;
        <span class=hljs-keyword>if</span> (id &amp;&amp; !element.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'a[data-id-linker]'</span>)) {
            <span class=hljs-keyword>const</span> anchor = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'a'</span>);
            anchor.<span class=hljs-property>href</span> = <span class=hljs-string>'#'</span> + id;
            anchor.<span class=hljs-property>textContent</span> = <span class=hljs-string>'#'</span> + id;
            anchor.<span class="hljs-title function_">setAttribute</span>(<span class=hljs-string>'data-id-linker'</span>, <span class=hljs-string>"true"</span>); <span class=hljs-comment>// Mark the element</span>
            element.<span class="hljs-title function_">appendChild</span>(anchor);
        }
    });

    <span class=hljs-comment>/**
     * Add styles
     */</span>

    <span class=hljs-keyword>const</span> style = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'style'</span>);
    style.<span class=hljs-property>id</span> = <span class=hljs-string>'id-linker-styles'</span>;

    <span class=hljs-keyword>const</span> css = <span class=hljs-string>`
        a[data-id-linker] {
            position: absolute !important;
            top: 0 !important;
            right: 0 !important;
            display: inline-block !important;
            margin: 0 !important;
            box-shadow: none !important;
            border: 0 !important;
            padding: 2px 4px !important;
            width: auto !important;
            height: auto !important;
            transform: none !important;
            clear: none !important;
            float: none !important;
            opacity: 0.8 !important;
            z-index: 2147483645 !important;
            transition: z-index 1ms !important;
            font-size: inherit !important;
            font-weight: bold !important;
            text-decoration: none !important;
            cursor: pointer !important;
            background-color: rgba(255, 255, 255, 0.8) !important;
            color: rgba(0, 0, 255, 1) !important
        }
        a[data-id-linker]:hover {
            opacity: 1 !important;
            z-index: 2147483647 !important;
            transition: z-index 3ms !important;
        }

        *:has(&gt; a[data-id-linker]) {
            position: relative !important;
        }
    `</span>;
    <span class=hljs-keyword>if</span> (style.<span class=hljs-property>styleSheet</span>) {
        style.<span class=hljs-property>styleSheet</span>.<span class=hljs-property>cssText</span> = css;
    } <span class=hljs-keyword>else</span> {
        style.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(css));
    }
    <span class="hljs-variable language_">document</span>.<span class=hljs-property>head</span>.<span class="hljs-title function_">appendChild</span>(style);

})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://gist.githubusercontent.com/magasine/252422cfd7d177adbd830f40002d5c2a/raw/8784f962540fb32c909e489fcca36fe861983e03/X_Copy.js title="X Copy" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>X Copy</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">X Copy</span></div></div></a> <a href=https://gist.githubusercontent.com/magasine/252422cfd7d177adbd830f40002d5c2a/raw/8784f962540fb32c909e489fcca36fe861983e03/X_Copy.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://gist.githubusercontent.com/magasine/252422cfd7d177adbd830f40002d5c2a/raw/8784f962540fb32c909e489fcca36fe861983e03/X_Copy.js rel=nofollow class=svelte-7rw83y>https://gist.githubusercontent.com/magasine/252422cfd7d177adbd830f40002d5c2a/raw/8784f962540fb32c909e489fcca36fe861983e03/X_Copy.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript> (<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
     <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> {
         <span class=hljs-keyword>const</span> headerContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(
             <span class=hljs-string>'div[data-testid="User-Name"]'</span>
         );
         <span class=hljs-keyword>const</span> tweet = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>"article div[lang]"</span>);
         <span class=hljs-keyword>const</span> timestamp =
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>"article time"</span>)?.<span class=hljs-property>dateTime</span> || <span class=hljs-string>"Data desconhecida"</span>;
         <span class=hljs-keyword>const</span> url = <span class="hljs-variable language_">window</span>.<span class=hljs-property>location</span>.<span class=hljs-property>href</span>;
         <span class=hljs-keyword>const</span> text = tweet ? tweet.<span class=hljs-property>innerText</span>.<span class="hljs-title function_">trim</span>() : <span class=hljs-string>"Texto não encontrado"</span>;

         <span class=hljs-keyword>let</span> headerText = <span class=hljs-string>"Cabeçalho não encontrado"</span>;
         <span class=hljs-keyword>if</span> (headerContainer) {
             headerText = headerContainer.<span class=hljs-property>innerText</span>.<span class="hljs-title function_">trim</span>();
             <span class=hljs-keyword>const</span> match = headerText.<span class="hljs-title function_">match</span>(<span class=hljs-regexp>/(.+?)\s+(@\w+)/</span>);
             headerText = match ? <span class=hljs-string>`<span class=hljs-subst>${match[<span class=hljs-number>1</span>]}</span> - <span class=hljs-subst>${match[<span class=hljs-number>2</span>]}</span>`</span> : headerText;
         }

         <span class=hljs-keyword>const</span> formattedHeader = <span class=hljs-string>`*<span class=hljs-subst>${headerText}</span> - <span class=hljs-subst>${<span class=hljs-keyword>new</span> <span class=hljs-built_in>Date</span>(
      timestamp
    ).toLocaleString()}</span>*`</span>;

         <span class=hljs-comment>// Limpa múltiplas quebras e espaços, mantém apenas uma quebra entre parágrafos, e aplica '&gt;'</span>
         <span class=hljs-keyword>const</span> quotedText = text
             .<span class="hljs-title function_">split</span>(<span class=hljs-regexp>/\r?\n+/</span>) <span class=hljs-comment>// divide onde houver 1+ quebras</span>
             .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>line</span>) =&gt;</span> line.<span class="hljs-title function_">trim</span>()) <span class=hljs-comment>// remove espaços das extremidades</span>
             .<span class="hljs-title function_">filter</span>(<span class=hljs-function>(<span class=hljs-params>line</span>) =&gt;</span> line.<span class=hljs-property>length</span> &gt; <span class=hljs-number>0</span>) <span class=hljs-comment>// descarta linhas vazias</span>
             .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>line</span>) =&gt;</span> <span class=hljs-string>`&gt; <span class=hljs-subst>${line}</span>`</span>) <span class=hljs-comment>// adiciona prefixo de quote</span>
             .<span class="hljs-title function_">join</span>(<span class=hljs-string>"\n"</span>); <span class=hljs-comment>// junta com apenas uma quebra</span>

         <span class=hljs-keyword>const</span> formattedText = <span class=hljs-string>`<span class=hljs-subst>${formattedHeader}</span>\n<span class=hljs-subst>${quotedText}</span>\n<span class=hljs-subst>${url}</span>`</span>;

         navigator.<span class=hljs-property>clipboard</span>
             .<span class="hljs-title function_">writeText</span>(formattedText)
             .<span class="hljs-title function_">then</span>(<span class=hljs-function>() =&gt;</span> {
                 <span class="hljs-title function_">alert</span>(<span class=hljs-string>`Tweet copiado!\n\n<span class=hljs-subst>${formattedHeader}</span>\n<span class=hljs-subst>${quotedText}</span>\n<span class=hljs-subst>${url}</span>`</span>);
             })
             .<span class="hljs-title function_">catch</span>(<span class=hljs-function>(<span class=hljs-params>err</span>) =&gt;</span> {
                 <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Erro ao copiar: "</span> + err);
             });
     }, <span class=hljs-number>500</span>);
 })();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href="https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20Localstorage%20Editor%0A%2F%2F%20%40description%20Import%2C%20Export%20or%20Edit%20values%20in%20LocalStorage%0A%0Aconst%20saved_keys%20%3D%20Object.keys(localStorage)%3B%0Aconst%20key%20%3D%20prompt('Enter%20localStorage%20key%3A%5Cn%5CnAvailable%20keys%3A%5Cn'%20%2B%20saved_keys.join('%5Cn')%2C%20'')%3B%0Aif(key)%20%7B%0A%20%20%20%20const%20value%20%3D%20localStorage.getItem(key)%3B%0A%20%20%20%20const%20newValue%20%3D%20prompt('Current%20value%20(copy%20it%20or%20paste%20a%20new%20one)%3A'%2C%20value)%3B%0A%20%20%20%20if(newValue%20%26%26%20newValue%20!%3D%3D%20value)%20%7B%0A%20%20%20%20%20%20%20%20localStorage.setItem(key%2C%20newValue)%3B%0A%20%20%20%20%20%20%20%20alert('Saved!')%3B%0A%20%20%20%20%7D%0A%7D%0A" title="Localstorage Editor" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Localstorage Editor</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Localstorage Editor</span></div></div></a> <a href="data:text/javascript,%2F%2F%20%40name%20Localstorage%20Editor%0A%2F%2F%20%40description%20Import%2C%20Export%20or%20Edit%20values%20in%20LocalStorage%0A%0Aconst%20saved_keys%20%3D%20Object.keys(localStorage)%3B%0Aconst%20key%20%3D%20prompt('Enter%20localStorage%20key%3A%5Cn%5CnAvailable%20keys%3A%5Cn'%20%2B%20saved_keys.join('%5Cn')%2C%20'')%3B%0Aif(key)%20%7B%0A%20%20%20%20const%20value%20%3D%20localStorage.getItem(key)%3B%0A%20%20%20%20const%20newValue%20%3D%20prompt('Current%20value%20(copy%20it%20or%20paste%20a%20new%20one)%3A'%2C%20value)%3B%0A%20%20%20%20if(newValue%20%26%26%20newValue%20!%3D%3D%20value)%20%7B%0A%20%20%20%20%20%20%20%20localStorage.setItem(key%2C%20newValue)%3B%0A%20%20%20%20%20%20%20%20alert('Saved!')%3B%0A%20%20%20%20%7D%0A%7D%0A" class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Import, Export or Edit values in LocalStorage</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href="data:text/javascript,%2F%2F%20%40name%20Localstorage%20Editor%0A%2F%2F%20%40description%20Import%2C%20Export%20or%20Edit%20values%20in%20LocalStorage%0A%0Aconst%20saved_keys%20%3D%20Object.keys(localStorage)%3B%0Aconst%20key%20%3D%20prompt('Enter%20localStorage%20key%3A%5Cn%5CnAvailable%20keys%3A%5Cn'%20%2B%20saved_keys.join('%5Cn')%2C%20'')%3B%0Aif(key)%20%7B%0A%20%20%20%20const%20value%20%3D%20localStorage.getItem(key)%3B%0A%20%20%20%20const%20newValue%20%3D%20prompt('Current%20value%20(copy%20it%20or%20paste%20a%20new%20one)%3A'%2C%20value)%3B%0A%20%20%20%20if(newValue%20%26%26%20newValue%20!%3D%3D%20value)%20%7B%0A%20%20%20%20%20%20%20%20localStorage.setItem(key%2C%20newValue)%3B%0A%20%20%20%20%20%20%20%20alert('Saved!')%3B%0A%20%20%20%20%7D%0A%7D%0A" rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name Localstorage Editor
// @description Import, Export or Edit values in LocalStorage
const saved_keys = Object.keys(localStorage);
const key = prompt('Enter localStorage key:\n\nAvailable keys:\n' + saved_keys.join('\n'), '');
if(key) {
 const value = localStorage.getItem(key);
 const newValue = prompt('Current value (copy it or paste a new one):', value);
 if(newValue &amp;&amp; newValue !== value) {
 localStorage.setItem(key, newValue);
 alert('Saved!');
 }
}
</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Localstorage Editor</span>
<span class=hljs-comment>// @description Import, Export or Edit values in LocalStorage</span>

<span class=hljs-keyword>const</span> saved_keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">localStorage</span>);
<span class=hljs-keyword>const</span> key = <span class="hljs-title function_">prompt</span>(<span class=hljs-string>'Enter localStorage key:\n\nAvailable keys:\n'</span> + saved_keys.<span class="hljs-title function_">join</span>(<span class=hljs-string>'\n'</span>), <span class=hljs-string>''</span>);
<span class=hljs-keyword>if</span> (key) {
    <span class=hljs-keyword>const</span> value = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key);
    <span class=hljs-keyword>const</span> newValue = <span class="hljs-title function_">prompt</span>(<span class=hljs-string>'Current value (copy it or paste a new one):'</span>, value);
    <span class=hljs-keyword>if</span> (newValue &amp;&amp; newValue !== value) {
        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, newValue);
        <span class="hljs-title function_">alert</span>(<span class=hljs-string>'Saved!'</span>);
    }
}</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20Fullscreen%0A%2F%2F%20%40description%20Makes%20the%20screen%20fullscreen%0A%0Adocument.body.requestFullscreen() title=Fullscreen data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Fullscreen</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Fullscreen</span></div></div></a> <a href=data:text/javascript,%2F%2F%20%40name%20Fullscreen%0A%2F%2F%20%40description%20Makes%20the%20screen%20fullscreen%0A%0Adocument.body.requestFullscreen() class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Makes the screen fullscreen</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=data:text/javascript,%2F%2F%20%40name%20Fullscreen%0A%2F%2F%20%40description%20Makes%20the%20screen%20fullscreen%0A%0Adocument.body.requestFullscreen() rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name Fullscreen
// @description Makes the screen fullscreen
document.body.requestFullscreen()</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Fullscreen</span>
<span class=hljs-comment>// @description Makes the screen fullscreen</span>

<span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">requestFullscreen</span>()</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://gist.githubusercontent.com/magasine/a502e3a22b0e67a8fac34f06a42a689f/raw/c06895439eb9dad04fb68c60aa1e91d103228840/clipboardWidget.js title=ClipboardWidget data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>ClipboardWidget</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">ClipboardWidget</span></div></div></a> <a href=https://gist.githubusercontent.com/magasine/a502e3a22b0e67a8fac34f06a42a689f/raw/c06895439eb9dad04fb68c60aa1e91d103228840/clipboardWidget.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://gist.githubusercontent.com/magasine/a502e3a22b0e67a8fac34f06a42a689f/raw/c06895439eb9dad04fb68c60aa1e91d103228840/clipboardWidget.js rel=nofollow class=svelte-7rw83y>https://gist.githubusercontent.com/magasine/a502e3a22b0e67a8fac34f06a42a689f/raw/c06895439eb9dad04fb68c60aa1e91d103228840/clipboardWidget.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript> (<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
     <span class=hljs-comment>// Previne múltiplas instâncias do widget</span>
     <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>clipboardWidget</span>) {
         <span class="hljs-variable language_">window</span>.<span class=hljs-property>clipboardWidget</span>.<span class="hljs-title function_">toggle</span>();
         <span class=hljs-keyword>return</span>;
     }

     <span class=hljs-comment>// ==================== CONSTANTES E CONFIGURAÇÕES ====================</span>
     <span class=hljs-keyword>const</span> <span class="hljs-title class_">Constants</span> = {
         <span class="hljs-title class_">IDs</span>: {
             <span class=hljs-attr>VERSION</span>: <span class=hljs-string>"20250825"</span>,
             <span class=hljs-attr>HAMBURGER_BUTTON</span>: <span class=hljs-string>"clipboard-hamburger"</span>,
             <span class=hljs-attr>WIDGET</span>: <span class=hljs-string>"clipboardWidget"</span>,
             <span class=hljs-attr>CONTROLS</span>: <span class=hljs-string>"clipboardControls"</span>,
             <span class=hljs-attr>CONTENT</span>: <span class=hljs-string>"clipboardContent"</span>,
             <span class=hljs-attr>READ_BUTTON</span>: <span class=hljs-string>"readClipboard"</span>,
             <span class=hljs-attr>FALLBACK_TEXTAREA</span>: <span class=hljs-string>"clipboardFallbackTextarea"</span>,
             <span class=hljs-attr>CLEAR_ALL_BUTTON</span>: <span class=hljs-string>"clearAllBtn"</span>,
             <span class=hljs-attr>CLEAR_HIST_BUTTON</span>: <span class=hljs-string>"clearHistBtn"</span>,
             <span class=hljs-attr>CLEAR_PIN_BUTTON</span>: <span class=hljs-string>"clearPinBtn"</span>,
             <span class=hljs-attr>SEARCH_BAR</span>: <span class=hljs-string>"clipboardSearchBar"</span>,
             <span class=hljs-attr>EXPORT_BUTTON</span>: <span class=hljs-string>"exportHistoryBtn"</span>,
             <span class=hljs-attr>IMPORT_BUTTON</span>: <span class=hljs-string>"importHistoryBtn"</span>,
             <span class=hljs-attr>WIDGET_TITLE</span>: <span class=hljs-string>"clipboardWidgetTitle"</span>,
             <span class=hljs-attr>STATUS_INDICATOR</span>: <span class=hljs-string>"clipboardStatusIndicator"</span>,
         },
         <span class="hljs-title class_">StorageKeys</span>: {
             <span class=hljs-attr>MINIMIZED</span>: <span class=hljs-string>"clipboardWidgetMinimized"</span>,
             <span class=hljs-attr>HISTORY</span>: <span class=hljs-string>"clipboardHistory"</span>,
             <span class=hljs-attr>HISTORY_BACKUP</span>: <span class=hljs-string>"clipboardHistoryBackup"</span>,
         },
         <span class="hljs-title class_">Limits</span>: {
             <span class=hljs-attr>MAX_HISTORY_ITEMS</span>: <span class=hljs-number>20</span>,
             <span class=hljs-attr>MAX_STORAGE_SIZE</span>: <span class=hljs-number>5</span> * <span class=hljs-number>1024</span> * <span class=hljs-number>1024</span>, <span class=hljs-comment>// 5MB</span>
         },
     };

     <span class=hljs-comment>// ==================== ESTADOS DO CLIPBOARD ====================</span>
     <span class=hljs-keyword>const</span> <span class="hljs-title class_">ClipboardStates</span> = {
         <span class=hljs-attr>ACTIVE</span>: <span class=hljs-string>"🟢"</span>,
         <span class=hljs-attr>ERROR</span>: <span class=hljs-string>"🔴"</span>,
         <span class=hljs-attr>FALLBACK</span>: <span class=hljs-string>"🟠"</span>,
         <span class=hljs-attr>DISABLED</span>: <span class=hljs-string>"⚫"</span>,
         <span class=hljs-attr>UNKNOWN</span>: <span class=hljs-string>"❓"</span>,

         <span class="hljs-title function_">getCurrentState</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (navigator.<span class=hljs-property>clipboard</span>?.<span class=hljs-property>read</span>) <span class=hljs-keyword>return</span> <span class="hljs-variable language_">this</span>.<span class=hljs-property>ACTIVE</span>;
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">document</span>.<span class=hljs-property>execCommand</span>) <span class=hljs-keyword>return</span> <span class="hljs-variable language_">this</span>.<span class=hljs-property>FALLBACK</span>;
             <span class=hljs-keyword>return</span> <span class="hljs-variable language_">this</span>.<span class=hljs-property>DISABLED</span>;
         }
     };

     <span class=hljs-comment>// ==================== INTERNACIONALIZAÇÃO (i18n) ====================</span>
     <span class=hljs-keyword>const</span> I18n = {
         <span class=hljs-attr>translations</span>: {
             <span class=hljs-attr>en</span>: {
                 <span class=hljs-attr>readClipboard</span>: <span class=hljs-string>"Read Clipboard"</span>,
                 <span class=hljs-attr>emptyHistory</span>: <span class=hljs-string>"No items in clipboard history yet."</span>,
                 <span class=hljs-attr>emptyPinned</span>: <span class=hljs-string>"No pinned items yet."</span>,
                 <span class=hljs-attr>searchPlaceholder</span>: <span class=hljs-string>"Search clipboard history..."</span>,
                 <span class=hljs-attr>exportHistory</span>: <span class=hljs-string>"Export History"</span>,
                 <span class=hljs-attr>importHistory</span>: <span class=hljs-string>"Import History"</span>,
                 <span class=hljs-attr>newItemAdded</span>: <span class=hljs-string>"New item added to clipboard history!"</span>,
                 <span class=hljs-attr>imageAdded</span>: <span class=hljs-string>"Image added to clipboard history!"</span>,
                 <span class=hljs-attr>errorClipboard</span>: <span class=hljs-string>"Failed to access clipboard. Check browser permissions."</span>,
                 <span class=hljs-attr>clearAllConfirm</span>: <span class=hljs-string>"Are you sure you want to clear ALL history (including pinned)?"</span>,
                 <span class=hljs-attr>clearHistoryConfirm</span>: <span class=hljs-string>"Are you sure you want to clear all unpinned history?"</span>,
                 <span class=hljs-attr>clearPinnedConfirm</span>: <span class=hljs-string>"Are you sure you want to clear all pinned items?"</span>,
                 <span class=hljs-attr>deleteItemConfirm</span>: <span class=hljs-string>"Are you sure you want to delete this item?"</span>,
                 <span class=hljs-attr>itemDeleted</span>: <span class=hljs-string>"Item deleted successfully!"</span>,
                 <span class=hljs-attr>historyTab</span>: <span class=hljs-string>"History"</span>,
                 <span class=hljs-attr>pinnedTab</span>: <span class=hljs-string>"Pinned"</span>,
                 <span class=hljs-attr>storageLimitExceeded</span>: <span class=hljs-string>"Warning: The clipboard history is large. Images may not be saved or may be lost to respect the storage limit."</span>,
                 <span class=hljs-attr>imageImportWarning</span>: <span class=hljs-string>"Warning: Imported image URLs are temporary and will not persist after reloading the page."</span>,
                 <span class=hljs-attr>loadingHistory</span>: <span class=hljs-string>"Loading history..."</span>,
                 <span class=hljs-attr>historyLoadError</span>: <span class=hljs-string>"Error loading history"</span>,
                 <span class=hljs-attr>historyRestored</span>: <span class=hljs-string>"History restored from backup"</span>,
                 <span class=hljs-attr>backupFailed</span>: <span class=hljs-string>"Failed to create backup"</span>,
                 <span class=hljs-attr>widgetTitle</span>: <span class=hljs-string>`Clipboard Widget - <span class=hljs-subst>${Constants.IDs.VERSION}</span>`</span>,
                 <span class=hljs-attr>statusActive</span>: <span class=hljs-string>"Clipboard access active"</span>,
                 <span class=hljs-attr>statusError</span>: <span class=hljs-string>"Clipboard permission denied"</span>,
                 <span class=hljs-attr>statusFallback</span>: <span class=hljs-string>"Using fallback clipboard method"</span>,
                 <span class=hljs-attr>statusDisabled</span>: <span class=hljs-string>"Clipboard not supported"</span>,
             },
             <span class=hljs-attr>pt</span>: {
                 <span class=hljs-attr>readClipboard</span>: <span class=hljs-string>"Ler Área de Transferência"</span>,
                 <span class=hljs-attr>emptyHistory</span>: <span class=hljs-string>"Nenhum item no histórico da área de transferência ainda."</span>,
                 <span class=hljs-attr>emptyPinned</span>: <span class=hljs-string>"Nenhum item fixado ainda."</span>,
                 <span class=hljs-attr>searchPlaceholder</span>: <span class=hljs-string>"Pesquisar histórico da área de transferência..."</span>,
                 <span class=hljs-attr>exportHistory</span>: <span class=hljs-string>"Exp"</span>,
                 <span class=hljs-attr>importHistory</span>: <span class=hljs-string>"Imp"</span>,
                 <span class=hljs-attr>newItemAdded</span>: <span class=hljs-string>"Novo item adicionado ao histórico da área de transferência!"</span>,
                 <span class=hljs-attr>imageAdded</span>: <span class=hljs-string>"Imagem adicionada ao histórico da área de transferência!"</span>,
                 <span class=hljs-attr>errorClipboard</span>: <span class=hljs-string>"Falha ao acessar a área de transferência. Verifique as permissões do navegador."</span>,
                 <span class=hljs-attr>clearAllConfirm</span>: <span class=hljs-string>"Tem certeza de que deseja limpar TODO o histórico (incluindo fixados)?"</span>,
                 <span class=hljs-attr>clearHistoryConfirm</span>: <span class=hljs-string>"Tem certeza de que deseja limpar todo o histórico não fixado?"</span>,
                 <span class=hljs-attr>clearPinnedConfirm</span>: <span class=hljs-string>"Tem certeza de que deseja limpar todos os itens fixados?"</span>,
                 <span class=hljs-attr>deleteItemConfirm</span>: <span class=hljs-string>"Tem certeza de que deseja excluir este item?"</span>,
                 <span class=hljs-attr>itemDeleted</span>: <span class=hljs-string>"Item excluído com sucesso!"</span>,
                 <span class=hljs-attr>historyTab</span>: <span class=hljs-string>"Histórico"</span>,
                 <span class=hljs-attr>pinnedTab</span>: <span class=hljs-string>"Fixados"</span>,
                 <span class=hljs-attr>storageLimitExceeded</span>: <span class=hljs-string>"Aviso: O histórico da área de transferência é grande. As imagens podem não ser salvas ou podem ser perdidas para respeitar o limite de armazenamento."</span>,
                 <span class=hljs-attr>imageImportWarning</span>: <span class=hljs-string>"Aviso: As URLs das imagens importadas são temporárias e não persistirão após recarregar a página."</span>,
                 <span class=hljs-attr>loadingHistory</span>: <span class=hljs-string>"Carregando histórico..."</span>,
                 <span class=hljs-attr>historyLoadError</span>: <span class=hljs-string>"Erro ao carregar histórico"</span>,
                 <span class=hljs-attr>historyRestored</span>: <span class=hljs-string>"Histórico restaurado do backup"</span>,
                 <span class=hljs-attr>backupFailed</span>: <span class=hljs-string>"Falha ao criar backup"</span>,
                 <span class=hljs-attr>widgetTitle</span>: <span class=hljs-string>`Clipboard Widget - <span class=hljs-subst>${Constants.IDs.VERSION}</span>`</span>,
                 <span class=hljs-attr>statusActive</span>: <span class=hljs-string>"Acesso à área de transferência ativo"</span>,
                 <span class=hljs-attr>statusError</span>: <span class=hljs-string>"Permissão de área de transferência negada"</span>,
                 <span class=hljs-attr>statusFallback</span>: <span class=hljs-string>"Usando método alternativo de área de transferência"</span>,
                 <span class=hljs-attr>statusDisabled</span>: <span class=hljs-string>"Área de transferência não suportada"</span>,
             },
         },

         <span class="hljs-title function_">getTranslation</span>(<span class=hljs-params>key</span>) {
             <span class=hljs-keyword>const</span> lang = navigator.<span class=hljs-property>language</span>.<span class="hljs-title function_">split</span>(<span class=hljs-string>"-"</span>)[<span class=hljs-number>0</span>];
             <span class=hljs-keyword>return</span> <span class="hljs-variable language_">this</span>.<span class=hljs-property>translations</span>[lang]?.[key] || <span class="hljs-variable language_">this</span>.<span class=hljs-property>translations</span>.<span class=hljs-property>en</span>[key];
         },
     };

     <span class=hljs-comment>// ==================== SEGURANÇA E SANITIZAÇÃO ====================</span>
     <span class=hljs-keyword>const</span> <span class="hljs-title class_">Security</span> = {
         <span class="hljs-title function_">sanitizeText</span>(<span class=hljs-params>text</span>) {
             <span class=hljs-keyword>return</span> text.<span class="hljs-title function_">replace</span>(<span class=hljs-regexp>/[&lt;&gt;]/g</span>, <span class=hljs-string>""</span>).<span class="hljs-title function_">trim</span>();
         },

         <span class="hljs-title function_">sanitizeToTrustedHTML</span>(<span class=hljs-params>html</span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>trustedTypes</span> &amp;&amp; <span class="hljs-variable language_">window</span>.<span class=hljs-property>trustedTypes</span>.<span class=hljs-property>createPolicy</span>) {
                 <span class=hljs-keyword>try</span> {
                     <span class=hljs-keyword>const</span> escapePolicy = trustedTypes.<span class="hljs-title function_">createPolicy</span>(
                         <span class=hljs-string>"clipboardWidgetEscapePolicy"</span>, {
                             <span class=hljs-attr>createHTML</span>: <span class=hljs-function>(<span class=hljs-params>string</span>) =&gt;</span>
                                 string.<span class="hljs-title function_">replace</span>(<span class=hljs-regexp>/&lt;/g</span>, <span class=hljs-string>"&amp;lt;"</span>).<span class="hljs-title function_">replace</span>(<span class=hljs-regexp>/&gt;/g</span>, <span class=hljs-string>"&amp;gt;"</span>),
                         }
                     );
                     <span class=hljs-keyword>return</span> escapePolicy.<span class="hljs-title function_">createHTML</span>(html);
                 } <span class=hljs-keyword>catch</span> (e) {
                     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"TrustedTypes policy creation failed:"</span>, e);
                     <span class=hljs-keyword>return</span> html;
                 }
             }
             <span class=hljs-keyword>return</span> html;
         },

         <span class="hljs-title function_">safeSetInnerHTML</span>(<span class=hljs-params>element, html</span>) {
             <span class=hljs-keyword>const</span> trusted = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sanitizeToTrustedHTML</span>(html);
             <span class=hljs-keyword>if</span> (trusted <span class=hljs-keyword>instanceof</span> <span class="hljs-title class_">TrustedHTML</span>) {
                 element.<span class=hljs-property>innerHTML</span> = trusted;
             } <span class=hljs-keyword>else</span> {
                 element.<span class=hljs-property>textContent</span> = <span class=hljs-string>""</span>;
                 <span class=hljs-keyword>const</span> doc = <span class=hljs-keyword>new</span> <span class="hljs-title class_">DOMParser</span>().<span class="hljs-title function_">parseFromString</span>(html, <span class=hljs-string>"text/html"</span>);
                 <span class=hljs-keyword>while</span> (doc.<span class=hljs-property>body</span>.<span class=hljs-property>firstChild</span>) {
                     element.<span class="hljs-title function_">appendChild</span>(doc.<span class=hljs-property>body</span>.<span class=hljs-property>firstChild</span>);
                 }
             }
         },
     };

     <span class=hljs-comment>// ==================== UTILITÁRIOS ====================</span>
     <span class=hljs-keyword>const</span> <span class="hljs-title class_">Utils</span> = {
         <span class="hljs-title function_">createElement</span>(<span class=hljs-params>tag, id = <span class=hljs-string>""</span>, textContent = <span class=hljs-string>""</span>, classes = []</span>) {
             <span class=hljs-keyword>const</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(tag);
             <span class=hljs-keyword>if</span> (id) element.<span class=hljs-property>id</span> = id;
             <span class=hljs-keyword>if</span> (textContent) element.<span class=hljs-property>textContent</span> = textContent;
             <span class=hljs-keyword>if</span> (classes.<span class=hljs-property>length</span>) element.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(...classes);
             element.<span class="hljs-title function_">setAttribute</span>(<span class=hljs-string>"aria-label"</span>, textContent || id || tag);
             element.<span class="hljs-title function_">setAttribute</span>(<span class=hljs-string>"tabindex"</span>, <span class=hljs-string>"0"</span>);
             <span class=hljs-keyword>return</span> element;
         },

         <span class="hljs-title function_">addDisposableEventListener</span>(<span class=hljs-params>element, eventType, handler</span>) {
             element.<span class="hljs-title function_">addEventListener</span>(eventType, handler);
             <span class=hljs-keyword>return</span> <span class=hljs-function>() =&gt;</span> element.<span class="hljs-title function_">removeEventListener</span>(eventType, handler);
         },

         <span class="hljs-title function_">showToast</span>(<span class=hljs-params>message</span>) {
             <span class=hljs-keyword>const</span> toast = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"div"</span>, <span class=hljs-string>""</span>, message, [<span class=hljs-string>"toast"</span>]);
             toast.<span class=hljs-property>style</span>.<span class=hljs-property>cssText</span> =
                 <span class=hljs-string>"position: fixed; bottom: 20px; right: 20px; background: #333; color: white; padding: 10px; border-radius: 4px; z-index: 1000001;"</span>;
             <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(toast);
             <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> toast.<span class="hljs-title function_">remove</span>(), <span class=hljs-number>3000</span>);
         },

         <span class="hljs-title function_">logError</span>(<span class=hljs-params>message, error</span>) {
             <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>`[ClipboardWidget] <span class=hljs-subst>${message}</span>:`</span>, error);
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showToast</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"errorClipboard"</span>));
         },

         <span class=hljs-keyword>async</span> <span class="hljs-title function_">calculateBlobHash</span>(<span class=hljs-params>blob</span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> arrayBuffer = <span class=hljs-keyword>await</span> blob.<span class="hljs-title function_">arrayBuffer</span>();
                 <span class=hljs-keyword>const</span> bytes = <span class=hljs-keyword>new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBuffer.<span class="hljs-title function_">slice</span>(<span class=hljs-number>0</span>, <span class=hljs-number>1024</span>));
                 <span class=hljs-keyword>let</span> hash = blob.<span class=hljs-property>size</span>.<span class="hljs-title function_">toString</span>();
                 <span class=hljs-keyword>for</span> (<span class=hljs-keyword>let</span> i = <span class=hljs-number>0</span>; i &lt; bytes.<span class=hljs-property>length</span>; i += <span class=hljs-number>100</span>) {
                     hash += bytes[i]?.<span class="hljs-title function_">toString</span>() || <span class=hljs-string>""</span>;
                 }
                 <span class=hljs-keyword>return</span> hash;
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error calculating blob hash:"</span>, e);
                 <span class=hljs-keyword>return</span> <span class=hljs-literal>null</span>;
             }
         },
     };

     <span class=hljs-comment>// ==================== MÉTODOS DE FALLBACK ====================</span>
     <span class=hljs-keyword>const</span> <span class="hljs-title class_">ClipboardFallback</span> = {
         <span class="hljs-title function_">createFallbackTextarea</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> textarea = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                 <span class=hljs-string>"textarea"</span>,
                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>FALLBACK_TEXTAREA</span>
             );
             textarea.<span class=hljs-property>style</span>.<span class=hljs-property>position</span> = <span class=hljs-string>"fixed"</span>;
             textarea.<span class=hljs-property>style</span>.<span class=hljs-property>left</span> = <span class=hljs-string>"-9999px"</span>;
             textarea.<span class=hljs-property>style</span>.<span class=hljs-property>opacity</span> = <span class=hljs-string>"0"</span>;
             <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(textarea);
             <span class=hljs-keyword>return</span> textarea;
         },

         <span class="hljs-title function_">fallbackCopyText</span>(<span class=hljs-params>text</span>) {
             <span class=hljs-keyword>return</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Promise</span>(<span class=hljs-function>(<span class=hljs-params>resolve, reject</span>) =&gt;</span> {
                 <span class=hljs-keyword>try</span> {
                     <span class=hljs-keyword>const</span> textarea =
                         <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>FALLBACK_TEXTAREA</span>) ||
                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createFallbackTextarea</span>();
                     textarea.<span class=hljs-property>value</span> = text;
                     textarea.<span class="hljs-title function_">select</span>();
                     <span class=hljs-keyword>let</span> success = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(<span class=hljs-string>"copy"</span>);
                     <span class=hljs-keyword>if</span> (!success &amp;&amp; navigator.<span class=hljs-property>clipboard</span>?.<span class=hljs-property>writeText</span>) {
                         navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">writeText</span>(text).<span class="hljs-title function_">then</span>(resolve).<span class="hljs-title function_">catch</span>(reject);
                         <span class=hljs-keyword>return</span>;
                     }
                     success
                         ?
                         <span class="hljs-title function_">resolve</span>() :
                         <span class="hljs-title function_">reject</span>(<span class=hljs-keyword>new</span> <span class="hljs-title class_">Error</span>(<span class=hljs-string>"Fallback copy method failed"</span>));
                 } <span class=hljs-keyword>catch</span> (e) {
                     <span class="hljs-title function_">reject</span>(e);
                 }
             });
         },

         <span class="hljs-title function_">fallbackReadText</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>return</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Promise</span>(<span class=hljs-function>(<span class=hljs-params>resolve, reject</span>) =&gt;</span> {
                 <span class=hljs-keyword>try</span> {
                     <span class=hljs-keyword>const</span> textarea =
                         <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>FALLBACK_TEXTAREA</span>) ||
                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createFallbackTextarea</span>();
                     textarea.<span class=hljs-property>value</span> = <span class=hljs-string>""</span>;
                     textarea.<span class="hljs-title function_">select</span>();
                     <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(<span class=hljs-string>"paste"</span>)) {
                         <span class="hljs-title function_">resolve</span>(textarea.<span class=hljs-property>value</span>);
                     } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (navigator.<span class=hljs-property>clipboard</span>?.<span class=hljs-property>readText</span>) {
                         navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">readText</span>().<span class="hljs-title function_">then</span>(resolve).<span class="hljs-title function_">catch</span>(reject);
                     } <span class=hljs-keyword>else</span> {
                         <span class="hljs-title function_">reject</span>(<span class=hljs-keyword>new</span> <span class="hljs-title class_">Error</span>(<span class=hljs-string>"Fallback read method failed"</span>));
                     }
                 } <span class=hljs-keyword>catch</span> (e) {
                     <span class="hljs-title function_">reject</span>(e);
                 }
             });
         },
     };

     <span class=hljs-comment>// ==================== GESTÃO DE ESTADO ====================</span>
     <span class=hljs-keyword>const</span> <span class="hljs-title class_">StatusManager</span> = {
         <span class=hljs-attr>currentState</span>: <span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>UNKNOWN</span>,

         <span class="hljs-title function_">updateStatus</span>(<span class=hljs-params>state, message = <span class=hljs-string>""</span></span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentState</span> = state;
             <span class=hljs-keyword>const</span> indicator = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>STATUS_INDICATOR</span>);
             <span class=hljs-keyword>const</span> title = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>WIDGET_TITLE</span>);

             <span class=hljs-keyword>if</span> (indicator) {
                 indicator.<span class=hljs-property>textContent</span> = state;

                 <span class=hljs-comment>// Atualizar tooltip/aria-label baseado no estado</span>
                 <span class=hljs-keyword>let</span> statusText = <span class=hljs-string>""</span>;
                 <span class=hljs-keyword>switch</span> (state) {
                     <span class=hljs-keyword>case</span> <span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>ACTIVE</span>:
                         statusText = I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"statusActive"</span>);
                         <span class=hljs-keyword>break</span>;
                     <span class=hljs-keyword>case</span> <span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>ERROR</span>:
                         statusText = I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"statusError"</span>);
                         <span class=hljs-keyword>break</span>;
                     <span class=hljs-keyword>case</span> <span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>FALLBACK</span>:
                         statusText = I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"statusFallback"</span>);
                         <span class=hljs-keyword>break</span>;
                     <span class=hljs-keyword>case</span> <span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>DISABLED</span>:
                         statusText = I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"statusDisabled"</span>);
                         <span class=hljs-keyword>break</span>;
                     <span class=hljs-attr>default</span>:
                         statusText = <span class=hljs-string>"Unknown status"</span>;
                 }

                 indicator.<span class="hljs-title function_">setAttribute</span>(<span class=hljs-string>"aria-label"</span>, statusText);
                 indicator.<span class=hljs-property>title</span> = statusText;
             }

             <span class=hljs-keyword>if</span> (title &amp;&amp; message) {
                 title.<span class="hljs-title function_">setAttribute</span>(<span class=hljs-string>"aria-label"</span>, message);
             }

             <span class=hljs-comment>// Remover classes de estado antigas</span>
             <span class=hljs-keyword>const</span> widget = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>WIDGET</span>);
             <span class=hljs-keyword>const</span> hamburger = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>HAMBURGER_BUTTON</span>);

             <span class=hljs-keyword>if</span> (widget) {
                 widget.<span class=hljs-property>classList</span>.<span class="hljs-title function_">remove</span>(<span class=hljs-string>"permission-denied"</span>, <span class=hljs-string>"fallback-mode"</span>);
             }

             <span class=hljs-keyword>if</span> (hamburger) {
                 hamburger.<span class=hljs-property>classList</span>.<span class="hljs-title function_">remove</span>(<span class=hljs-string>"permission-denied"</span>, <span class=hljs-string>"fallback-mode"</span>, <span class=hljs-string>"monitoring"</span>);
             }

             <span class=hljs-comment>// Aplicar classes CSS baseadas no estado atual se necessário</span>
             <span class=hljs-keyword>if</span> (state === <span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>ERROR</span>) {
                 <span class=hljs-keyword>if</span> (widget) widget.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"permission-denied"</span>);
                 <span class=hljs-keyword>if</span> (hamburger) hamburger.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"permission-denied"</span>);
             } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (state === <span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>FALLBACK</span>) {
                 <span class=hljs-keyword>if</span> (widget) widget.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"fallback-mode"</span>);
                 <span class=hljs-keyword>if</span> (hamburger) hamburger.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"fallback-mode"</span>);
             }
         },

         <span class="hljs-title function_">handleClipboardReadError</span>(<span class=hljs-params>error</span>) {
             <span class=hljs-keyword>if</span> (error.<span class=hljs-property>name</span> === <span class=hljs-string>"NotAllowedError"</span>) {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateStatus</span>(<span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>ERROR</span>, I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"errorClipboard"</span>));
             } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>currentState</span> !== <span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>FALLBACK</span>) {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateStatus</span>(<span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>FALLBACK</span>, <span class=hljs-string>"Using alternative method"</span>);
             } <span class=hljs-keyword>else</span> {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateStatus</span>(<span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>ERROR</span>, I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"errorClipboard"</span>));
             }
         }
     };

     <span class=hljs-comment>// ==================== ESTILOS ====================</span>
     <span class=hljs-keyword>const</span> <span class="hljs-title class_">Styles</span> = {
         <span class="hljs-title function_">inject</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> styleContent = <span class=hljs-string>`
        #<span class=hljs-subst>${Constants.IDs.HAMBURGER_BUTTON}</span> {
          position: fixed;
          top: 13px;
          right: 18px;
          z-index: 1000000;
          background: #b33939;
          color: white;
          border: none;
          width: 40px;
          height: 40px;
          border-radius: 50%;
          font-size: 1.5em;
          cursor: pointer;
          box-shadow: 0 2px 10px rgba(0,0,0,0.3);
          display: flex;
          justify-content: center;
          align-items: center;
          transition: background 0.3s ease;
        }
        #<span class=hljs-subst>${Constants.IDs.HAMBURGER_BUTTON}</span>:hover, #<span class=hljs-subst>${Constants.IDs.HAMBURGER_BUTTON}</span>:focus {
          background: #923030;
          outline: 2px solid #fff;
        }
        #<span class=hljs-subst>${Constants.IDs.HAMBURGER_BUTTON}</span>.permission-denied {
          background: #ff6b6b;
        }
        #<span class=hljs-subst>${Constants.IDs.HAMBURGER_BUTTON}</span>.fallback-mode {
          background: #ffa502;
        }

        #<span class=hljs-subst>${Constants.IDs.WIDGET}</span> {
          position: fixed;
          top: 0;
          right: -100%;
          min-width: 250px;
          max-width: 400px;
          width: calc(100% - 30px);
          height: 100%;
          background: #2e8b57;
          color: white;
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          box-shadow: 0 0 15px rgba(0,0,0,0.5);
          transition: right 0.3s ease-in-out;
          padding: 15px;
          box-sizing: border-box;
          overflow-y: auto;
          z-index: 999999;
          touch-action: pan-y;
        }
        #<span class=hljs-subst>${Constants.IDs.WIDGET}</span>.active {
          right: 0;
        }
        #<span class=hljs-subst>${Constants.IDs.WIDGET}</span>.dark-theme {
          background: #333;
          color: #fff;
        }
        #<span class=hljs-subst>${Constants.IDs.WIDGET}</span>.permission-denied {
          background: #ff6b6b;
        }
        #<span class=hljs-subst>${Constants.IDs.WIDGET}</span>.fallback-mode {
          background: #ffa502;
        }
        #<span class=hljs-subst>${Constants.IDs.WIDGET}</span>.minimized {
          max-height: 115px;
          overflow: hidden;
        }
        #<span class=hljs-subst>${Constants.IDs.WIDGET}</span>.minimized #<span class=hljs-subst>${Constants.IDs.CONTENT}</span> {
          display: block;
          max-height: 200px;
          overflow: hidden;
        }

        .widget-title-container {
          display: flex;
          align-items: center;
          margin-bottom: 15px;
          padding-bottom: 10px;
          border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .status-indicator {
          font-size: 0.8em;
          margin-right: 8px;
          cursor: help;
        }
        
        .widget-title {
          font-weight: bold;
          font-size: 1.1em;
        }

        #<span class=hljs-subst>${Constants.IDs.CONTROLS}</span> {
          display: flex;
          flex-wrap: nowrap;
          justify-content: center;
          gap: 5px;
          margin-bottom: 15px;
          flex-direction: row;
        }
        
        #<span class=hljs-subst>${Constants.IDs.CONTROLS}</span> button, #<span class=hljs-subst>${Constants.IDs.READ_BUTTON}</span>, #<span class=hljs-subst>${Constants.IDs.EXPORT_BUTTON}</span>, #<span class=hljs-subst>${Constants.IDs.IMPORT_BUTTON}</span> {
          background: rgba(0,0,0,0.3);
          color: white;
          border: none;
          padding: 5px 5px;
          cursor: pointer;
          border-radius: 4px;
          font-size: 1em;
          transition: background 0.2s ease;
          display: flex;
          align-items: center;
          gap: 3px;
          width: auto;
          justify-content: center;
        }
        
        #<span class=hljs-subst>${Constants.IDs.CONTROLS}</span> button:hover, #<span class=hljs-subst>${Constants.IDs.READ_BUTTON}</span>:hover, #<span class=hljs-subst>${Constants.IDs.EXPORT_BUTTON}</span>:hover, #<span class=hljs-subst>${Constants.IDs.IMPORT_BUTTON}</span>:hover,
        #<span class=hljs-subst>${Constants.IDs.CONTROLS}</span> button:focus, #<span class=hljs-subst>${Constants.IDs.READ_BUTTON}</span>:focus, #<span class=hljs-subst>${Constants.IDs.EXPORT_BUTTON}</span>:focus, #<span class=hljs-subst>${Constants.IDs.IMPORT_BUTTON}</span>:focus {
          background: rgba(0,0,0,0.5);
          outline: 2px solid #fff;
        }
        
        #<span class=hljs-subst>${Constants.IDs.READ_BUTTON}</span> {
          display: block;
          margin-top: 20px;
          width: 100%;
          text-align: center;
          padding: 8px 12px;
          font-size: 0.9em;
        }

        #<span class=hljs-subst>${Constants.IDs.SEARCH_BAR}</span> {
          width: 100%;
          padding: 8px;
          margin-bottom: 10px;
          border: none;
          border-radius: 4px;
          background: rgba(255,255,255,0.2);
          color: white;
          font-size: 0.9em;
        }
        #<span class=hljs-subst>${Constants.IDs.SEARCH_BAR}</span>:focus {
          outline: 2px solid #fff;
        }

        #<span class=hljs-subst>${Constants.IDs.CONTENT}</span> {
          white-space: pre-wrap;
          word-break: break-all;
        }
        
        .clipboard-tabs {
          display: flex;
          margin-bottom: 10px;
          border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        .clipboard-tab {
          padding: 8px 12px;
          cursor: pointer;
          border-bottom: 2px solid transparent;
          transition: all 0.2s ease;
        }
        .clipboard-tab.active {
          border-bottom-color: white;
          font-weight: bold;
        }
        .clipboard-tab:hover, .clipboard-tab:focus {
          background: rgba(255,255,255,0.1);
          outline: 2px solid #fff;
        }
        
        #<span class=hljs-subst>${Constants.IDs.CONTENT}</span> ul {
          list-style: none;
          padding: 0;
          margin: 0;
          max-height: none;
          background: rgba(255, 255, 255, 0.1);
          border-radius: 5px;
          padding: 5px;
        }
        #<span class=hljs-subst>${Constants.IDs.CONTENT}</span> li {
          background: rgba(0, 0, 0, 0.3);
          margin-bottom: 10px;
          padding: 6px 8px;
          border-radius: 5px;
          cursor: pointer;
          transition: background 0.2s ease;
          word-break: break-word;
          font-size: 0.85em;
          position: relative;
          display: flex;
          flex-direction: column;
          max-height: 200px;
          overflow: hidden;
        }

        #<span class=hljs-subst>${Constants.IDs.CONTENT}</span> li:hover:not(.editing), #<span class=hljs-subst>${Constants.IDs.CONTENT}</span> li:focus-within:not(.editing) {
          background: rgba(255, 255, 255, 0.3);
          outline: 2px solid orange !important;
        }

        #<span class=hljs-subst>${Constants.IDs.CONTENT}</span> li.editing {
          cursor: text;
          min-height: 450px;
          border: 2px solid orange;
        }
        #<span class=hljs-subst>${Constants.IDs.CONTENT}</span> li img {
          max-width: 100%;
          max-height: 200px;
          border-radius: 4px;
          margin-top: 5px;
          object-fit: contain;
        }
        #<span class=hljs-subst>${Constants.IDs.CONTENT}</span> li span.timestamp {
          display: block;
          font-size: 0.7em;
          color: rgba(255, 255, 255, 0.7);
          margin-top: 3px;
        }
        #<span class=hljs-subst>${Constants.IDs.CONTENT}</span> .empty-history {
          font-style: italic;
          color: rgba(255, 255, 255, 0.7);
          text-align: center;
          padding: 20px 0;
        }
        
        .action-buttons {
          display: flex;
          justify-content: flex-end;
          gap: 5px;
          margin-bottom: 10px;
          visibility: hidden;
        }

        li:hover .action-buttons {
          visibility: visible;
        }
        
        .pin-btn, .delete-btn, .edit-btn {
          background: none;
          border: 1px solid #fff;
          border-radius: 3px;
          cursor: pointer;
          font-size: 1em;
          transition: all 0.2s ease;
        }
        .pin-btn:hover, .pin-btn:focus, .delete-btn:hover, .delete-btn:focus, .edit-btn:hover, .edit-btn:focus {
          color: white;
          outline: 2px solid #fff;
        }
        .pin-btn.pinned {
          color: gold;
        }
        .pin-btn.pinned:hover, .pin-btn.pinned:focus {
          color: goldenrod;
        }
        
        .fallback-warning {
          background: rgba(255, 165, 2, 0.3);
          padding: 8px;
          border-radius: 4px;
          margin-bottom: 10px;
          font-size: 0.8em;
        }

        .storage-limit-warning {
          background: rgba(255, 99, 71, 0.3);
          padding: 8px;
          border-radius: 4px;
          margin-bottom: 10px;
          font-size: 0.8em;
        }
        
        .toast {
          position: fixed;
          bottom: 20px;
          right: 20px;
          background: #333;
          color: white;
          padding: 10px;
          border-radius: 4px;
          z-index: 1000001;
        }

        .loading {
          text-align: center;
          padding: 20px;
          color: rgba(255, 255, 255, 0.7);
        }

        .error {
          text-align: center;
          padding: 20px;
          color: #ff6b6b;
        }

        .edit-textarea {
          width: 100%;
          background: rgba(255, 255, 255, 0.1);
          color: white;
          border: none;
          border-radius: 3px;
          padding: 5px;
          box-sizing: border-box;
          margin-top: 5px;
          min-height: 390px;
          resize: vertical;
        }
        .edit-textarea:focus {
          outline: 2px solid #fff;
        }

        @media (prefers-color-scheme: dark) {
          #<span class=hljs-subst>${Constants.IDs.WIDGET}</span> {
            background: #333;
            color: #fff;
          }
          #<span class=hljs-subst>${Constants.IDs.HAMBURGER_BUTTON}</span> {
            background: #8b0000;
          }
          #<span class=hljs-subst>${Constants.IDs.HAMBURGER_BUTTON}</span>.permission-denied {
            background: #b22222;
          }
          #<span class=hljs-subst>${Constants.IDs.HAMBURGER_BUTTON}</span>.fallback-mode {
            background: #cc8400;
          }
        }

        @media (max-width: 600px) {
          #<span class=hljs-subst>${Constants.IDs.HAMBURGER_BUTTON}</span> {
            top: 1px;
            right: 10px;
            width: 35px;
            height: 35px;
            font-size: 1.2em;
          }
          #<span class=hljs-subst>${Constants.IDs.WIDGET}</span> {
            min-width: 200px;
            max-width: 90%;
            width: calc(100% - 20px);
          }

          #<span class=hljs-subst>${Constants.IDs.CONTROLS}</span> button, #<span class=hljs-subst>${Constants.IDs.EXPORT_BUTTON}</span>, #<span class=hljs-subst>${Constants.IDs.IMPORT_BUTTON}</span> {
            min-width: 50px;
            padding: 3px 5px;
            font-size: 0.7em;
          }
        }
      `</span>;

             <span class=hljs-keyword>const</span> styleEl = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"style"</span>);
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>trustedTypes</span> &amp;&amp; <span class="hljs-variable language_">window</span>.<span class=hljs-property>trustedTypes</span>.<span class=hljs-property>createPolicy</span>) {
                 <span class=hljs-keyword>try</span> {
                     <span class=hljs-keyword>const</span> policy = trustedTypes.<span class="hljs-title function_">createPolicy</span>(
                         <span class=hljs-string>"clipboardWidgetStylePolicy"</span>, {
                             <span class=hljs-attr>createHTML</span>: <span class=hljs-function>(<span class=hljs-params>string</span>) =&gt;</span> string,
                         }
                     );
                     <span class="hljs-title class_">Security</span>.<span class="hljs-title function_">safeSetInnerHTML</span>(styleEl, policy.<span class="hljs-title function_">createHTML</span>(styleContent));
                 } <span class=hljs-keyword>catch</span> (e) {
                     styleEl.<span class=hljs-property>textContent</span> = styleContent;
                 }
             } <span class=hljs-keyword>else</span> {
                 styleEl.<span class=hljs-property>textContent</span> = styleContent;
             }

             <span class="hljs-variable language_">document</span>.<span class=hljs-property>head</span>.<span class="hljs-title function_">appendChild</span>(styleEl);
         },
     };

     <span class=hljs-comment>// ==================== CONVERSÃO DE DADOS ====================</span>
     <span class=hljs-keyword>const</span> <span class="hljs-title class_">DataConversion</span> = {
         <span class=hljs-keyword>async</span> <span class="hljs-title function_">blobToBase64</span>(<span class=hljs-params>blob</span>) {
             <span class=hljs-keyword>return</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Promise</span>(<span class=hljs-function>(<span class=hljs-params>resolve, reject</span>) =&gt;</span> {
                 <span class=hljs-keyword>const</span> reader = <span class=hljs-keyword>new</span> <span class="hljs-title class_">FileReader</span>();
                 reader.<span class=hljs-property>onloadend</span> = <span class=hljs-function>() =&gt;</span> <span class="hljs-title function_">resolve</span>(reader.<span class=hljs-property>result</span>);
                 reader.<span class=hljs-property>onerror</span> = reject;
                 reader.<span class="hljs-title function_">readAsDataURL</span>(blob);
             });
         },

         <span class="hljs-title function_">base64ToBlob</span>(<span class=hljs-params>base64, mimeType</span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> byteString = <span class="hljs-title function_">atob</span>(base64.<span class="hljs-title function_">split</span>(<span class=hljs-string>","</span>)[<span class=hljs-number>1</span>]);
                 <span class=hljs-keyword>const</span> ab = <span class=hljs-keyword>new</span> <span class="hljs-title class_">ArrayBuffer</span>(byteString.<span class=hljs-property>length</span>);
                 <span class=hljs-keyword>const</span> ia = <span class=hljs-keyword>new</span> <span class="hljs-title class_">Uint8Array</span>(ab);
                 <span class=hljs-keyword>for</span> (<span class=hljs-keyword>let</span> i = <span class=hljs-number>0</span>; i &lt; byteString.<span class=hljs-property>length</span>; i++) {
                     ia[i] = byteString.<span class="hljs-title function_">charCodeAt</span>(i);
                 }
                 <span class=hljs-keyword>return</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Blob</span>([ab], {
                     <span class=hljs-attr>type</span>: mimeType
                 });
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error converting base64 to blob:"</span>, e);
                 <span class=hljs-keyword>return</span> <span class=hljs-literal>null</span>;
             }
         },
     };

     <span class=hljs-comment>// ==================== GESTÃO DO HISTÓRICO ====================</span>
     <span class=hljs-keyword>const</span> <span class="hljs-title class_">HistoryManager</span> = {
         <span class=hljs-attr>clipboardHistory</span>: [],
         <span class=hljs-attr>currentTab</span>: <span class=hljs-string>"history"</span>,
         <span class=hljs-attr>usingFallback</span>: <span class=hljs-literal>false</span>,
         <span class=hljs-attr>storageLimitWarning</span>: <span class=hljs-literal>false</span>,

         <span class="hljs-title function_">validateHistoryItem</span>(<span class=hljs-params>item</span>) {
             <span class=hljs-keyword>if</span> (!item || <span class=hljs-keyword>typeof</span> item !== <span class=hljs-string>"object"</span>) <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
             <span class=hljs-keyword>if</span> (!item.<span class=hljs-property>type</span> || ![<span class=hljs-string>"text"</span>, <span class=hljs-string>"image"</span>].<span class="hljs-title function_">includes</span>(item.<span class=hljs-property>type</span>)) <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
             <span class=hljs-keyword>if</span> (<span class=hljs-keyword>typeof</span> item.<span class=hljs-property>timestamp</span> !== <span class=hljs-string>"number"</span>) <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
             <span class=hljs-keyword>if</span> (item.<span class=hljs-property>type</span> === <span class=hljs-string>"text"</span> &amp;&amp; <span class=hljs-keyword>typeof</span> item.<span class=hljs-property>text</span> !== <span class=hljs-string>"string"</span>) <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
             <span class=hljs-keyword>if</span> (item.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span> &amp;&amp; (!item.<span class=hljs-property>data</span> || !item.<span class=hljs-property>mimeType</span>)) <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
             <span class=hljs-keyword>return</span> <span class=hljs-literal>true</span>;
         },

         <span class="hljs-title function_">backupHistory</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> currentHistory = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(
                     <span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>HISTORY</span>
                 );
                 <span class=hljs-keyword>if</span> (currentHistory) {
                     <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(
                         <span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>HISTORY_BACKUP</span>,
                         currentHistory
                     );
                 }
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Failed to backup history:"</span>, e);
                 <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">showToast</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"backupFailed"</span>));
             }
         },

         <span class="hljs-title function_">restoreFromBackup</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> backup = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(
                     <span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>HISTORY_BACKUP</span>
                 );
                 <span class=hljs-keyword>if</span> (backup) {
                     <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>HISTORY</span>, backup);
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">showToast</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"historyRestored"</span>));
                     <span class=hljs-keyword>return</span> <span class=hljs-literal>true</span>;
                 }
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Failed to restore from backup:"</span>, e);
             }
             <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
         },

         <span class="hljs-title function_">loadClipboardHistory</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> historyJson = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>HISTORY</span>);
                 <span class=hljs-keyword>if</span> (!historyJson) <span class=hljs-keyword>return</span>;
                 <span class=hljs-keyword>let</span> parsedHistory;
                 <span class=hljs-keyword>try</span> {
                     parsedHistory = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(historyJson);
                     <span class=hljs-keyword>if</span> (!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(parsedHistory)) {
                         <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Error</span>(<span class=hljs-string>"Invalid history format"</span>);
                     }
                 } <span class=hljs-keyword>catch</span> (e) {
                     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error parsing history JSON:"</span>, e);
                     <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restoreFromBackup</span>()) {
                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadClipboardHistory</span>();
                         <span class=hljs-keyword>return</span>;
                     }
                     <span class=hljs-keyword>throw</span> e;
                 }
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span> = parsedHistory
                     .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> {
                         <span class=hljs-keyword>if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateHistoryItem</span>(item)) {
                             <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class=hljs-string>"Invalid history item found:"</span>, item);
                             <span class=hljs-keyword>return</span> <span class=hljs-literal>null</span>;
                         }
                         <span class=hljs-keyword>const</span> newItem = {
                             ...item
                         };
                         <span class=hljs-keyword>if</span> (newItem.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span> &amp;&amp; newItem.<span class=hljs-property>data</span>) {
                             <span class=hljs-keyword>try</span> {
                                 <span class=hljs-keyword>const</span> blob = <span class="hljs-title class_">DataConversion</span>.<span class="hljs-title function_">base64ToBlob</span>(
                                     newItem.<span class=hljs-property>data</span>,
                                     newItem.<span class=hljs-property>mimeType</span>
                                 );
                                 <span class=hljs-keyword>if</span> (!blob) <span class=hljs-keyword>return</span> <span class=hljs-literal>null</span>;
                                 newItem.<span class=hljs-property>url</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
                             } <span class=hljs-keyword>catch</span> (e) {
                                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error creating blob URL:"</span>, e);
                                 <span class=hljs-keyword>return</span> <span class=hljs-literal>null</span>;
                             }
                         }
                         <span class=hljs-keyword>return</span> newItem;
                     })
                     .<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">sort</span>(<span class=hljs-function>(<span class=hljs-params>a, b</span>) =&gt;</span> b.<span class=hljs-property>timestamp</span> - a.<span class=hljs-property>timestamp</span>);
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error loading clipboard history:"</span>, e);
                 <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>HISTORY</span>);
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span> = [];
             }
         },

         <span class=hljs-keyword>async</span> <span class="hljs-title function_">saveClipboardHistory</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">backupHistory</span>();
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> historyToSave = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> {
                     <span class=hljs-keyword>if</span> (item.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span> &amp;&amp; item.<span class=hljs-property>url</span>) {
                         <span class=hljs-keyword>const</span> {
                             url,
                             ...rest
                         } = item;
                         <span class=hljs-keyword>return</span> rest;
                     }
                     <span class=hljs-keyword>return</span> item;
                 });
                 <span class=hljs-keyword>const</span> historyString = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(historyToSave);
                 <span class=hljs-keyword>if</span> (historyString.<span class=hljs-property>length</span> &gt; <span class="hljs-title class_">Constants</span>.<span class=hljs-property>Limits</span>.<span class=hljs-property>MAX_STORAGE_SIZE</span>) {
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>storageLimitWarning</span> = <span class=hljs-literal>true</span>;
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">showToast</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"storageLimitExceeded"</span>));
                     <span class=hljs-keyword>const</span> textOnlyHistory = historyToSave.<span class="hljs-title function_">filter</span>(
                         <span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> item.<span class=hljs-property>type</span> === <span class=hljs-string>"text"</span>
                     );
                     <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(
                         <span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>HISTORY</span>,
                         <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(textOnlyHistory)
                     );
                     <span class=hljs-keyword>return</span>;
                 }
                 <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>HISTORY</span>, historyString);
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>storageLimitWarning</span> = <span class=hljs-literal>false</span>;
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class=hljs-keyword>if</span> (e.<span class=hljs-property>name</span> === <span class=hljs-string>"QuotaExceededError"</span>) {
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>storageLimitWarning</span> = <span class=hljs-literal>true</span>;
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">showToast</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"storageLimitExceeded"</span>));
                     <span class=hljs-keyword>try</span> {
                         <span class=hljs-keyword>const</span> reducedHistory = historyToSave.<span class="hljs-title function_">slice</span>(<span class=hljs-number>0</span>, <span class=hljs-number>10</span>);
                         <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(
                             <span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>HISTORY</span>,
                             <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(reducedHistory)
                         );
                     } <span class=hljs-keyword>catch</span> (e2) {
                         <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Failed to save reduced history:"</span>, e2);
                         <span class=hljs-keyword>try</span> {
                             <span class=hljs-keyword>const</span> textOnlyHistory = historyToSave.<span class="hljs-title function_">filter</span>(
                                 <span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> item.<span class=hljs-property>type</span> === <span class=hljs-string>"text"</span>
                             );
                             <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(
                                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>HISTORY</span>,
                                 <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(textOnlyHistory)
                             );
                         } <span class=hljs-keyword>catch</span> (e3) {
                             <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Failed to save text-only history:"</span>, e3);
                         }
                     }
                 } <span class=hljs-keyword>else</span> {
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">logError</span>(<span class=hljs-string>"Error saving clipboard history"</span>, e);
                 }
             }
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderClipboardHistory</span>();
         },

         <span class="hljs-title function_">cleanupResources</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> {
                 <span class=hljs-keyword>if</span> (item.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span> &amp;&amp; item.<span class=hljs-property>url</span>) {
                     <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(item.<span class=hljs-property>url</span>);
                 }
             });
             <span class=hljs-keyword>const</span> fallbackTextarea = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(
                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>FALLBACK_TEXTAREA</span>
             );
             <span class=hljs-keyword>if</span> (fallbackTextarea) {
                 fallbackTextarea.<span class="hljs-title function_">remove</span>();
             }
         },

         <span class=hljs-keyword>async</span> <span class="hljs-title function_">addClipboardItem</span>(<span class=hljs-params>item</span>) {
             <span class=hljs-keyword>if</span> (!item.<span class=hljs-property>text</span> &amp;&amp; !item.<span class=hljs-property>data</span>) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class=hljs-string>"Attempted to add empty clipboard item"</span>);
                 <span class=hljs-keyword>return</span>;
             }
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> sanitizedItem = {
                     <span class=hljs-attr>type</span>: item.<span class=hljs-property>type</span>,
                     <span class=hljs-attr>text</span>: item.<span class=hljs-property>text</span> ? <span class="hljs-title class_">Security</span>.<span class="hljs-title function_">sanitizeText</span>(item.<span class=hljs-property>text</span>) : <span class=hljs-literal>undefined</span>,
                     <span class=hljs-attr>data</span>: item.<span class=hljs-property>data</span> || <span class=hljs-literal>undefined</span>,
                     <span class=hljs-attr>mimeType</span>: item.<span class=hljs-property>mimeType</span> || <span class=hljs-literal>undefined</span>,
                     <span class=hljs-attr>url</span>: item.<span class=hljs-property>url</span> || <span class=hljs-literal>undefined</span>,
                     <span class=hljs-attr>hash</span>: item.<span class=hljs-property>hash</span> || <span class=hljs-literal>null</span>,
                     <span class=hljs-attr>timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
                     <span class=hljs-attr>pinned</span>: item.<span class=hljs-property>pinned</span> || <span class=hljs-literal>false</span>,
                 };
                 <span class=hljs-keyword>const</span> existingIndex = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">findIndex</span>(
                     <span class=hljs-function>(<span class=hljs-params>i</span>) =&gt;</span>
                     (i.<span class=hljs-property>text</span> &amp;&amp; i.<span class=hljs-property>text</span> === sanitizedItem.<span class=hljs-property>text</span>) ||
                     (i.<span class=hljs-property>hash</span> &amp;&amp; i.<span class=hljs-property>hash</span> === sanitizedItem.<span class=hljs-property>hash</span>)
                 );
                 <span class=hljs-keyword>if</span> (existingIndex !== -<span class=hljs-number>1</span>) {
                     <span class=hljs-keyword>const</span> [foundItem] = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">splice</span>(existingIndex, <span class=hljs-number>1</span>);
                     <span class=hljs-keyword>if</span> (foundItem.<span class=hljs-property>url</span> &amp;&amp; foundItem.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span>) {
                         <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(foundItem.<span class=hljs-property>url</span>);
                     }
                     foundItem.<span class=hljs-property>timestamp</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
                     foundItem.<span class=hljs-property>url</span> = sanitizedItem.<span class=hljs-property>url</span>;
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">unshift</span>(foundItem);
                 } <span class=hljs-keyword>else</span> {
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">unshift</span>(sanitizedItem);
                 }
                 <span class=hljs-keyword>await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveClipboardHistory</span>();
                 <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">showToast</span>(
                     item.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span> ?
                     I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"imageAdded"</span>) :
                     I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"newItemAdded"</span>)
                 );
                 sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"active"</span>);
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error adding clipboard item:"</span>, e);
                 <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">showToast</span>(<span class=hljs-string>"Failed to add item to history"</span>);
             }
         },

         <span class="hljs-title function_">togglePinnedState</span>(<span class=hljs-params>index</span>) {
             <span class=hljs-keyword>if</span> (index &gt;= <span class=hljs-number>0</span> &amp;&amp; index &lt; <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class=hljs-property>length</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>[index].<span class=hljs-property>pinned</span> = !<span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>[index].<span class=hljs-property>pinned</span>;
                 <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>[index].<span class=hljs-property>pinned</span>) {
                     <span class=hljs-keyword>const</span> [pinnedItem] = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">splice</span>(index, <span class=hljs-number>1</span>);
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">unshift</span>(pinnedItem);
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTab</span> = <span class=hljs-string>"pinned"</span>;
                 }
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveClipboardHistory</span>();
             }
         },

         <span class="hljs-title function_">deleteClipboardItem</span>(<span class=hljs-params>index</span>) {
             <span class=hljs-keyword>if</span> (index &gt;= <span class=hljs-number>0</span> &amp;&amp; index &lt; <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class=hljs-property>length</span>) {
                 <span class=hljs-keyword>if</span> (<span class="hljs-title function_">confirm</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"deleteItemConfirm"</span>))) {
                     <span class=hljs-keyword>const</span> [deletedItem] = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">splice</span>(index, <span class=hljs-number>1</span>);
                     <span class=hljs-keyword>if</span> (deletedItem.<span class=hljs-property>url</span> &amp;&amp; deletedItem.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span>) {
                         <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(deletedItem.<span class=hljs-property>url</span>);
                     }
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveClipboardHistory</span>();
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">showToast</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"itemDeleted"</span>));
                 }
             }
         },

         <span class="hljs-title function_">editClipboardItem</span>(<span class=hljs-params>index, liElement</span>) {
             <span class=hljs-keyword>const</span> item = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>[index];
             <span class=hljs-keyword>if</span> (item.<span class=hljs-property>type</span> !== <span class=hljs-string>"text"</span>) {
                 <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">showToast</span>(<span class=hljs-string>"Only text items can be edited."</span>);
                 <span class=hljs-keyword>return</span>;
             }

             liElement.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"editing"</span>);

             <span class=hljs-comment>// Remove the static text and timestamp</span>
             <span class=hljs-keyword>const</span> textNode = liElement.<span class=hljs-property>childNodes</span>[<span class=hljs-number>1</span>];
             <span class=hljs-keyword>const</span> timestampNode = liElement.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".timestamp"</span>);
             textNode?.<span class="hljs-title function_">remove</span>();
             timestampNode?.<span class="hljs-title function_">remove</span>();

             <span class=hljs-keyword>const</span> textarea = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"textarea"</span>, <span class=hljs-string>""</span>, item.<span class=hljs-property>text</span>, [
                 <span class=hljs-string>"edit-textarea"</span>,
             ]);
             liElement.<span class="hljs-title function_">appendChild</span>(textarea);
             textarea.<span class="hljs-title function_">focus</span>();

             <span class=hljs-keyword>function</span> <span class="hljs-title function_">saveEdit</span>(<span class=hljs-params></span>) {
                 <span class=hljs-keyword>const</span> newText = textarea.<span class=hljs-property>value</span>;
                 <span class=hljs-keyword>if</span> (newText &amp;&amp; newText !== item.<span class=hljs-property>text</span>) {
                     item.<span class=hljs-property>text</span> = <span class="hljs-title class_">Security</span>.<span class="hljs-title function_">sanitizeText</span>(newText);
                     item.<span class=hljs-property>timestamp</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveClipboardHistory</span>();
                 }
                 liElement.<span class=hljs-property>classList</span>.<span class="hljs-title function_">remove</span>(<span class=hljs-string>"editing"</span>);
                 liElement.<span class="hljs-title function_">removeChild</span>(textarea);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderClipboardHistory</span>();
             }

             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(textarea, <span class=hljs-string>"blur"</span>, saveEdit.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(textarea, <span class=hljs-string>"keydown"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                 <span class=hljs-keyword>if</span> (e.<span class=hljs-property>key</span> === <span class=hljs-string>"Enter"</span> &amp;&amp; !e.<span class=hljs-property>shiftKey</span>) {
                     e.<span class="hljs-title function_">preventDefault</span>();
                     saveEdit.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);
                 }
             });
         },

         <span class="hljs-title function_">renderClipboardHistory</span>(<span class=hljs-params>filter = <span class="hljs-variable language_">this</span>.clipboardHistory</span>) {
             contentEl.<span class=hljs-property>innerHTML</span> = <span class=hljs-string>`&lt;div class="loading"&gt;<span class=hljs-subst>${I18n.getTranslation(
        <span class=hljs-string>"loadingHistory"</span>
      )}</span>&lt;/div&gt;`</span>;
             <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> {
                 <span class=hljs-keyword>try</span> {
                     <span class=hljs-keyword>const</span> fragment = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createDocumentFragment</span>();
                     <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>usingFallback</span>) {
                         <span class=hljs-keyword>const</span> warning = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                             <span class=hljs-string>"div"</span>,
                             <span class=hljs-string>""</span>,
                             <span class=hljs-string>"Alternate mode enabled (limited clipboard support)"</span>,
                             [<span class=hljs-string>"fallback-warning"</span>]
                         );
                         fragment.<span class="hljs-title function_">appendChild</span>(warning);
                     }
                     <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>storageLimitWarning</span>) {
                         <span class=hljs-keyword>const</span> warning = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                             <span class=hljs-string>"div"</span>,
                             <span class=hljs-string>""</span>,
                             I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"storageLimitExceeded"</span>),
                             [<span class=hljs-string>"storage-limit-warning"</span>]
                         );
                         fragment.<span class="hljs-title function_">appendChild</span>(warning);
                     }
                     <span class=hljs-keyword>const</span> tabsContainer = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"div"</span>, <span class=hljs-string>""</span>, <span class=hljs-string>""</span>, [
                         <span class=hljs-string>"clipboard-tabs"</span>,
                     ]);
                     <span class=hljs-keyword>const</span> historyCount = filter.<span class="hljs-title function_">filter</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> !item.<span class=hljs-property>pinned</span>).<span class=hljs-property>length</span>;
                     <span class=hljs-keyword>const</span> pinnedCount = filter.<span class="hljs-title function_">filter</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> item.<span class=hljs-property>pinned</span>).<span class=hljs-property>length</span>;
                     <span class=hljs-keyword>const</span> historyTab = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                         <span class=hljs-string>"div"</span>,
                         <span class=hljs-string>""</span>,
                         <span class=hljs-string>`<span class=hljs-subst>${I18n.getTranslation(<span class=hljs-string>"historyTab"</span>)}</span> (<span class=hljs-subst>${historyCount}</span>)`</span>,
                         [<span class=hljs-string>"clipboard-tab"</span>]
                     );
                     <span class=hljs-keyword>const</span> pinnedTab = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                         <span class=hljs-string>"div"</span>,
                         <span class=hljs-string>""</span>,
                         <span class=hljs-string>`<span class=hljs-subst>${I18n.getTranslation(<span class=hljs-string>"pinnedTab"</span>)}</span> (<span class=hljs-subst>${pinnedCount}</span>)`</span>,
                         [<span class=hljs-string>"clipboard-tab"</span>]
                     );
                     <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTab</span> === <span class=hljs-string>"history"</span>) historyTab.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"active"</span>);
                     <span class=hljs-keyword>else</span> pinnedTab.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"active"</span>);
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(historyTab, <span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span> {
                         <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTab</span> = <span class=hljs-string>"history"</span>;
                         <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>SEARCH_BAR</span>).<span class=hljs-property>value</span> = <span class=hljs-string>""</span>;
                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderClipboardHistory</span>();
                     });
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(pinnedTab, <span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span> {
                         <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTab</span> = <span class=hljs-string>"pinned"</span>;
                         <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>SEARCH_BAR</span>).<span class=hljs-property>value</span> = <span class=hljs-string>""</span>;
                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderClipboardHistory</span>();
                     });
                     tabsContainer.<span class="hljs-title function_">append</span>(historyTab, pinnedTab);
                     fragment.<span class="hljs-title function_">appendChild</span>(tabsContainer);
                     <span class=hljs-keyword>const</span> itemsToDisplay =
                         <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTab</span> === <span class=hljs-string>"history"</span> ?
                         filter.<span class="hljs-title function_">filter</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> !item.<span class=hljs-property>pinned</span>) :
                         filter.<span class="hljs-title function_">filter</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> item.<span class=hljs-property>pinned</span>);
                     <span class=hljs-keyword>if</span> (itemsToDisplay.<span class=hljs-property>length</span> === <span class=hljs-number>0</span>) {
                         <span class=hljs-keyword>const</span> emptyMessage = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                             <span class=hljs-string>"div"</span>,
                             <span class=hljs-string>""</span>,
                             <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTab</span> === <span class=hljs-string>"history"</span> ?
                             I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"emptyHistory"</span>) :
                             I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"emptyPinned"</span>),
                             [<span class=hljs-string>"empty-history"</span>]
                         );
                         fragment.<span class="hljs-title function_">appendChild</span>(emptyMessage);
                     } <span class=hljs-keyword>else</span> {
                         <span class=hljs-keyword>const</span> ul = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"ul"</span>);
                         itemsToDisplay.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>item, index</span>) =&gt;</span> {
                             <span class=hljs-keyword>const</span> actualIndex = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">findIndex</span>(
                                 <span class=hljs-function>(<span class=hljs-params>i</span>) =&gt;</span>
                                 (i.<span class=hljs-property>text</span> &amp;&amp; i.<span class=hljs-property>text</span> === item.<span class=hljs-property>text</span>) ||
                                 (i.<span class=hljs-property>hash</span> &amp;&amp; i.<span class=hljs-property>hash</span> === item.<span class=hljs-property>hash</span>)
                             );
                             <span class=hljs-keyword>const</span> li = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"li"</span>);
                             <span class=hljs-keyword>const</span> actionButtons = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"div"</span>, <span class=hljs-string>""</span>, <span class=hljs-string>""</span>, [
                                 <span class=hljs-string>"action-buttons"</span>,
                             ]);

                             <span class=hljs-keyword>const</span> editBtn = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"button"</span>, <span class=hljs-string>""</span>, <span class=hljs-string>"✍️"</span>, [
                                 <span class=hljs-string>"edit-btn"</span>,
                             ]);
                             <span class=hljs-keyword>const</span> pinBtn = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"button"</span>, <span class=hljs-string>""</span>, <span class=hljs-string>"📌"</span>, [
                                 <span class=hljs-string>"pin-btn"</span>,
                             ]);
                             <span class=hljs-keyword>if</span> (item.<span class=hljs-property>pinned</span>) pinBtn.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"pinned"</span>);
                             <span class=hljs-keyword>const</span> deleteBtn = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"button"</span>, <span class=hljs-string>""</span>, <span class=hljs-string>"🗙"</span>, [
                                 <span class=hljs-string>"delete-btn"</span>,
                             ]);
                             actionButtons.<span class="hljs-title function_">append</span>(editBtn, pinBtn, deleteBtn);

                             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(editBtn, <span class=hljs-string>"click"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                                 e.<span class="hljs-title function_">stopPropagation</span>();
                                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">editClipboardItem</span>(actualIndex, li);
                             });

                             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(pinBtn, <span class=hljs-string>"click"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                                 e.<span class="hljs-title function_">stopPropagation</span>();
                                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">togglePinnedState</span>(actualIndex);
                             });
                             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(deleteBtn, <span class=hljs-string>"click"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                                 e.<span class="hljs-title function_">stopPropagation</span>();
                                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">deleteClipboardItem</span>(actualIndex);
                             });
                             li.<span class="hljs-title function_">appendChild</span>(actionButtons);
                             <span class=hljs-keyword>if</span> (item.<span class=hljs-property>text</span>) {
                                 <span class=hljs-keyword>const</span> textNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(item.<span class=hljs-property>text</span>);
                                 li.<span class="hljs-title function_">appendChild</span>(textNode);
                             } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (item.<span class=hljs-property>url</span>) {
                                 <span class=hljs-keyword>const</span> img = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"img"</span>);
                                 img.<span class=hljs-property>src</span> = item.<span class=hljs-property>url</span>;
                                 img.<span class=hljs-property>alt</span> = <span class=hljs-string>"Copied image"</span>;
                                 li.<span class="hljs-title function_">appendChild</span>(img);
                             }
                             <span class=hljs-keyword>const</span> timestampSpan = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                                 <span class=hljs-string>"span"</span>,
                                 <span class=hljs-string>""</span>,
                                 <span class=hljs-keyword>new</span> <span class="hljs-title class_">Date</span>(item.<span class=hljs-property>timestamp</span>).<span class="hljs-title function_">toLocaleString</span>(),
                                 [<span class=hljs-string>"timestamp"</span>]
                             );
                             li.<span class="hljs-title function_">appendChild</span>(timestampSpan);

                             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(li, <span class=hljs-string>"click"</span>, <span class=hljs-keyword>async</span> () =&gt; {
                                 <span class=hljs-keyword>if</span> (li.<span class=hljs-property>classList</span>.<span class="hljs-title function_">contains</span>(<span class=hljs-string>"editing"</span>)) {
                                     <span class=hljs-keyword>return</span>;
                                 }

                                 <span class=hljs-keyword>try</span> {
                                     <span class=hljs-keyword>if</span> (item.<span class=hljs-property>type</span> === <span class=hljs-string>"text"</span>) {
                                         <span class=hljs-keyword>if</span> (navigator.<span class=hljs-property>clipboard</span>?.<span class=hljs-property>writeText</span>) {
                                             <span class=hljs-keyword>await</span> navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">writeText</span>(item.<span class=hljs-property>text</span>);
                                         } <span class=hljs-keyword>else</span> {
                                             <span class=hljs-keyword>await</span> <span class="hljs-title class_">ClipboardFallback</span>.<span class="hljs-title function_">fallbackCopyText</span>(item.<span class=hljs-property>text</span>);
                                         }
                                     } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (item.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span> &amp;&amp; item.<span class=hljs-property>data</span>) {
                                         <span class=hljs-keyword>const</span> blob = <span class="hljs-title class_">DataConversion</span>.<span class="hljs-title function_">base64ToBlob</span>(
                                             item.<span class=hljs-property>data</span>,
                                             item.<span class=hljs-property>mimeType</span>
                                         );
                                         <span class=hljs-keyword>const</span> clipboardItem = <span class=hljs-keyword>new</span> <span class="hljs-title class_">ClipboardItem</span>({
                                             [item.<span class=hljs-property>mimeType</span>]: blob,
                                         });
                                         <span class=hljs-keyword>await</span> navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">write</span>([clipboardItem]);
                                     }
                                     li.<span class=hljs-property>style</span>.<span class=hljs-property>background</span> = <span class=hljs-string>"#4CAF50"</span>;
                                     <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> (li.<span class=hljs-property>style</span>.<span class=hljs-property>background</span> = <span class=hljs-string>""</span>), <span class=hljs-number>500</span>);
                                     <span class=hljs-keyword>const</span> existingIndex = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">findIndex</span>(
                                         <span class=hljs-function>(<span class=hljs-params>i</span>) =&gt;</span>
                                         (i.<span class=hljs-property>text</span> &amp;&amp; i.<span class=hljs-property>text</span> === item.<span class=hljs-property>text</span>) ||
                                         (i.<span class=hljs-property>hash</span> &amp;&amp; i.<span class=hljs-property>hash</span> === item.<span class=hljs-property>hash</span>)
                                     );
                                     <span class=hljs-keyword>if</span> (existingIndex !== -<span class=hljs-number>1</span>) {
                                         <span class=hljs-keyword>const</span> [foundItem] = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">splice</span>(
                                             existingIndex,
                                             <span class=hljs-number>1</span>
                                         );
                                         foundItem.<span class=hljs-property>timestamp</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
                                         <span class=hljs-keyword>if</span> (!foundItem.<span class=hljs-property>pinned</span>) {
                                             <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">unshift</span>(foundItem);
                                         } <span class=hljs-keyword>else</span> {
                                             <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">splice</span>(<span class=hljs-number>0</span>, <span class=hljs-number>0</span>, foundItem);
                                         }
                                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveClipboardHistory</span>();
                                     }
                                     sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">remove</span>(<span class=hljs-string>"active"</span>);
                                 } <span class=hljs-keyword>catch</span> (e) {
                                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">logError</span>(<span class=hljs-string>"Error copying to clipboard"</span>, e);
                                     li.<span class=hljs-property>style</span>.<span class=hljs-property>background</span> = <span class=hljs-string>"#f44336"</span>;
                                     <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> (li.<span class=hljs-property>style</span>.<span class=hljs-property>background</span> = <span class=hljs-string>""</span>), <span class=hljs-number>500</span>);
                                 }
                             });
                             ul.<span class="hljs-title function_">appendChild</span>(li);
                         });
                         fragment.<span class="hljs-title function_">appendChild</span>(ul);
                     }
                     contentEl.<span class=hljs-property>innerHTML</span> = <span class=hljs-string>""</span>;
                     contentEl.<span class="hljs-title function_">appendChild</span>(fragment);
                 } <span class=hljs-keyword>catch</span> (e) {
                     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error rendering history:"</span>, e);
                     contentEl.<span class=hljs-property>innerHTML</span> = <span class=hljs-string>`&lt;div class="error"&gt;<span class=hljs-subst>${I18n.getTranslation(
            <span class=hljs-string>"historyLoadError"</span>
          )}</span>&lt;/div&gt;`</span>;
                 }
             }, <span class=hljs-number>50</span>);
         },

         <span class="hljs-title function_">clearUnpinnedHistory</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-title function_">confirm</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"clearHistoryConfirm"</span>))) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>
                     .<span class="hljs-title function_">filter</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> !item.<span class=hljs-property>pinned</span> &amp;&amp; item.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span>)
                     .<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> {
                         <span class=hljs-keyword>if</span> (item.<span class=hljs-property>url</span>) <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(item.<span class=hljs-property>url</span>);
                     });
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">filter</span>(
                     <span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> item.<span class=hljs-property>pinned</span>
                 );
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveClipboardHistory</span>();
             }
         },

         <span class="hljs-title function_">clearPinnedItems</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-title function_">confirm</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"clearPinnedConfirm"</span>))) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>
                     .<span class="hljs-title function_">filter</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> item.<span class=hljs-property>pinned</span> &amp;&amp; item.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span>)
                     .<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> {
                         <span class=hljs-keyword>if</span> (item.<span class=hljs-property>url</span>) <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(item.<span class=hljs-property>url</span>);
                     });
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">filter</span>(
                     <span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> !item.<span class=hljs-property>pinned</span>
                 );
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveClipboardHistory</span>();
             }
         },

         <span class="hljs-title function_">clearAllHistory</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-title function_">confirm</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"clearAllConfirm"</span>))) {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupResources</span>();
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span> = [];
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveClipboardHistory</span>();
             }
         },

         <span class="hljs-title function_">exportHistory</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> dataStr = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span>);
                 <span class=hljs-keyword>const</span> blob = <span class=hljs-keyword>new</span> <span class="hljs-title class_">Blob</span>([dataStr], {
                     <span class=hljs-attr>type</span>: <span class=hljs-string>"application/json"</span>
                 });
                 <span class=hljs-keyword>const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
                 <span class=hljs-keyword>const</span> link = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                     <span class=hljs-string>"a"</span>,
                     <span class=hljs-string>""</span>,
                     I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"exportHistory"</span>)
                 );
                 link.<span class=hljs-property>href</span> = url;
                 link.<span class=hljs-property>download</span> = <span class=hljs-string>"clipboard_history.json"</span>;
                 link.<span class="hljs-title function_">click</span>();
                 <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(url), <span class=hljs-number>100</span>);
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">logError</span>(<span class=hljs-string>"Error exporting history"</span>, e);
             }
         },

         <span class="hljs-title function_">importHistory</span>(<span class=hljs-params>event</span>) {
             <span class=hljs-keyword>const</span> file = event.<span class=hljs-property>target</span>.<span class=hljs-property>files</span>[<span class=hljs-number>0</span>];
             <span class=hljs-keyword>if</span> (!file) <span class=hljs-keyword>return</span>;
             <span class=hljs-keyword>const</span> reader = <span class=hljs-keyword>new</span> <span class="hljs-title class_">FileReader</span>();
             reader.<span class=hljs-property>onload</span> = <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                 <span class=hljs-keyword>try</span> {
                     <span class=hljs-keyword>const</span> importedHistory = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(e.<span class=hljs-property>target</span>.<span class=hljs-property>result</span>);
                     <span class=hljs-keyword>if</span> (!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(importedHistory)) {
                         <span class=hljs-keyword>throw</span> <span class=hljs-keyword>new</span> <span class="hljs-title class_">Error</span>(<span class=hljs-string>"Invalid history format"</span>);
                     }
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupResources</span>();
                     <span class=hljs-keyword>const</span> newHistory = importedHistory
                         .<span class="hljs-title function_">slice</span>(<span class=hljs-number>0</span>, <span class="hljs-title class_">Constants</span>.<span class=hljs-property>Limits</span>.<span class=hljs-property>MAX_HISTORY_ITEMS</span>)
                         .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> {
                             <span class=hljs-keyword>if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateHistoryItem</span>(item)) {
                                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class=hljs-string>"Invalid history item in import:"</span>, item);
                                 <span class=hljs-keyword>return</span> <span class=hljs-literal>null</span>;
                             }
                             <span class=hljs-keyword>const</span> newItem = {
                                 ...item
                             };
                             <span class=hljs-keyword>if</span> (newItem.<span class=hljs-property>type</span> === <span class=hljs-string>"image"</span> &amp;&amp; newItem.<span class=hljs-property>data</span>) {
                                 <span class=hljs-keyword>try</span> {
                                     <span class=hljs-keyword>const</span> blob = <span class="hljs-title class_">DataConversion</span>.<span class="hljs-title function_">base64ToBlob</span>(
                                         newItem.<span class=hljs-property>data</span>,
                                         newItem.<span class=hljs-property>mimeType</span>
                                     );
                                     <span class=hljs-keyword>if</span> (!blob) <span class=hljs-keyword>return</span> <span class=hljs-literal>null</span>;
                                     newItem.<span class=hljs-property>url</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
                                 } <span class=hljs-keyword>catch</span> (e) {
                                     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error creating blob for imported image:"</span>, e);
                                     <span class=hljs-keyword>return</span> <span class=hljs-literal>null</span>;
                                 }
                             }
                             <span class=hljs-keyword>return</span> newItem;
                         })
                         .<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>clipboardHistory</span> = newHistory;
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveClipboardHistory</span>();
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">showToast</span>(<span class=hljs-string>"History imported successfully!"</span>);
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">showToast</span>(I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"imageImportWarning"</span>));
                 } <span class=hljs-keyword>catch</span> (err) {
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">logError</span>(<span class=hljs-string>"Failed to import history"</span>, err);
                 }
             };
             reader.<span class=hljs-property>onerror</span> = <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                 <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">logError</span>(<span class=hljs-string>"Error reading import file"</span>, e);
             };
             reader.<span class="hljs-title function_">readAsText</span>(file);
         },
     };

     <span class=hljs-comment>// ==================== LÓGICA PRINCIPAL ====================</span>
     <span class=hljs-keyword>const</span> <span class="hljs-title class_">ClipboardWidget</span> = {
         <span class=hljs-keyword>async</span> <span class="hljs-title function_">onReadClipboardClick</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>if</span> (navigator.<span class=hljs-property>clipboard</span>?.<span class=hljs-property>read</span>) {
                     <span class=hljs-keyword>const</span> items = <span class=hljs-keyword>await</span> navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">read</span>();
                     <span class=hljs-keyword>for</span> (<span class=hljs-keyword>const</span> item <span class=hljs-keyword>of</span> items) {
                         <span class=hljs-keyword>if</span> (item.<span class=hljs-property>types</span>.<span class="hljs-title function_">includes</span>(<span class=hljs-string>"image/png"</span>)) {
                             <span class=hljs-keyword>const</span> blob = <span class=hljs-keyword>await</span> item.<span class="hljs-title function_">getType</span>(<span class=hljs-string>"image/png"</span>);
                             <span class=hljs-keyword>const</span> hash = <span class=hljs-keyword>await</span> <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">calculateBlobHash</span>(blob);
                             <span class=hljs-keyword>if</span> (!hash) <span class=hljs-keyword>continue</span>;
                             <span class=hljs-keyword>const</span> data = <span class=hljs-keyword>await</span> <span class="hljs-title class_">DataConversion</span>.<span class="hljs-title function_">blobToBase64</span>(blob);
                             <span class=hljs-keyword>const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
                             <span class=hljs-keyword>await</span> <span class="hljs-title class_">HistoryManager</span>.<span class="hljs-title function_">addClipboardItem</span>({
                                 <span class=hljs-attr>type</span>: <span class=hljs-string>"image"</span>,
                                 data,
                                 <span class=hljs-attr>mimeType</span>: <span class=hljs-string>"image/png"</span>,
                                 url,
                                 hash,
                                 <span class=hljs-attr>timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
                             });
                         } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (item.<span class=hljs-property>types</span>.<span class="hljs-title function_">includes</span>(<span class=hljs-string>"text/plain"</span>)) {
                             <span class=hljs-keyword>const</span> text = <span class=hljs-keyword>await</span> (<span class=hljs-keyword>await</span> item.<span class="hljs-title function_">getType</span>(<span class=hljs-string>"text/plain"</span>)).<span class="hljs-title function_">text</span>();
                             <span class=hljs-keyword>if</span> (text)
                                 <span class=hljs-keyword>await</span> <span class="hljs-title class_">HistoryManager</span>.<span class="hljs-title function_">addClipboardItem</span>({
                                     <span class=hljs-attr>type</span>: <span class=hljs-string>"text"</span>,
                                     text
                                 });
                         }
                     }
                 } <span class=hljs-keyword>else</span> {
                     <span class=hljs-keyword>const</span> text = <span class=hljs-keyword>await</span> <span class="hljs-title class_">ClipboardFallback</span>.<span class="hljs-title function_">fallbackReadText</span>();
                     <span class="hljs-title class_">HistoryManager</span>.<span class=hljs-property>usingFallback</span> = <span class=hljs-literal>true</span>;
                     <span class="hljs-title class_">StatusManager</span>.<span class="hljs-title function_">updateStatus</span>(<span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>FALLBACK</span>);
                     <span class=hljs-keyword>if</span> (text)
                         <span class=hljs-keyword>await</span> <span class="hljs-title class_">HistoryManager</span>.<span class="hljs-title function_">addClipboardItem</span>({
                             <span class=hljs-attr>type</span>: <span class=hljs-string>"text"</span>,
                             text
                         });
                 }
                 <span class="hljs-title class_">HistoryManager</span>.<span class="hljs-title function_">renderClipboardHistory</span>();
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class="hljs-title class_">StatusManager</span>.<span class="hljs-title function_">handleClipboardReadError</span>(e);
             }
         },

         <span class=hljs-comment>// ==================== INICIALIZAÇÃO DO WIDGET ====================</span>
         <span class="hljs-title function_">createWidgetElements</span>(<span class=hljs-params></span>) {
             hamburgerBtnEl = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                 <span class=hljs-string>"button"</span>,
                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>HAMBURGER_BUTTON</span>,
                 <span class=hljs-string>"☰"</span>
             );
             sidePanelEl = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"div"</span>, <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>WIDGET</span>);
             controlsEl = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"div"</span>, <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>CONTROLS</span>);
             contentEl = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"div"</span>, <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>CONTENT</span>);
             contentEl.<span class="hljs-title function_">setAttribute</span>(<span class=hljs-string>"aria-live"</span>, <span class=hljs-string>"polite"</span>);
             readBtnEl = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                 <span class=hljs-string>"button"</span>,
                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>READ_BUTTON</span>,
                 I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"readClipboard"</span>)
             );
             minimizeBtnEl = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"button"</span>, <span class=hljs-string>""</span>, <span class=hljs-string>"↕"</span>);
             closeBtnEl = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"button"</span>, <span class=hljs-string>""</span>, <span class=hljs-string>"🗙"</span>);
             <span class=hljs-keyword>const</span> clearAllBtn = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                 <span class=hljs-string>"button"</span>,
                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>CLEAR_ALL_BUTTON</span>,
                 <span class=hljs-string>"🗑 All"</span>
             );
             <span class=hljs-keyword>const</span> clearHistBtn = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                 <span class=hljs-string>"button"</span>,
                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>CLEAR_HIST_BUTTON</span>,
                 <span class=hljs-string>"🗑 Hist"</span>
             );
             <span class=hljs-keyword>const</span> clearPinBtn = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                 <span class=hljs-string>"button"</span>,
                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>CLEAR_PIN_BUTTON</span>,
                 <span class=hljs-string>"🗑 Pin"</span>
             );
             <span class=hljs-keyword>const</span> searchBar = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                 <span class=hljs-string>"input"</span>,
                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>SEARCH_BAR</span>,
                 <span class=hljs-string>""</span>,
                 [<span class=hljs-string>"search-bar"</span>]
             );
             searchBar.<span class=hljs-property>placeholder</span> = I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"searchPlaceholder"</span>);
             searchBar.<span class=hljs-property>type</span> = <span class=hljs-string>"text"</span>;
             <span class=hljs-keyword>const</span> exportBtn = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                 <span class=hljs-string>"button"</span>,
                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>EXPORT_BUTTON</span>,
                 I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"exportHistory"</span>)
             );
             <span class=hljs-keyword>const</span> importBtn = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(
                 <span class=hljs-string>"button"</span>,
                 <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>IMPORT_BUTTON</span>,
                 I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"importHistory"</span>)
             );
             <span class=hljs-keyword>const</span> importInput = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"input"</span>, <span class=hljs-string>""</span>, <span class=hljs-string>""</span>, []);
             importInput.<span class=hljs-property>type</span> = <span class=hljs-string>"file"</span>;
             importInput.<span class=hljs-property>accept</span> = <span class=hljs-string>".json"</span>;
             importInput.<span class=hljs-property>style</span>.<span class=hljs-property>display</span> = <span class=hljs-string>"none"</span>;

             <span class=hljs-comment>// Criar elemento de título com indicador de estado</span>
             <span class=hljs-keyword>const</span> titleContainer = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"div"</span>, <span class=hljs-string>""</span>, <span class=hljs-string>""</span>, [<span class=hljs-string>"widget-title-container"</span>]);
             <span class=hljs-keyword>const</span> statusIndicator = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"span"</span>, <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>STATUS_INDICATOR</span>, <span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>UNKNOWN</span>, [<span class=hljs-string>"status-indicator"</span>]);
             <span class=hljs-keyword>const</span> titleText = <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"span"</span>, <span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>WIDGET_TITLE</span>, I18n.<span class="hljs-title function_">getTranslation</span>(<span class=hljs-string>"widgetTitle"</span>), [<span class=hljs-string>"widget-title"</span>]);

             titleContainer.<span class="hljs-title function_">append</span>(statusIndicator, titleText);

             controlsEl.<span class="hljs-title function_">append</span>(
                 clearAllBtn,
                 clearHistBtn,
                 clearPinBtn,
                 exportBtn,
                 importBtn,
                 minimizeBtnEl,
                 closeBtnEl
             );

             <span class=hljs-comment>// Inserir o título antes dos controles</span>
             sidePanelEl.<span class="hljs-title function_">append</span>(titleContainer, controlsEl, readBtnEl, searchBar, contentEl);
             <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">append</span>(hamburgerBtnEl, sidePanelEl, importInput);
         },

         <span class="hljs-title function_">setupWidgetPositionAndState</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> savedMinimized =
                 <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>MINIMIZED</span>) === <span class=hljs-string>"true"</span>;
             <span class=hljs-keyword>if</span> (savedMinimized) sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"minimized"</span>);
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyTheme</span>();
             sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"active"</span>);
         },

         <span class="hljs-title function_">applyTheme</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> prefersDark = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">matchMedia</span>(
                 <span class=hljs-string>"(prefers-color-scheme: dark)"</span>
             ).<span class=hljs-property>matches</span>;
             sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">toggle</span>(<span class=hljs-string>"dark-theme"</span>, prefersDark);
         },

         <span class="hljs-title function_">setupEventListeners</span>(<span class=hljs-params></span>) {
             <span class=hljs-comment>// Add event listener for clipboard copy action</span>
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"copy"</span>, <span class=hljs-function>() =&gt;</span> {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onReadClipboardClick</span>();
             });

             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(hamburgerBtnEl, <span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span> {
                 <span class=hljs-keyword>const</span> isActive = sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">toggle</span>(<span class=hljs-string>"active"</span>);
                 <span class=hljs-keyword>if</span> (isActive) {
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onReadClipboardClick</span>();
                 }
             });
             <span class=hljs-keyword>let</span> touchStartX = <span class=hljs-number>0</span>;
             sidePanelEl.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"touchstart"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                 touchStartX = e.<span class=hljs-property>touches</span>[<span class=hljs-number>0</span>].<span class=hljs-property>clientX</span>;
             });
             sidePanelEl.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"touchend"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                 <span class=hljs-keyword>const</span> touchEndX = e.<span class=hljs-property>changedTouches</span>[<span class=hljs-number>0</span>].<span class=hljs-property>clientX</span>;
                 <span class=hljs-keyword>if</span> (touchStartX - touchEndX &gt; <span class=hljs-number>50</span>) {
                     sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">remove</span>(<span class=hljs-string>"active"</span>);
                 } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (touchEndX - touchStartX &gt; <span class=hljs-number>50</span>) {
                     sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"active"</span>);
                 }
             });
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(minimizeBtnEl, <span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span> {
                 sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">toggle</span>(<span class=hljs-string>"minimized"</span>);
                 <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(
                     <span class="hljs-title class_">Constants</span>.<span class=hljs-property>StorageKeys</span>.<span class=hljs-property>MINIMIZED</span>,
                     sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">contains</span>(<span class=hljs-string>"minimized"</span>)
                 );
             });
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(closeBtnEl, <span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span> {
                 <span class="hljs-title class_">HistoryManager</span>.<span class="hljs-title function_">cleanupResources</span>();
                 sidePanelEl.<span class="hljs-title function_">remove</span>();
                 hamburgerBtnEl.<span class="hljs-title function_">remove</span>();
                 <span class=hljs-keyword>delete</span> <span class="hljs-variable language_">window</span>.<span class=hljs-property>clipboardWidget</span>;
             });
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(
                 readBtnEl,
                 <span class=hljs-string>"click"</span>,
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>onReadClipboardClick</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
             );
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>CLEAR_ALL_BUTTON</span>),
                 <span class=hljs-string>"click"</span>,
                 <span class="hljs-title class_">HistoryManager</span>.<span class=hljs-property>clearAllHistory</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-title class_">HistoryManager</span>)
             );
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>CLEAR_HIST_BUTTON</span>),
                 <span class=hljs-string>"click"</span>,
                 <span class="hljs-title class_">HistoryManager</span>.<span class=hljs-property>clearUnpinnedHistory</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-title class_">HistoryManager</span>)
             );
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>CLEAR_PIN_BUTTON</span>),
                 <span class=hljs-string>"click"</span>,
                 <span class="hljs-title class_">HistoryManager</span>.<span class=hljs-property>clearPinnedItems</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-title class_">HistoryManager</span>)
             );
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>SEARCH_BAR</span>),
                 <span class=hljs-string>"input"</span>,
                 <span class=hljs-function>() =&gt;</span> {
                     <span class=hljs-keyword>const</span> query = <span class="hljs-variable language_">document</span>
                         .<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>SEARCH_BAR</span>)
                         .<span class=hljs-property>value</span>.<span class="hljs-title function_">toLowerCase</span>();
                     <span class=hljs-keyword>const</span> filtered = <span class="hljs-title class_">HistoryManager</span>.<span class=hljs-property>clipboardHistory</span>.<span class="hljs-title function_">filter</span>(
                         <span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> item.<span class=hljs-property>text</span> &amp;&amp; item.<span class=hljs-property>text</span>.<span class="hljs-title function_">toLowerCase</span>().<span class="hljs-title function_">includes</span>(query)
                     );
                     <span class="hljs-title class_">HistoryManager</span>.<span class="hljs-title function_">renderClipboardHistory</span>(filtered);
                 }
             );
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>EXPORT_BUTTON</span>),
                 <span class=hljs-string>"click"</span>,
                 <span class="hljs-title class_">HistoryManager</span>.<span class=hljs-property>exportHistory</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-title class_">HistoryManager</span>)
             );
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-title class_">Constants</span>.<span class=hljs-property>IDs</span>.<span class=hljs-property>IMPORT_BUTTON</span>),
                 <span class=hljs-string>"click"</span>,
                 <span class=hljs-function>() =&gt;</span> {
                     <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>`input[type="file"]`</span>).<span class="hljs-title function_">click</span>();
                 }
             );
             <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">addDisposableEventListener</span>(
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>`input[type="file"]`</span>),
                 <span class=hljs-string>"change"</span>,
                 <span class="hljs-title class_">HistoryManager</span>.<span class=hljs-property>importHistory</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-title class_">HistoryManager</span>)
             );
             <span class="hljs-variable language_">window</span>
                 .<span class="hljs-title function_">matchMedia</span>(<span class=hljs-string>"(prefers-color-scheme: dark)"</span>)
                 .<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"change"</span>, <span class="hljs-variable language_">this</span>.<span class=hljs-property>applyTheme</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
         },

         <span class="hljs-title function_">toggle</span>(<span class=hljs-params></span>) {
             sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">toggle</span>(<span class=hljs-string>"active"</span>);
             <span class=hljs-keyword>if</span> (sidePanelEl.<span class=hljs-property>classList</span>.<span class="hljs-title function_">contains</span>(<span class=hljs-string>"active"</span>)) {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onReadClipboardClick</span>();
             }
         },

         <span class=hljs-keyword>async</span> <span class="hljs-title function_">init</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>trustedTypes</span> &amp;&amp; <span class="hljs-variable language_">window</span>.<span class=hljs-property>trustedTypes</span>.<span class=hljs-property>createPolicy</span>) {
                 <span class=hljs-keyword>try</span> {
                     trustedTypes.<span class="hljs-title function_">createPolicy</span>(<span class=hljs-string>"clipboardWidgetDefault"</span>, {
                         <span class=hljs-attr>createHTML</span>: <span class=hljs-function>(<span class=hljs-params>string</span>) =&gt;</span> string,
                         <span class=hljs-attr>createScriptURL</span>: <span class=hljs-function>(<span class=hljs-params>string</span>) =&gt;</span> string,
                     });
                 } <span class=hljs-keyword>catch</span> (e) {
                     <span class="hljs-title class_">Utils</span>.<span class="hljs-title function_">logError</span>(<span class=hljs-string>"Could not create default TrustedTypes policy"</span>, e);
                 }
             }
             <span class="hljs-title class_">Styles</span>.<span class="hljs-title function_">inject</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createWidgetElements</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupWidgetPositionAndState</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEventListeners</span>();
             <span class="hljs-title class_">HistoryManager</span>.<span class="hljs-title function_">loadClipboardHistory</span>();
             <span class="hljs-title class_">HistoryManager</span>.<span class="hljs-title function_">renderClipboardHistory</span>();
             <span class="hljs-title class_">ClipboardFallback</span>.<span class="hljs-title function_">createFallbackTextarea</span>();

             <span class=hljs-comment>// Definir estado inicial</span>
             <span class=hljs-keyword>const</span> initialState = <span class="hljs-title class_">ClipboardStates</span>.<span class="hljs-title function_">getCurrentState</span>();
             <span class="hljs-title class_">StatusManager</span>.<span class="hljs-title function_">updateStatus</span>(initialState);

             <span class="hljs-variable language_">window</span>.<span class=hljs-property>clipboardWidget</span> = {
                 <span class=hljs-attr>element</span>: hamburgerBtnEl,
                 <span class=hljs-attr>toggle</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>toggle</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
             };

             <span class=hljs-keyword>const</span> hasAnyClipboardAccess =
                 navigator.<span class=hljs-property>clipboard</span>?.<span class=hljs-property>read</span> || <span class="hljs-variable language_">document</span>.<span class=hljs-property>execCommand</span>;
             <span class=hljs-keyword>if</span> (!hasAnyClipboardAccess) {
                 contentEl.<span class=hljs-property>textContent</span> =
                     <span class=hljs-string>"Your browser does not support clipboard access."</span>;
                 readBtnEl.<span class=hljs-property>disabled</span> = <span class=hljs-literal>true</span>;
                 <span class="hljs-title class_">StatusManager</span>.<span class="hljs-title function_">updateStatus</span>(<span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>DISABLED</span>);
                 <span class=hljs-keyword>return</span>;
             }
             <span class=hljs-keyword>if</span> (!navigator.<span class=hljs-property>clipboard</span>?.<span class=hljs-property>read</span>) {
                 <span class="hljs-title class_">HistoryManager</span>.<span class=hljs-property>usingFallback</span> = <span class=hljs-literal>true</span>;
                 <span class="hljs-title class_">StatusManager</span>.<span class="hljs-title function_">updateStatus</span>(<span class="hljs-title class_">ClipboardStates</span>.<span class=hljs-property>FALLBACK</span>);
                 contentEl.<span class=hljs-property>textContent</span> =
                     <span class=hljs-string>"Using an alternative method. Click items to copy, but automatic reading is limited."</span>;
             }
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onReadClipboardClick</span>();
         },
     };

     <span class=hljs-comment>// Inicializa o widget</span>
     <span class="hljs-title class_">ClipboardWidget</span>.<span class="hljs-title function_">init</span>();
 })();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/highlight%20text/index.js title="Highlight Text" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Highlight Text</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Highlight Text</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/highlight%20text/index.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Highlights the selected texts on the page by wrapping them in &lt;mark&gt; tags.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/highlight%20text/index.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/highlight text/index.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary>Show Media</summary></details> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Highlight Text</span>
<span class=hljs-comment>// @description Highlights the selected texts on the page by wrapping them in &lt;mark&gt; tags.</span>
<span class=hljs-comment>// @image https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/bookmarklets/highlight%20text/1.png</span>
<span class=hljs-comment>// @image https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/bookmarklets/highlight%20text/2.png</span>
<span class=hljs-comment>// @image https://raw.githubusercontent.com/madacol/web-automation/refs/heads/master/bookmarklets/highlight%20text/3.png</span>

<span class=hljs-attr>javascript</span>: (<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>let</span> selection = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>();
    <span class=hljs-keyword>if</span> (selection?.<span class="hljs-title function_">toString</span>() === <span class=hljs-string>""</span>) {
        <span class=hljs-keyword>return</span> <span class="hljs-title function_">alert</span>(<span class=hljs-string>'Please select some text on the page.'</span>);
    }
    <span class=hljs-keyword>for</span> (<span class=hljs-keyword>let</span> j = <span class=hljs-number>0</span>; j &lt; selection.<span class=hljs-property>rangeCount</span>; j++) {
        <span class=hljs-keyword>const</span> range = selection.<span class="hljs-title function_">getRangeAt</span>(j);

        <span class=hljs-comment>/* Split the range for each text node within the selection */</span>
        <span class=hljs-keyword>let</span> selectedRanges = <span class="hljs-title function_">splitRangeForEachNode</span>(range);
        <span class=hljs-keyword>for</span> (<span class=hljs-keyword>let</span> i = <span class=hljs-number>0</span>; i &lt; selectedRanges.<span class=hljs-property>length</span>; i++) {
            <span class=hljs-keyword>let</span> nodeRange = selectedRanges[i];

            <span class=hljs-keyword>let</span> selectedText = nodeRange.<span class="hljs-title function_">toString</span>();

            <span class=hljs-keyword>if</span> (selectedText.<span class="hljs-title function_">trim</span>() === <span class=hljs-string>''</span>) {
                <span class=hljs-keyword>continue</span>;
            }

            <span class=hljs-keyword>let</span> textNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(selectedText);
            <span class=hljs-keyword>let</span> highlightedNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'mark'</span>);
            highlightedNode.<span class="hljs-title function_">appendChild</span>(textNode);

            nodeRange.<span class="hljs-title function_">deleteContents</span>();
            nodeRange.<span class="hljs-title function_">insertNode</span>(highlightedNode);
        }
    }

    selection.<span class="hljs-title function_">empty</span>();

    <span class=hljs-comment>/**
     * Helper function to retrieve a range for each text node within a range
     * <span class=hljs-doctag>@param</span> {<span class=hljs-type>Range</span>} <span class=hljs-variable>range</span>
     * <span class=hljs-doctag>@returns</span> {<span class=hljs-type>Range[]</span>}
     */</span>
    <span class=hljs-keyword>function</span> <span class="hljs-title function_">splitRangeForEachNode</span>(<span class=hljs-params>range</span>) {
        <span class=hljs-keyword>let</span> startNode = range.<span class=hljs-property>startContainer</span>;
        <span class=hljs-keyword>let</span> endNode = range.<span class=hljs-property>endContainer</span>;

        <span class=hljs-comment>/* Special case for a range that spans a single node */</span>
        <span class=hljs-keyword>if</span> (startNode === endNode) {
            <span class=hljs-keyword>return</span> [range];
        }

        <span class=hljs-comment>/* Iterate through the ancestor nodes until a common parent is found */</span>
        <span class=hljs-keyword>let</span> commonAncestor = range.<span class=hljs-property>commonAncestorContainer</span>;
        <span class=hljs-keyword>let</span> selectedRanges = [];
        <span class=hljs-keyword>let</span> walker = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTreeWalker</span>(commonAncestor, <span class="hljs-title class_">NodeFilter</span>.<span class=hljs-property>SHOW_TEXT</span>);

        <span class=hljs-keyword>let</span> currentNode = walker.<span class=hljs-property>currentNode</span>;
        <span class=hljs-keyword>while</span> (currentNode) {
            <span class=hljs-keyword>if</span> (range.<span class="hljs-title function_">intersectsNode</span>(currentNode)) {
                <span class=hljs-keyword>let</span> nodeRange = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createRange</span>();

                <span class=hljs-comment>/* If this is the start node, set the start of the range to the original start */</span>
                <span class=hljs-keyword>if</span> (currentNode === startNode) {
                    nodeRange.<span class="hljs-title function_">setStart</span>(startNode, range.<span class=hljs-property>startOffset</span>);
                } <span class=hljs-keyword>else</span> {
                    nodeRange.<span class="hljs-title function_">setStart</span>(currentNode, <span class=hljs-number>0</span>);
                }

                <span class=hljs-comment>/* If this is the end node, set the end of the range to the original end */</span>
                <span class=hljs-keyword>if</span> (currentNode === endNode) {
                    nodeRange.<span class="hljs-title function_">setEnd</span>(endNode, range.<span class=hljs-property>endOffset</span>);
                } <span class=hljs-keyword>else</span> {
                    nodeRange.<span class="hljs-title function_">setEnd</span>(currentNode, currentNode.<span class=hljs-property>length</span>);
                }

                selectedRanges.<span class="hljs-title function_">push</span>(nodeRange);
            }
            currentNode = walker.<span class="hljs-title function_">nextNode</span>();
        }

        <span class=hljs-keyword>return</span> selectedRanges;
    }
})();


<span class=hljs-comment>/**
 * TODO
 * 
 * apply new highlighting APIs https://developer.mozilla.org/en-US/docs/Web/API/CSS_Custom_Highlight_API
 * 
 *  // css
    ::highlight(my-custom-highlight) {
        background-color: blue;
    }

    // js
    const parentNode = document.getElementById("foo");
    const range1 = new Range();
    range1.setStart(parentNode, 10);
    range1.setEnd(parentNode, 20);
    const highlight = new Highlight(range1);
    CSS.highlights.set("my-custom-highlight", highlight);
 */</span></code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Underline%20Text%20Using%20Unicode.js title="Underline Text Using Unicode" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Underline Text Using Unicode</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Underline Text Using Unicode</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Underline%20Text%20Using%20Unicode.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Underlines selected texts in inputs and textareas. Each character in the selection is combined with the Unicode character U+0332 (COMBINING LOW LINE) to simulate underlining.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Underline%20Text%20Using%20Unicode.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Underline Text Using Unicode.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Underline Text Using Unicode</span>
<span class=hljs-comment>// @description Underlines selected texts in inputs and textareas. Each character in the selection is combined with the Unicode character U+0332 (COMBINING LOW LINE) to simulate underlining.</span>

(<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-comment>/** <span class=hljs-doctag>@type</span> {<span class=hljs-type>HTMLInputElement | HTMLTextAreaElement</span>} */</span>
    <span class=hljs-keyword>const</span> input = <span class="hljs-variable language_">document</span>.<span class=hljs-property>activeElement</span>;

    <span class=hljs-comment>// Check if the active element is an input or textarea</span>
    <span class=hljs-keyword>if</span> (![<span class=hljs-string>'INPUT'</span>, <span class=hljs-string>'TEXTAREA'</span>].<span class="hljs-title function_">includes</span>(input.<span class=hljs-property>tagName</span>)) {
        <span class=hljs-keyword>return</span> <span class="hljs-title function_">alert</span>(<span class=hljs-string>'Please select some text in an input or textarea.'</span>);
    }

    <span class=hljs-keyword>const</span> {
        value,
        selectionStart,
        selectionEnd
    } = input;

    <span class=hljs-comment>// Extract the selected text, and replace each non-space character with itself followed by the Unicode combining low line.</span>
    <span class=hljs-keyword>const</span> selectedText = value.<span class="hljs-title function_">substring</span>(selectionStart, selectionEnd);
    <span class=hljs-keyword>const</span> newText = selectedText.<span class="hljs-title function_">replace</span>(<span class=hljs-regexp>/\S/g</span>, <span class=hljs-string>"$&amp;\u0332"</span>);

    <span class=hljs-comment>// Reconstruct the value with the underlined selection inserted back into its original position.</span>
    input.<span class=hljs-property>value</span> = value.<span class="hljs-title function_">split</span>(selectedText).<span class="hljs-title function_">join</span>(newText);

    <span class=hljs-comment>// Update the selection to highlight the newly underlined text.</span>
    input.<span class=hljs-property>selectionStart</span> = selectionStart;
    input.<span class=hljs-property>selectionEnd</span> = selectionStart + newText.<span class=hljs-property>length</span>;
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://gist.githubusercontent.com/magasine/9f98b357e8e1e2bb2f3d8db96f1c9622/raw/45bcc599dbec16270a3127280f267ca56ac01914/HighlightManager.js title=HighlightManager data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>HighlightManager</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">HighlightManager</span></div></div></a> <a href=https://gist.githubusercontent.com/magasine/9f98b357e8e1e2bb2f3d8db96f1c9622/raw/45bcc599dbec16270a3127280f267ca56ac01914/HighlightManager.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://gist.githubusercontent.com/magasine/9f98b357e8e1e2bb2f3d8db96f1c9622/raw/45bcc599dbec16270a3127280f267ca56ac01914/HighlightManager.js rel=nofollow class=svelte-7rw83y>https://gist.githubusercontent.com/magasine/9f98b357e8e1e2bb2f3d8db96f1c9622/raw/45bcc599dbec16270a3127280f267ca56ac01914/HighlightManager.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript> (<span class=hljs-function>() =&gt;</span> {
     <span class=hljs-keyword>class</span> <span class="hljs-title class_">HighlightManager</span> {
         <span class="hljs-title function_">isUIVisible</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>return</span> !!<span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>isConnected</span>;
         }

         <span class="hljs-title function_">constructor</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>highlightManagerInstance</span>) {
                 <span class="hljs-variable language_">window</span>.<span class=hljs-property>highlightManagerInstance</span>.<span class="hljs-title function_">destroy</span>();
             }
             <span class="hljs-variable language_">window</span>.<span class=hljs-property>highlightManagerInstance</span> = <span class="hljs-variable language_">this</span>;

             <span class=hljs-comment>// Permanent method binding</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleKeyDown</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleKeyDown</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleMouseUp</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleMouseUp</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleBeforeUnload</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleBeforeUnload</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>destroy</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>destroy</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleThemeChange</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleThemeChange</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>); <span class=hljs-comment>// Novo binding</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>copyHighlightText</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>copyHighlightText</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>); <span class=hljs-comment>// Novo binding para copiar texto</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>checkGlobalVisibilityState</span> =
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>checkGlobalVisibilityState</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>); <span class=hljs-comment>// NOVO BINDING</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleMergeHighlights</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleMergeHighlights</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>); <span class=hljs-comment>// NOVO BINDING para merge</span>

             <span class=hljs-comment>// Trusted Types policy creation</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createTrustedTypesPolicy</span>();

             <span class=hljs-comment>// Initialize properties</span>
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initProperties</span>();

             <span class=hljs-comment>// Initialize components</span>
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">injectGlobalHighlightStyle</span>(); <span class=hljs-comment>// Será chamado dentro de applyTheme</span>
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachPopup</span>(); <span class=hljs-comment>// Será atualizado para considerar o tema</span>
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadUISettings</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadFromStorage</span>();

             <span class=hljs-comment>// Setup observers and events</span>
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupMutationObserver</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEventListeners</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupThemeDetection</span>(); <span class=hljs-comment>// Novo: Configurar detecção de tema</span>

             <span class=hljs-comment>// Initial UI update</span>
             <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHighlightListUI</span>(), <span class=hljs-number>0</span>);
         }

         <span class="hljs-title function_">createTrustedTypesPolicy</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>return</span> <span class="hljs-variable language_">window</span>.<span class=hljs-property>trustedTypes</span>?.<span class="hljs-title function_">createPolicy</span>(<span class=hljs-string>"highlightManager"</span>, {
                 <span class=hljs-attr>createHTML</span>: <span class=hljs-function>(<span class=hljs-params>string</span>) =&gt;</span> string,
                 <span class=hljs-attr>createScript</span>: <span class=hljs-function>(<span class=hljs-params>string</span>) =&gt;</span> string,
                 <span class=hljs-attr>createScriptURL</span>: <span class=hljs-function>(<span class=hljs-params>string</span>) =&gt;</span> string,
             });
         }

         <span class="hljs-title function_">initProperties</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>popupId</span> = <span class=hljs-string>"highlight-popup"</span>;
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span> = <span class=hljs-keyword>new</span> <span class="hljs-title class_">Map</span>();
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> = <span class=hljs-literal>false</span>; <span class=hljs-comment>// Estado global para o botão "Hide/Show"</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>updatePending</span> = <span class=hljs-literal>false</span>;
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>restoreQueue</span> = <span class=hljs-keyword>new</span> <span class="hljs-title class_">Map</span>();
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> = <span class=hljs-string>"creation"</span>;
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>maxSelectionLength</span> = <span class=hljs-number>10000</span>;
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> = <span class=hljs-string>"light"</span>; <span class=hljs-comment>// Padrão: light</span>

             <span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span> = {
                 <span class=hljs-attr>confirmClear</span>: <span class=hljs-string>"Tem certeza que deseja limpar todos os destaques?\nEsta ação não pode ser desfeita."</span>,
                 <span class=hljs-attr>highlightCreated</span>: <span class=hljs-string>"Texto destacado!"</span>,
                 <span class=hljs-attr>invalidSelection</span>: <span class=hljs-string>"Seleção deve estar em texto simples."</span>,
                 <span class=hljs-attr>highlightError</span>: <span class=hljs-string>"Erro ao aplicar destaque. Tente selecionar texto contíguo."</span>,
                 <span class=hljs-attr>storageExceeded</span>: <span class=hljs-string>"Limite de armazenamento excedido. Removidos destaques antigos."</span>,
                 <span class=hljs-attr>hideHighlights</span>: <span class=hljs-string>"Hide"</span>,
                 <span class=hljs-attr>showHighlights</span>: <span class=hljs-string>"Show"</span>,
                 <span class=hljs-attr>selectionTooLong</span>: <span class=hljs-string>`Seleção muito longa (máximo <span class=hljs-subst>${<span class="hljs-variable language_">this</span>.maxSelectionLength}</span> caracteres)`</span>,
                 <span class=hljs-attr>copiedToClipboard</span>: <span class=hljs-string>"Copiado para a área de transferência!"</span>, <span class=hljs-comment>// Nova string</span>
                 <span class=hljs-attr>mergePrompt</span>: <span class=hljs-string>"Qual separador você gostaria de usar?"</span>, <span class=hljs-comment>// Nova string</span>
                 <span class=hljs-attr>defaultSeparator</span>: <span class=hljs-string>"---"</span>, <span class=hljs-comment>// Nova string</span>
                 <span class=hljs-attr>noVisibleHighlights</span>: <span class=hljs-string>"Nenhum destaque visível para mesclar."</span>, <span class=hljs-comment>// Nova string</span>
                 <span class=hljs-attr>mergeSuccess</span>: <span class=hljs-string>"Destaques mesclados e copiados!"</span>, <span class=hljs-comment>// Nova string</span>
             };

             <span class=hljs-comment>// Styles e popupHTML serão definidos e atualizados dinamicamente</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>styles</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getStyles</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span>);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>popupHTML</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPopupHTML</span>();
         }

         <span class="hljs-title function_">setupEventListeners</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"mouseup"</span>, <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleMouseUp</span>);
             <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"beforeunload"</span>, <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleBeforeUnload</span>);
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"keydown"</span>, <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleKeyDown</span>);

             <span class=hljs-comment>// SPA handling</span>
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>history</span>.<span class=hljs-property>pushState</span>) {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">patchHistoryAPI</span>();
             }
         }

         <span class="hljs-title function_">patchHistoryAPI</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> originalPushState = <span class="hljs-variable language_">window</span>.<span class=hljs-property>history</span>.<span class=hljs-property>pushState</span>;
             <span class="hljs-variable language_">window</span>.<span class=hljs-property>history</span>.<span class=hljs-property>pushState</span> = <span class=hljs-function>(<span class=hljs-params>...args</span>) =&gt;</span> {
                 originalPushState.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">window</span>.<span class=hljs-property>history</span>, args);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleBeforeUnload</span>();
             };
         }

         <span class=hljs-comment>/* ========== CORE HIGHLIGHTING FUNCTIONALITY ========== */</span>

         <span class="hljs-title function_">handleKeyDown</span>(<span class=hljs-params>e</span>) {
             <span class=hljs-comment>// Verifica se a tecla pressionada é "h" ou "H" e se há uma seleção</span>
             <span class=hljs-keyword>if</span> (
                 (e.<span class=hljs-property>key</span> === <span class=hljs-string>"h"</span> || e.<span class=hljs-property>key</span> === <span class=hljs-string>"H"</span>) &amp;&amp;
                 <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>().<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">trim</span>().<span class=hljs-property>length</span> &gt; <span class=hljs-number>0</span>
             ) {
                 e.<span class="hljs-title function_">preventDefault</span>(); <span class=hljs-comment>// Previne o comportamento padrão da tecla</span>
                 <span class=hljs-keyword>const</span> selection = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>();
                 <span class=hljs-keyword>const</span> range = selection.<span class="hljs-title function_">getRangeAt</span>(<span class=hljs-number>0</span>);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">highlightSelection</span>(range, <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateUniqueId</span>());
                 selection.<span class="hljs-title function_">removeAllRanges</span>();
             }
         }

         <span class="hljs-title function_">handleMouseUp</span>(<span class=hljs-params>e</span>) {
             <span class=hljs-keyword>if</span> (e.<span class=hljs-property>ctrlKey</span>) {
                 <span class=hljs-keyword>const</span> selection = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>();
                 <span class=hljs-keyword>if</span> (!selection.<span class=hljs-property>isCollapsed</span>) {
                     <span class=hljs-keyword>const</span> range = selection.<span class="hljs-title function_">getRangeAt</span>(<span class=hljs-number>0</span>);
                     <span class=hljs-keyword>if</span> (range.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">trim</span>().<span class=hljs-property>length</span> &gt; <span class=hljs-number>0</span>) {
                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">highlightSelection</span>(range, <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateUniqueId</span>());
                         selection.<span class="hljs-title function_">removeAllRanges</span>();
                     }
                 }
             }
         }

         <span class="hljs-title function_">handleBeforeUnload</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveUISettings</span>();
         }

         <span class="hljs-title function_">destroy</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanup</span>();
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>highlightManagerInstance</span> === <span class="hljs-variable language_">this</span>) {
                 <span class="hljs-variable language_">window</span>.<span class=hljs-property>highlightManagerInstance</span> = <span class=hljs-literal>null</span>;
             }
         }

         <span class="hljs-title function_">cleanup</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveUISettings</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeEventListeners</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">clearPendingRestorations</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">disconnectObservers</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeDOMElements</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeThemeListeners</span>(); <span class=hljs-comment>// Novo: Remover listeners de tema</span>
             <span class=hljs-comment>// Remover event listeners dos destaques existentes para evitar vazamento de memória</span>
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>".highlight"</span>).<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>el</span>) =&gt;</span> {
                 el.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                     e.<span class="hljs-title function_">stopPropagation</span>();
                     <span class=hljs-keyword>const</span> highlightId = el.<span class=hljs-property>id</span>.<span class="hljs-title function_">split</span>(<span class=hljs-string>"-"</span>)[<span class=hljs-number>0</span>]; <span class=hljs-comment>// Pega o ID original do destaque</span>
                     <span class=hljs-keyword>const</span> highlightData = <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">get</span>(highlightId);
                     <span class=hljs-keyword>if</span> (highlightData) {
                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">copyHighlightText</span>(highlightData.<span class=hljs-property>text</span>);
                     }
                 });
             });
         }

         <span class="hljs-title function_">removeEventListeners</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"mouseup"</span>, <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleMouseUp</span>);
             <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"beforeunload"</span>, <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleBeforeUnload</span>);
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"keydown"</span>, <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleKeyDown</span>);
         }

         <span class="hljs-title function_">clearPendingRestorations</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>restoreQueue</span>.<span class="hljs-title function_">forEach</span>(<span class=hljs-built_in>clearTimeout</span>);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>restoreQueue</span>.<span class="hljs-title function_">clear</span>();
         }

         <span class="hljs-title function_">disconnectObservers</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>mutationObserver</span>?.<span class="hljs-title function_">disconnect</span>();
         }

         <span class="hljs-title function_">removeDOMElements</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>position</span> = <span class=hljs-string>"fixed"</span>;
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>left</span> = <span class=hljs-string>"auto"</span>;
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>right</span> = <span class=hljs-string>"20px"</span>;
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>top</span> = <span class=hljs-string>"20px"</span>;
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class="hljs-title function_">remove</span>();
             }
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"highlight-style-injected"</span>)?.<span class="hljs-title function_">remove</span>();

             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span> = <span class=hljs-literal>null</span>;
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span> = <span class=hljs-literal>null</span>;
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>mutationObserver</span> = <span class=hljs-literal>null</span>;
         }

         <span class="hljs-title function_">generateUniqueId</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>return</span> <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>().<span class="hljs-title function_">toString</span>(<span class=hljs-number>36</span>) + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>().<span class="hljs-title function_">toString</span>(<span class=hljs-number>36</span>).<span class="hljs-title function_">substring</span>(<span class=hljs-number>2</span>);
         }

         <span class=hljs-comment>/* ========== TRUSTED HTML UTILITIES ========== */</span>
         <span class="hljs-title function_">setInnerHTMLSafely</span>(<span class=hljs-params>element, htmlString</span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span>) {
                 element.<span class=hljs-property>innerHTML</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span>.<span class="hljs-title function_">createHTML</span>(htmlString);
             } <span class=hljs-keyword>else</span> {
                 element.<span class=hljs-property>innerHTML</span> = htmlString;
             }
         }

         <span class="hljs-title function_">createElementSafely</span>(<span class=hljs-params>tagName, options = {}</span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(tagName);

                 <span class=hljs-keyword>if</span> (options.<span class=hljs-property>className</span>) {
                     element.<span class=hljs-property>className</span> =
                         <span class=hljs-keyword>typeof</span> options.<span class=hljs-property>className</span> === <span class=hljs-string>"string"</span> ?
                         options.<span class=hljs-property>className</span> :
                         options.<span class=hljs-property>className</span>.<span class="hljs-title function_">join</span>(<span class=hljs-string>" "</span>).<span class="hljs-title function_">trim</span>();
                 }

                 <span class=hljs-keyword>if</span> (options.<span class=hljs-property>id</span>) {
                     element.<span class=hljs-property>id</span> = <span class="hljs-title class_">String</span>(options.<span class=hljs-property>id</span>);
                 }

                 <span class=hljs-keyword>if</span> (options.<span class=hljs-property>textContent</span> !== <span class=hljs-literal>undefined</span>) {
                     element.<span class=hljs-property>textContent</span> = <span class="hljs-variable language_">this</span>.escapeHTML(<span class="hljs-title class_">String</span>(options.<span class=hljs-property>textContent</span>));
                 }

                 <span class=hljs-keyword>if</span> (options.<span class=hljs-property>html</span>) {
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setInnerHTMLSafely</span>(element, options.<span class=hljs-property>html</span>);
                 }

                 <span class=hljs-keyword>if</span> (options.<span class=hljs-property>style</span>) {
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyStyles</span>(element, options.<span class=hljs-property>style</span>);
                 }

                 <span class=hljs-keyword>if</span> (options.<span class=hljs-property>attributes</span>) {
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setAttributes</span>(element, options.<span class=hljs-property>attributes</span>);
                 }

                 <span class=hljs-keyword>if</span> (options.<span class=hljs-property>dataset</span>) {
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setDataset</span>(element, options.<span class=hljs-property>dataset</span>);
                 }

                 <span class=hljs-keyword>return</span> element;
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error creating element:"</span>, e);
                 <span class=hljs-keyword>return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createDocumentFragment</span>();
             }
         }

         <span class="hljs-title function_">applyStyles</span>(<span class=hljs-params>element, style</span>) {
             <span class=hljs-keyword>const</span> styleString =
                 <span class=hljs-keyword>typeof</span> style === <span class=hljs-string>"string"</span> ? style : <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">styleObjectToString</span>(style);

             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span>) {
                 element.<span class=hljs-property>style</span>.<span class=hljs-property>cssText</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span>.<span class="hljs-title function_">createHTML</span>(styleString);
             } <span class=hljs-keyword>else</span> {
                 element.<span class=hljs-property>style</span>.<span class=hljs-property>cssText</span> = styleString;
             }
         }

         <span class="hljs-title function_">setAttributes</span>(<span class=hljs-params>element, attributes</span>) {
             <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(attributes).<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>[key, value]</span>) =&gt;</span> {
                 <span class=hljs-keyword>try</span> {
                     <span class=hljs-keyword>if</span> (value !== <span class=hljs-literal>null</span> &amp;&amp; value !== <span class=hljs-literal>undefined</span>) {
                         <span class=hljs-keyword>const</span> attrValue = <span class="hljs-title class_">String</span>(value);
                         <span class=hljs-keyword>if</span> (key === <span class=hljs-string>"style"</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span>) {
                             element.<span class="hljs-title function_">setAttribute</span>(
                                 key,
                                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span>.<span class="hljs-title function_">createHTML</span>(attrValue)
                             );
                         } <span class=hljs-keyword>else</span> {
                             element.<span class="hljs-title function_">setAttribute</span>(key, attrValue);
                         }
                     }
                 } <span class=hljs-keyword>catch</span> (e) {
                     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>`Error setting attribute <span class=hljs-subst>${key}</span>:`</span>, e);
                 }
             });
         }

         <span class="hljs-title function_">setDataset</span>(<span class=hljs-params>element, dataset</span>) {
             <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(dataset).<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>[key, value]</span>) =&gt;</span> {
                 <span class=hljs-keyword>try</span> {
                     <span class=hljs-keyword>if</span> (value !== <span class=hljs-literal>null</span> &amp;&amp; value !== <span class=hljs-literal>undefined</span>) {
                         element.<span class=hljs-property>dataset</span>[key] = <span class="hljs-title class_">String</span>(value);
                     }
                 } <span class=hljs-keyword>catch</span> (e) {
                     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>`Error setting dataset <span class=hljs-subst>${key}</span>:`</span>, e);
                 }
             });
         }

         <span class="hljs-title function_">styleObjectToString</span>(<span class=hljs-params>styleObj</span>) {
             <span class=hljs-keyword>return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(styleObj)
                 .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>[key, value]</span>) =&gt;</span> <span class=hljs-string>`<span class=hljs-subst>${key}</span>:<span class=hljs-subst>${value}</span>;`</span>)
                 .<span class="hljs-title function_">join</span>(<span class=hljs-string>""</span>);
         }

         <span class="hljs-title function_">escapeHTML</span>(<span class=hljs-params>str</span>) {
             <span class=hljs-keyword>if</span> (!str) <span class=hljs-keyword>return</span> <span class=hljs-string>""</span>;
             <span class=hljs-keyword>return</span> <span class="hljs-title class_">String</span>(str).<span class="hljs-title function_">replace</span>(
                 <span class=hljs-regexp>/[&amp;&lt;&gt;'"]/g</span>,
                 <span class=hljs-function>(<span class=hljs-params>tag</span>) =&gt;</span>
                 ({
                     <span class=hljs-string>"&amp;"</span>: <span class=hljs-string>"&amp;amp;"</span>,
                     <span class=hljs-string>"&lt;"</span>: <span class=hljs-string>"&amp;lt;"</span>,
                     <span class=hljs-string>"&gt;"</span>: <span class=hljs-string>"&amp;gt;"</span>,
                     <span class=hljs-string>"'"</span>: <span class=hljs-string>"&amp;#39;"</span>,
                     <span class=hljs-string>'"'</span>: <span class=hljs-string>"&amp;quot;"</span>,
                 } [tag])
             );
         }

         <span class=hljs-comment>/* ========== HIGHLIGHT MANAGEMENT ========== */</span>
         <span class="hljs-title function_">highlightSelection</span>(<span class=hljs-params>range, id</span>) {
             <span class=hljs-keyword>const</span> selectedText = range.<span class="hljs-title function_">toString</span>();
             <span class=hljs-keyword>if</span> (selectedText.<span class=hljs-property>length</span> === <span class=hljs-number>0</span>) <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;

             <span class=hljs-keyword>if</span> (selectedText.<span class=hljs-property>length</span> &gt; <span class="hljs-variable language_">this</span>.<span class=hljs-property>maxSelectionLength</span>) {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showFeedback</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span>.<span class=hljs-property>selectionTooLong</span>, <span class=hljs-string>"error"</span>);
                 <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
             }

             <span class=hljs-keyword>const</span> highlightData = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createHighlightData</span>(range, id, selectedText);
             <span class=hljs-keyword>const</span> span = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createHighlightSpan</span>(id);

             <span class=hljs-keyword>try</span> {
                 range.<span class="hljs-title function_">surroundContents</span>(span);
             } <span class=hljs-keyword>catch</span> (err) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error applying highlight:"</span>, err);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fallbackHighlightCreation</span>(range, span, selectedText);
             }

             <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">set</span>(id, highlightData);
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveToStorage</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addHighlightItem</span>(highlightData);
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHighlightListUI</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkGlobalVisibilityState</span>(); <span class=hljs-comment>// NOVO: Atualiza o estado do botão "Hide/Show"</span>

             <span class=hljs-keyword>return</span> <span class=hljs-literal>true</span>;
         }

         <span class="hljs-title function_">createHighlightData</span>(<span class=hljs-params>range, id, text</span>) {
             <span class=hljs-keyword>const</span> stableParentInfo = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getStableParentInfo</span>(
                 range.<span class=hljs-property>commonAncestorContainer</span>
             );
             <span class=hljs-keyword>const</span> parentElement = stableParentInfo.<span class=hljs-property>element</span>;
             <span class=hljs-keyword>const</span> parentTextContent = parentElement.<span class=hljs-property>textContent</span>;
             <span class=hljs-keyword>const</span> startIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">findTextStartIndex</span>(
                 range,
                 parentElement,
                 parentTextContent,
                 text
             );

             <span class=hljs-keyword>return</span> {
                 id,
                 text,
                 <span class=hljs-attr>parts</span>: [{
                     <span class=hljs-attr>stableParentSelector</span>: stableParentInfo.<span class=hljs-property>selector</span>,
                     <span class=hljs-attr>textSegment</span>: text,
                     <span class=hljs-attr>startOffsetInParentText</span>: startIndex,
                     <span class=hljs-attr>endOffsetInParentText</span>: startIndex + text.<span class=hljs-property>length</span>,
                 }, ],
                 <span class=hljs-attr>createdAt</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
                 <span class=hljs-attr>visible</span>: <span class=hljs-literal>true</span>, <span class=hljs-comment>// Adiciona a propriedade 'visible' ao dado do destaque, padrão true</span>
             };
         }

         <span class="hljs-title function_">findTextStartIndex</span>(<span class=hljs-params>range, parentElement, parentTextContent, text</span>) {
             <span class=hljs-keyword>let</span> startIndex = -<span class=hljs-number>1</span>;
             <span class=hljs-keyword>const</span> tempRange = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createRange</span>();
             tempRange.<span class="hljs-title function_">selectNodeContents</span>(parentElement);
             <span class=hljs-keyword>const</span> walker = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTreeWalker</span>(
                 parentElement,
                 <span class="hljs-title class_">NodeFilter</span>.<span class=hljs-property>SHOW_TEXT</span>
             );
             <span class=hljs-keyword>let</span> currentOffset = <span class=hljs-number>0</span>;
             <span class=hljs-keyword>let</span> node;

             <span class=hljs-keyword>while</span> ((node = walker.<span class="hljs-title function_">nextNode</span>())) {
                 <span class=hljs-keyword>if</span> (node === range.<span class=hljs-property>startContainer</span>) {
                     startIndex = currentOffset + range.<span class=hljs-property>startOffset</span>;
                     <span class=hljs-keyword>break</span>;
                 }
                 currentOffset += node.<span class=hljs-property>length</span>;
             }

             <span class=hljs-keyword>if</span> (startIndex === -<span class=hljs-number>1</span>) {
                 startIndex = parentTextContent.<span class="hljs-title function_">indexOf</span>(text, <span class=hljs-number>0</span>);
             }

             <span class=hljs-keyword>return</span> startIndex;
         }

         <span class="hljs-title function_">createHighlightSpan</span>(<span class=hljs-params>id</span>) {
             <span class=hljs-keyword>const</span> span = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElementSafely</span>(<span class=hljs-string>"span"</span>, {
                 <span class=hljs-attr>className</span>: <span class=hljs-string>"highlight"</span>,
                 <span class=hljs-attr>id</span>: <span class=hljs-string>`<span class=hljs-subst>${id}</span>-0`</span>,
                 <span class=hljs-attr>style</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHighlightStyle</span>(),
             });
             <span class=hljs-comment>// Adicionar event listener para copiar o texto ao clicar</span>
             span.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                 e.<span class="hljs-title function_">stopPropagation</span>(); <span class=hljs-comment>// Evita que o clique se propague e afete outras coisas (como fechar seleções)</span>
                 <span class=hljs-keyword>const</span> highlightData = <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">get</span>(id);
                 <span class=hljs-keyword>if</span> (highlightData) {
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">copyHighlightText</span>(highlightData.<span class=hljs-property>text</span>);
                 }
             });
             <span class=hljs-keyword>return</span> span;
         }

         <span class="hljs-title function_">fallbackHighlightCreation</span>(<span class=hljs-params>range, span, text</span>) {
             span.<span class=hljs-property>textContent</span> = text;
             range.<span class="hljs-title function_">deleteContents</span>();
             range.<span class="hljs-title function_">insertNode</span>(span);
         }

         <span class="hljs-title function_">getHighlightStyle</span>(<span class=hljs-params>isVisible = <span class=hljs-literal>true</span></span>) {
             <span class=hljs-comment>// Adicionado parâmetro isVisible</span>
             <span class=hljs-comment>// Estilo de destaque baseado no tema atual</span>
             <span class=hljs-keyword>if</span> (!isVisible) {
                 <span class=hljs-comment>// Se não estiver visível (checkbox desmarcado)</span>
                 <span class=hljs-keyword>return</span> <span class=hljs-string>"background-color: transparent; box-shadow: none; border-radius: 0; padding: 0;"</span>;
             } <span class=hljs-keyword>else</span> {
                 <span class=hljs-comment>// Se estiver visível (checkbox marcado)</span>
                 <span class=hljs-keyword>return</span> <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> === <span class=hljs-string>"dark"</span> ?
                     <span class=hljs-string>"background-color: #ffd700; box-shadow: 0 0 0 1px rgba(255, 215, 0, 0.5); border-radius: 3px; padding: 0 2px; color: black; cursor: pointer;"</span> :
                     <span class=hljs-string>"background-color: yellow; box-shadow: 0 0 0 1px rgba(255, 255, 0, 0.5); border-radius: 3px; padding: 0 2px; color: black; cursor: pointer;"</span>;
             }
         }

         <span class=hljs-comment>/* ========== RESTORATION LOGIC ========== */</span>
         <span class="hljs-title function_">restoreHighlight</span>(<span class=hljs-params>highlightData</span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> part = highlightData.<span class=hljs-property>parts</span>[<span class=hljs-number>0</span>];
                 <span class=hljs-keyword>if</span> (!part) <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;

                 <span class=hljs-keyword>const</span> fullId = <span class=hljs-string>`<span class=hljs-subst>${highlightData.id}</span>-0`</span>;
                 <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(fullId)) <span class=hljs-keyword>return</span> <span class=hljs-literal>true</span>;

                 <span class=hljs-keyword>const</span> parentElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(part.<span class=hljs-property>stableParentSelector</span>);
                 <span class=hljs-keyword>if</span> (!parentElement) {
                     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(
                         <span class=hljs-string>`Parent element not found for highlight <span class=hljs-subst>${highlightData.id}</span>: <span class=hljs-subst>${part.stableParentSelector}</span>`</span>
                     );
                     <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
                 }

                 <span class=hljs-keyword>return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">findAndHighlightText</span>(
                     parentElement,
                     part.<span class=hljs-property>textSegment</span>,
                     part.<span class=hljs-property>startOffsetInParentText</span>,
                     fullId,
                     highlightData.<span class=hljs-property>id</span>,
                     highlightData.<span class=hljs-property>visible</span> <span class=hljs-comment>// Passa o estado de visibilidade</span>
                 );
             } <span class=hljs-keyword>catch</span> (error) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>`Error restoring highlight <span class=hljs-subst>${highlightData.id}</span>:`</span>, error);
                 <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
             }
         }

         <span class="hljs-title function_">findAndHighlightText</span>(<span class=hljs-params>
             parentEl,
             textToFind,
             initialOffset,
             highlightId,
             originalHighlightId,
             isVisible = <span class=hljs-literal>true</span>
         </span>) {
             <span class=hljs-keyword>const</span> fullText = parentEl.<span class=hljs-property>textContent</span>;
             <span class=hljs-keyword>let</span> foundIndex =
                 fullText.<span class="hljs-title function_">indexOf</span>(textToFind, initialOffset) ||
                 fullText.<span class="hljs-title function_">indexOf</span>(textToFind);

             <span class=hljs-keyword>if</span> (foundIndex === -<span class=hljs-number>1</span>) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(
                     <span class=hljs-string>`Text '<span class=hljs-subst>${textToFind}</span>' not found in parent element for highlight <span class=hljs-subst>${highlightId}</span>`</span>
                 );
                 <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
             }

             <span class=hljs-keyword>const</span> range = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createRange</span>();
             <span class=hljs-keyword>const</span> nodes = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">findTextNodesForRange</span>(
                 parentEl,
                 foundIndex,
                 textToFind.<span class=hljs-property>length</span>
             );

             <span class=hljs-keyword>if</span> (nodes.<span class=hljs-property>startNode</span> &amp;&amp; nodes.<span class=hljs-property>endNode</span>) {
                 <span class=hljs-keyword>const</span> span = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createHighlightSpan</span>(originalHighlightId); <span class=hljs-comment>// Usar o ID original</span>
                 <span class=hljs-comment>// Aplica o estilo de visibilidade inicial baseado no isVisible</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyStyles</span>(span, <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHighlightStyle</span>(isVisible));
                 <span class=hljs-keyword>if</span> (!isVisible) span.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"hidden"</span>); <span class=hljs-comment>// Adiciona a classe hidden se não for visível</span>

                 <span class=hljs-keyword>try</span> {
                     range.<span class="hljs-title function_">setStart</span>(nodes.<span class=hljs-property>startNode</span>, nodes.<span class=hljs-property>startOffset</span>);
                     range.<span class="hljs-title function_">setEnd</span>(nodes.<span class=hljs-property>endNode</span>, nodes.<span class=hljs-property>endOffset</span>);
                     range.<span class="hljs-title function_">surroundContents</span>(span);
                     <span class=hljs-keyword>return</span> <span class=hljs-literal>true</span>;
                 } <span class=hljs-keyword>catch</span> (err) {
                     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>`Error restoring highlight <span class=hljs-subst>${highlightId}</span>:`</span>, err);
                     <span class=hljs-keyword>return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fallbackHighlightCreation</span>(range, span, textToFind);
                 }
             }
             <span class=hljs-keyword>return</span> <span class=hljs-literal>false</span>;
         }

         <span class="hljs-title function_">findTextNodesForRange</span>(<span class=hljs-params>parentEl, startIndex, length</span>) {
             <span class=hljs-keyword>const</span> range = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createRange</span>();
             <span class=hljs-keyword>let</span> currentOffset = <span class=hljs-number>0</span>;
             <span class=hljs-keyword>let</span> startNode = <span class=hljs-literal>null</span>,
                 endNode = <span class=hljs-literal>null</span>;
             <span class=hljs-keyword>let</span> startOffset = <span class=hljs-number>0</span>,
                 endOffset = <span class=hljs-number>0</span>;

             <span class=hljs-keyword>const</span> walker = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTreeWalker</span>(parentEl, <span class="hljs-title class_">NodeFilter</span>.<span class=hljs-property>SHOW_TEXT</span>);
             <span class=hljs-keyword>let</span> node;

             <span class=hljs-keyword>while</span> ((node = walker.<span class="hljs-title function_">nextNode</span>())) {
                 <span class=hljs-keyword>const</span> nodeLength = node.<span class=hljs-property>length</span>;

                 <span class=hljs-keyword>if</span> (startNode === <span class=hljs-literal>null</span> &amp;&amp; currentOffset + nodeLength &gt; startIndex) {
                     startNode = node;
                     startOffset = startIndex - currentOffset;
                 }

                 <span class=hljs-keyword>if</span> (
                     endNode === <span class=hljs-literal>null</span> &amp;&amp;
                     currentOffset + nodeLength &gt;= startIndex + length
                 ) {
                     endNode = node;
                     endOffset = startIndex + length - currentOffset;
                     <span class=hljs-keyword>break</span>;
                 }
                 currentOffset += nodeLength;
             }

             <span class=hljs-keyword>return</span> {
                 startNode,
                 startOffset,
                 endNode,
                 endOffset
             };
         }

         <span class="hljs-title function_">scheduleHighlightRestore</span>(<span class=hljs-params>id</span>) {
             <span class=hljs-keyword>if</span> (!<span class="hljs-variable language_">this</span>.<span class=hljs-property>restoreQueue</span>.<span class="hljs-title function_">has</span>(id)) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>restoreQueue</span>.<span class="hljs-title function_">set</span>(
                     id,
                     <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> {
                         <span class=hljs-keyword>const</span> data = <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">get</span>(id);
                         <span class=hljs-keyword>if</span> (data) {
                             <span class=hljs-comment>// Passa o estado de visibilidade salvo</span>
                             <span class=hljs-keyword>const</span> success = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restoreHighlight</span>(data);
                             <span class=hljs-keyword>if</span> (!success) {
                                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class=hljs-string>`Failed to restore highlight <span class=hljs-subst>${id}</span>`</span>);
                                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">delete</span>(id);
                                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveToStorage</span>();
                             }
                         }
                         <span class="hljs-variable language_">this</span>.<span class=hljs-property>restoreQueue</span>.<span class="hljs-title function_">delete</span>(id);
                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkGlobalVisibilityState</span>(); <span class=hljs-comment>// Garante que o botão global se atualize após restauração</span>
                     }, <span class=hljs-number>1000</span>)
                 );
             }
         }

         <span class=hljs-comment>/* ========== COPY TO CLIPBOARD FUNCTIONALITY ========== */</span>
         <span class=hljs-keyword>async</span> <span class="hljs-title function_">copyHighlightText</span>(<span class=hljs-params>text</span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>await</span> navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">writeText</span>(text);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showFeedback</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span>.<span class=hljs-property>copiedToClipboard</span>, <span class=hljs-string>"success"</span>);
             } <span class=hljs-keyword>catch</span> (err) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Failed to copy text: "</span>, err);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showFeedback</span>(<span class=hljs-string>"Falha ao copiar o texto."</span>, <span class=hljs-string>"error"</span>);
             }
         }

         <span class=hljs-comment>/* ========== MERGE HIGHLIGHTS FUNCTIONALITY ========== */</span>
         <span class=hljs-keyword>async</span> <span class="hljs-title function_">handleMergeHighlights</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> visibleHighlights = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">values</span>()).<span class="hljs-title function_">filter</span>(
                 <span class=hljs-function>(<span class=hljs-params>h</span>) =&gt;</span> h.<span class=hljs-property>visible</span>
             );

             <span class=hljs-keyword>if</span> (visibleHighlights.<span class=hljs-property>length</span> === <span class=hljs-number>0</span>) {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showFeedback</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span>.<span class=hljs-property>noVisibleHighlights</span>, <span class=hljs-string>"warning"</span>);
                 <span class=hljs-keyword>return</span>;
             }

             <span class=hljs-comment>// Sort highlights by their appearance order in the DOM</span>
             visibleHighlights.<span class="hljs-title function_">sort</span>(<span class=hljs-function>(<span class=hljs-params>a, b</span>) =&gt;</span> {
                 <span class=hljs-keyword>const</span> elA = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>`<span class=hljs-subst>${a.id}</span>-0`</span>);
                 <span class=hljs-keyword>const</span> elB = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>`<span class=hljs-subst>${b.id}</span>-0`</span>);

                 <span class=hljs-keyword>if</span> (!elA || !elB) {
                     <span class=hljs-comment>// Fallback to creation date if elements not found in DOM</span>
                     <span class=hljs-keyword>return</span> a.<span class=hljs-property>createdAt</span> - b.<span class=hljs-property>createdAt</span>;
                 }

                 <span class=hljs-comment>// Compare positions using compareDocumentPosition</span>
                 <span class=hljs-keyword>const</span> position = elA.<span class="hljs-title function_">compareDocumentPosition</span>(elB);
                 <span class=hljs-keyword>if</span> (position &amp; <span class="hljs-title class_">Node</span>.<span class=hljs-property>DOCUMENT_POSITION_FOLLOWING</span>) {
                     <span class=hljs-keyword>return</span> -<span class=hljs-number>1</span>; <span class=hljs-comment>// A comes before B</span>
                 } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (position &amp; <span class="hljs-title class_">Node</span>.<span class=hljs-property>DOCUMENT_POSITION_PRECEDING</span>) {
                     <span class=hljs-keyword>return</span> <span class=hljs-number>1</span>; <span class=hljs-comment>// B comes before A</span>
                 }
                 <span class=hljs-keyword>return</span> <span class=hljs-number>0</span>; <span class=hljs-comment>// Same position or not comparable</span>
             });

             <span class=hljs-keyword>const</span> separator = <span class="hljs-title function_">prompt</span>(
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span>.<span class=hljs-property>mergePrompt</span>,
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span>.<span class=hljs-property>defaultSeparator</span>
             );

             <span class=hljs-keyword>if</span> (separator === <span class=hljs-literal>null</span>) {
                 <span class=hljs-comment>// User cancelled the prompt</span>
                 <span class=hljs-keyword>return</span>;
             }

             <span class=hljs-keyword>const</span> mergedText = visibleHighlights
                 .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>h</span>) =&gt;</span> h.<span class=hljs-property>text</span>)
                 .<span class="hljs-title function_">join</span>(<span class=hljs-string>`\n<span class=hljs-subst>${separator}</span>\n`</span>);

             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>await</span> navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">writeText</span>(mergedText);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showFeedback</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span>.<span class=hljs-property>mergeSuccess</span>, <span class=hljs-string>"success"</span>);
             } <span class=hljs-keyword>catch</span> (err) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Failed to copy merged text: "</span>, err);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showFeedback</span>(<span class=hljs-string>"Falha ao copiar o texto mesclado."</span>, <span class=hljs-string>"error"</span>);
             }
         }

         <span class=hljs-comment>/* ========== STORAGE MANAGEMENT ========== */</span>
         <span class="hljs-title function_">saveToStorage</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> data = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">values</span>());
             <span class=hljs-keyword>try</span> {
                 <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class=hljs-string>"highlights"</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class=hljs-keyword>if</span> (e.<span class=hljs-property>name</span> === <span class=hljs-string>"QuotaExceededError"</span>) {
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleStorageQuotaExceeded</span>(data);
                 }
             }
         }

         <span class="hljs-title function_">handleStorageQuotaExceeded</span>(<span class=hljs-params>data</span>) {
             <span class=hljs-keyword>const</span> half = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(data.<span class=hljs-property>length</span> / <span class=hljs-number>2</span>);
             <span class=hljs-keyword>const</span> newData = data.<span class="hljs-title function_">slice</span>(half);
             <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class=hljs-string>"highlights"</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(newData));
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span> = <span class=hljs-keyword>new</span> <span class="hljs-title class_">Map</span>(newData.<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> [item.<span class=hljs-property>id</span>, item]));
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showFeedback</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span>.<span class=hljs-property>storageExceeded</span>, <span class=hljs-string>"warning"</span>);
         }

         <span class="hljs-title function_">saveUISettings</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> settings = {
                 <span class=hljs-attr>position</span>: {
                     <span class=hljs-attr>top</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>top</span>,
                     <span class=hljs-attr>left</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>left</span>,
                 },
                 <span class=hljs-attr>sortOrder</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span>,
                 <span class=hljs-attr>hidden</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span>, <span class=hljs-comment>// Salva o estado global do botão Hide/Show</span>
                 <span class=hljs-attr>minimized</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>?.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".content"</span>).<span class=hljs-property>style</span>.<span class=hljs-property>display</span> === <span class=hljs-string>"none"</span>,
                 <span class=hljs-attr>theme</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span>,
             };
             <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(
                 <span class=hljs-string>"highlightManagerUISettings"</span>,
                 <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(settings)
             );
         }

         <span class="hljs-title function_">loadUISettings</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> saved = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class=hljs-string>"highlightManagerUISettings"</span>);
                 <span class=hljs-keyword>if</span> (!saved) {
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> = <span class=hljs-literal>false</span>;
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSystemPreferredTheme</span>();
                     <span class=hljs-keyword>return</span>;
                 }
                 <span class=hljs-keyword>const</span> settings = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(saved);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyUISettings</span>(settings);
             } <span class=hljs-keyword>catch</span> (e) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> = <span class=hljs-literal>false</span>;
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSystemPreferredTheme</span>();
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class=hljs-string>"Failed to load UI settings:"</span>, e);
                 <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class=hljs-string>"highlightManagerUISettings"</span>);
             }
         }

         <span class="hljs-title function_">applyUISettings</span>(<span class=hljs-params>settings</span>) {
             <span class=hljs-keyword>if</span> (settings.<span class=hljs-property>position</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>top</span> = settings.<span class=hljs-property>position</span>.<span class=hljs-property>top</span> || <span class=hljs-string>"20px"</span>;
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>left</span> = settings.<span class=hljs-property>position</span>.<span class=hljs-property>left</span> || <span class=hljs-string>"auto"</span>;
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>right</span> = <span class=hljs-string>"auto"</span>;
             }

             <span class=hljs-keyword>if</span> (settings.<span class=hljs-property>minimized</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".content"</span>).<span class=hljs-property>style</span>.<span class=hljs-property>display</span> =
                     settings.<span class=hljs-property>minimized</span> ? <span class=hljs-string>"none"</span> : <span class=hljs-string>"block"</span>;
             }

             <span class=hljs-keyword>if</span> (settings.<span class=hljs-property>sortOrder</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> = settings.<span class=hljs-property>sortOrder</span>;
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateSortButton</span>();
             }

             <span class=hljs-keyword>if</span> (<span class=hljs-keyword>typeof</span> settings.<span class=hljs-property>hidden</span> === <span class=hljs-string>"boolean"</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> = settings.<span class=hljs-property>hidden</span>; <span class=hljs-comment>// Carrega o estado global</span>
             }

             <span class=hljs-keyword>if</span> (
                 settings.<span class=hljs-property>theme</span> &amp;&amp;
                 (settings.<span class=hljs-property>theme</span> === <span class=hljs-string>"light"</span> || settings.<span class=hljs-property>theme</span> === <span class=hljs-string>"dark"</span>)
             ) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> = settings.<span class=hljs-property>theme</span>;
             } <span class=hljs-keyword>else</span> {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSystemPreferredTheme</span>();
             }
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyTheme</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span>);
         }

         <span class="hljs-title function_">loadFromStorage</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> saved = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class=hljs-string>"highlights"</span>);
             <span class=hljs-keyword>if</span> (!saved) <span class=hljs-keyword>return</span>;

             <span class=hljs-keyword>try</span> {
                 <span class=hljs-keyword>const</span> parsed = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(saved);
                 parsed.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> {
                     <span class=hljs-comment>// Garante que 'visible' exista, mesmo para destaques antigos</span>
                     <span class=hljs-keyword>if</span> (item.<span class=hljs-property>visible</span> === <span class=hljs-literal>undefined</span>) {
                         item.<span class=hljs-property>visible</span> = <span class=hljs-literal>true</span>;
                     }
                     <span class=hljs-keyword>if</span> (!<span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">has</span>(item.<span class=hljs-property>id</span>)) {
                         <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">set</span>(item.<span class=hljs-property>id</span>, item);
                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleHighlightRestore</span>(item.<span class=hljs-property>id</span>);
                     }
                 });
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHighlightListUI</span>();
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkGlobalVisibilityState</span>(); <span class=hljs-comment>// NOVO: Verifica o estado global após carregar destaques</span>
             } <span class=hljs-keyword>catch</span> (err) {
                 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class=hljs-string>"Error loading highlights:"</span>, err);
                 <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class=hljs-string>"highlights"</span>);
             }
         }

         <span class=hljs-comment>/* ========== UI MANAGEMENT ========== */</span>
         <span class="hljs-title function_">showFeedback</span>(<span class=hljs-params>message, type = <span class=hljs-string>"success"</span></span>) {
             <span class=hljs-keyword>const</span> feedback = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElementSafely</span>(<span class=hljs-string>"div"</span>, {
                 <span class=hljs-attr>textContent</span>: message,
                 <span class=hljs-attr>style</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>styles</span>.<span class="hljs-title function_">feedback</span>(type),
             });

             <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(feedback);
             <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> feedback.<span class="hljs-title function_">remove</span>(), <span class=hljs-number>3000</span>);
         }

         <span class="hljs-title function_">attachPopup</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>popupId</span>)?.<span class="hljs-title function_">remove</span>();

             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElementSafely</span>(<span class=hljs-string>"div"</span>, {
                 <span class=hljs-attr>id</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>popupId</span>,
                 <span class=hljs-attr>style</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>styles</span>.<span class=hljs-property>shadowHost</span>,
             });
             <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>);

             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class="hljs-title function_">attachShadow</span>({
                 <span class=hljs-attr>mode</span>: <span class=hljs-string>"open"</span>
             });
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderPopupContent</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupPopupEventListeners</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">enableDrag</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyTheme</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span>); <span class=hljs-comment>// Aplicar o tema inicial aqui</span>
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkGlobalVisibilityState</span>(); <span class=hljs-comment>// NOVO: Chamar para garantir que o botão "Hide/Show" esteja correto</span>
         }

         <span class="hljs-title function_">renderPopupContent</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> container = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElementSafely</span>(<span class=hljs-string>"div"</span>);

             <span class=hljs-comment>// O texto do botão será definido pelo checkGlobalVisibilityState</span>
             <span class=hljs-keyword>const</span> popupHTML = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPopupHTML</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setInnerHTMLSafely</span>(container, popupHTML);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(container);

             <span class=hljs-comment>// Estilos serão injetados por applyTheme</span>
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHideButton</span>(); <span class=hljs-comment>// Chamado aqui para definir o estado inicial do botão</span>
         }

         <span class="hljs-title function_">setupPopupEventListeners</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> elements = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPopupElements</span>();

             elements.<span class=hljs-property>clearBtn</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleClearClick</span>()
             );
             elements.<span class=hljs-property>hideToggleBtn</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleHideToggle</span>()
             );
             elements.<span class=hljs-property>mergeBtn</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleMergeHighlights</span>()
             ); <span class=hljs-comment>// NOVO: Event listener para o botão Merge</span>
             elements.<span class=hljs-property>closeBtn</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleCloseClick</span>(e)
             );
             elements.<span class=hljs-property>minimizeBtn</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleMinimizeClick</span>()
             );
             elements.<span class=hljs-property>searchInput</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"input"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleSearchInput</span>(e)
             );
             elements.<span class=hljs-property>clearSearchBtn</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleClearSearch</span>()
             );
             elements.<span class=hljs-property>sortToggleBtn</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleSortToggle</span>()
             );
             elements.<span class=hljs-property>themeToggleBtn</span>?.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>() =&gt;</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">toggleTheme</span>()
             );

             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">enableDrag</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>, elements.<span class=hljs-property>popupHeader</span>);
         }

         <span class="hljs-title function_">getPopupElements</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>return</span> {
                 <span class=hljs-attr>clearBtn</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"clear"</span>),
                 <span class=hljs-attr>hideToggleBtn</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"hide-toggle"</span>),
                 <span class=hljs-attr>mergeBtn</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"merge-highlights"</span>), <span class=hljs-comment>// NOVO: Pega o botão Merge</span>
                 <span class=hljs-attr>closeBtn</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"btn-close"</span>),
                 <span class=hljs-attr>minimizeBtn</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"btn-minimize"</span>),
                 <span class=hljs-attr>searchInput</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"search-input"</span>),
                 <span class=hljs-attr>clearSearchBtn</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"clear-search"</span>),
                 <span class=hljs-attr>sortToggleBtn</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"sort-toggle"</span>),
                 <span class=hljs-attr>popupHeader</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"popup-header"</span>),
                 <span class=hljs-attr>content</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".content"</span>),
                 <span class=hljs-attr>themeToggleBtn</span>: <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"theme-toggle"</span>),
             };
         }

         <span class="hljs-title function_">handleClearClick</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-title function_">confirm</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span>.<span class=hljs-property>confirmClear</span>)) {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">clearHighlights</span>();
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showFeedback</span>(<span class=hljs-string>"Todos os destaques foram removidos"</span>, <span class=hljs-string>"success"</span>);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkGlobalVisibilityState</span>(); <span class=hljs-comment>// NOVO: Atualiza o botão após limpar</span>
             }
         }

         <span class="hljs-title function_">handleHideToggle</span>(<span class=hljs-params></span>) {
             <span class=hljs-comment>// Alterna o estado global</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> = !<span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span>;
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveUISettings</span>();

             <span class=hljs-comment>// Aplica o estado de visibilidade a TODOS os destaques e seus checkboxes</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>highlightData, id</span>) =&gt;</span> {
                 highlightData.<span class=hljs-property>visible</span> = !<span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span>; <span class=hljs-comment>// Atualiza o dado</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">toggleHighlightVisibility</span>(id, highlightData.<span class=hljs-property>visible</span>);

                 <span class=hljs-keyword>const</span> checkbox = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">querySelector</span>(
                     <span class=hljs-string>`#li-<span class=hljs-subst>${id}</span> input[type="checkbox"]`</span>
                 );
                 <span class=hljs-keyword>if</span> (checkbox) {
                     checkbox.<span class=hljs-property>checked</span> = highlightData.<span class=hljs-property>visible</span>;
                 }
             });
             <span class=hljs-comment>// Atualiza o botão "Hide/Show" com base no novo estado global</span>
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHideButton</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveToStorage</span>(); <span class=hljs-comment>// Salva o estado de visibilidade de todos os destaques</span>
         }

         <span class="hljs-title function_">handleCloseClick</span>(<span class=hljs-params>e</span>) {
             e.<span class="hljs-title function_">stopPropagation</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">animatePopupClose</span>();
         }

         <span class="hljs-title function_">animatePopupClose</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>transition</span> = <span class=hljs-string>"opacity 0.2s ease"</span>;
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>style</span>.<span class=hljs-property>opacity</span> = <span class=hljs-string>"0"</span>;

             <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroy</span>();
             }, <span class=hljs-number>200</span>);
         }

         <span class="hljs-title function_">handleMinimizeClick</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> content = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".content"</span>);
             content.<span class=hljs-property>style</span>.<span class=hljs-property>display</span> =
                 content.<span class=hljs-property>style</span>.<span class=hljs-property>display</span> === <span class=hljs-string>"none"</span> ? <span class=hljs-string>"block"</span> : <span class=hljs-string>"none"</span>;
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveUISettings</span>();
         }

         <span class="hljs-title function_">handleSearchInput</span>(<span class=hljs-params>e</span>) {
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHighlightListUI</span>(e.<span class=hljs-property>target</span>.<span class=hljs-property>value</span>);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"clear-search"</span>).<span class=hljs-property>style</span>.<span class=hljs-property>display</span> = e.<span class=hljs-property>target</span>
                 .<span class=hljs-property>value</span> ?
                 <span class=hljs-string>"block"</span> :
                 <span class=hljs-string>"none"</span>;
         }

         <span class="hljs-title function_">handleClearSearch</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> searchInput = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"search-input"</span>);
             searchInput.<span class=hljs-property>value</span> = <span class=hljs-string>""</span>;
             searchInput.<span class="hljs-title function_">focus</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHighlightListUI</span>(<span class=hljs-string>""</span>);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"clear-search"</span>).<span class=hljs-property>style</span>.<span class=hljs-property>display</span> = <span class=hljs-string>"none"</span>;
         }

         <span class="hljs-title function_">handleSortToggle</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> === <span class=hljs-string>"creation"</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> = <span class=hljs-string>"asc"</span>; <span class=hljs-comment>// Vai para A-Z</span>
             } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> === <span class=hljs-string>"asc"</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> = <span class=hljs-string>"desc"</span>; <span class=hljs-comment>// Vai para Z-A</span>
             } <span class=hljs-keyword>else</span> {
                 <span class=hljs-comment>// this.sortOrder === "desc"</span>
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> = <span class=hljs-string>"creation"</span>; <span class=hljs-comment>// Volta para ordem de criação</span>
             }
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateSortButton</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHighlightListUI</span>(
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"search-input"</span>).<span class=hljs-property>value</span>
             );
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveUISettings</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateSortButton</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHighlightListUI</span>(
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"search-input"</span>).<span class=hljs-property>value</span>
             );
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveUISettings</span>();
         }

         <span class="hljs-title function_">updateSortButton</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> sortBtn = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"sort-toggle"</span>);
             <span class=hljs-keyword>if</span> (sortBtn) {
                 <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> === <span class=hljs-string>"creation"</span>) {
                     sortBtn.<span class=hljs-property>textContent</span> = <span class=hljs-string>"↓ Creation (No Sort)"</span>; <span class=hljs-comment>// Ou "Default", "Definição", "Original"</span>
                     sortBtn.<span class=hljs-property>title</span> = <span class=hljs-string>"Next sort by text (A-Z)"</span>;
                 } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> === <span class=hljs-string>"asc"</span>) {
                     sortBtn.<span class=hljs-property>textContent</span> = <span class=hljs-string>"↑ Asc (A-Z)"</span>;
                     sortBtn.<span class=hljs-property>title</span> = <span class=hljs-string>"Next sort by text (Z-A)"</span>;
                 } <span class=hljs-keyword>else</span> {
                     <span class=hljs-comment>// this.sortOrder === "desc"</span>
                     sortBtn.<span class=hljs-property>textContent</span> = <span class=hljs-string>"↓ Desc (Z-A)"</span>;
                     sortBtn.<span class=hljs-property>title</span> = <span class=hljs-string>"Next sort by creation time"</span>; <span class=hljs-comment>// Volta para ordem de criação</span>
                 }
             }
         }

         <span class=hljs-comment>// NOVO/ATUALIZADO: Atualiza o texto e estilo do botão Hide/Show baseado em this.hidden</span>
         <span class="hljs-title function_">updateHideButton</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> hideBtn = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"hide-toggle"</span>);
             <span class=hljs-keyword>if</span> (hideBtn) {
                 hideBtn.<span class=hljs-property>textContent</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> ?
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span>.<span class=hljs-property>showHighlights</span> :
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>strings</span>.<span class=hljs-property>hideHighlights</span>;

                 <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span>) {
                     hideBtn.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"hidden-state"</span>);
                 } <span class=hljs-keyword>else</span> {
                     hideBtn.<span class=hljs-property>classList</span>.<span class="hljs-title function_">remove</span>(<span class=hljs-string>"hidden-state"</span>);
                 }
             }
         }

         <span class=hljs-comment>// NOVO MÉ<span class=hljs-doctag>TODO:</span> Verifica o estado de visibilidade de todos os destaques</span>
         <span class="hljs-title function_">checkGlobalVisibilityState</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (!<span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>) <span class=hljs-keyword>return</span>;

             <span class=hljs-keyword>const</span> totalHighlights = <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class=hljs-property>size</span>;
             <span class=hljs-keyword>if</span> (totalHighlights === <span class=hljs-number>0</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> = <span class=hljs-literal>false</span>; <span class=hljs-comment>// Se não houver destaques, o botão deve mostrar "Hide" (ou seja, não há nada escondido)</span>
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHideButton</span>();
                 <span class=hljs-keyword>return</span>;
             }

             <span class=hljs-keyword>let</span> anyVisible = <span class=hljs-literal>false</span>;
             <span class=hljs-keyword>let</span> anyHidden = <span class=hljs-literal>false</span>;

             <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>highlightData</span>) =&gt;</span> {
                 <span class=hljs-keyword>if</span> (!highlightData.<span class=hljs-property>visible</span>) {
                     anyHidden = <span class=hljs-literal>true</span>;
                 } <span class=hljs-keyword>else</span> {
                     anyVisible = <span class=hljs-literal>true</span>;
                 }
             });

             <span class=hljs-comment>// Se todos estiverem escondidos (e houver destaques), o botão global deve ser "Show"</span>
             <span class=hljs-keyword>if</span> (!anyVisible &amp;&amp; anyHidden) {
                 <span class=hljs-comment>// This means all existing highlights are currently hidden</span>
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> = <span class=hljs-literal>true</span>;
             } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (anyVisible &amp;&amp; !anyHidden) {
                 <span class=hljs-comment>// All existing highlights are visible</span>
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> = <span class=hljs-literal>false</span>;
             } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (anyVisible &amp;&amp; anyHidden) {
                 <span class=hljs-comment>// Some visible, some hidden</span>
                 <span class=hljs-comment>// This case is tricky for the global button.</span>
                 <span class=hljs-comment>// We'll set 'hidden' based on the last state applied by 'handleHideToggle'</span>
                 <span class=hljs-comment>// or by default, if some are hidden, the global 'Hide' button should conceptually imply 'show all'.</span>
                 <span class=hljs-comment>// Let's re-evaluate the intended behavior of the global button.</span>
                 <span class=hljs-comment>// If 'hidden' means "all highlights are currently hidden by the global toggle",</span>
                 <span class=hljs-comment>// then if even one is visible, the global toggle state should reflect "hide all".</span>
                 <span class=hljs-comment>// Let's stick to: if ANY highlight is hidden, the global button should say "Show".</span>
                 <span class=hljs-comment>// If ALL highlights are visible, the global button should say "Hide".</span>
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> = anyHidden; <span class=hljs-comment>// If any are hidden, the global toggle should prompt to "Show"</span>
             } <span class=hljs-keyword>else</span> {
                 <span class=hljs-comment>// No highlights at all</span>
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>hidden</span> = <span class=hljs-literal>false</span>;
             }
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHideButton</span>();
         }

         <span class="hljs-title function_">addHighlightItem</span>(<span class=hljs-params>{
             id,
             text,
             visible
         }</span>) {
             <span class=hljs-comment>// Adiciona 'visible' como parâmetro</span>
             <span class=hljs-keyword>const</span> list = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>?.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".highlight-list"</span>);
             <span class=hljs-keyword>if</span> (!list || <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>`li-<span class=hljs-subst>${id}</span>`</span>)) <span class=hljs-keyword>return</span>;

             <span class=hljs-keyword>const</span> li = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElementSafely</span>(<span class=hljs-string>"li"</span>, {
                 <span class=hljs-attr>id</span>: <span class=hljs-string>`li-<span class=hljs-subst>${id}</span>`</span>
             });
             <span class=hljs-keyword>const</span> removeBtn = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createRemoveButton</span>(id);
             <span class=hljs-keyword>const</span> checkbox = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createVisibilityCheckbox</span>(id, visible); <span class=hljs-comment>// Passa 'visible' para o checkbox</span>
             <span class=hljs-keyword>const</span> link = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createHighlightLink</span>(id, text);

             li.<span class="hljs-title function_">append</span>(removeBtn, checkbox, link);
             list.<span class="hljs-title function_">appendChild</span>(li);
             <span class=hljs-comment>// A visibilidade do highlight real no DOM será definida pelo checkbox handler</span>
             <span class=hljs-comment>// ou pelo toggleHighlightVisibility chamado no restoreHighlight.</span>
             <span class=hljs-comment>// O importante é que a propriedade 'visible' no highlightData esteja correta.</span>
         }

         <span class="hljs-title function_">createRemoveButton</span>(<span class=hljs-params>id</span>) {
             <span class=hljs-keyword>const</span> removeBtn = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElementSafely</span>(<span class=hljs-string>"button"</span>, {
                 <span class=hljs-attr>textContent</span>: <span class=hljs-string>"✕"</span>,
                 <span class=hljs-attr>attributes</span>: {
                     <span class=hljs-attr>title</span>: <span class=hljs-string>"Remover destaque"</span>
                 },
             });
             removeBtn.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                 e.<span class="hljs-title function_">stopPropagation</span>();
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeHighlightById</span>(id);
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkGlobalVisibilityState</span>(); <span class=hljs-comment>// NOVO: Atualiza o botão após remover</span>
             });
             <span class=hljs-keyword>return</span> removeBtn;
         }

         <span class="hljs-title function_">createVisibilityCheckbox</span>(<span class=hljs-params>id, initialVisibility</span>) {
             <span class=hljs-comment>// Recebe o estado inicial</span>
             <span class=hljs-keyword>const</span> checkbox = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElementSafely</span>(<span class=hljs-string>"input"</span>, {
                 <span class=hljs-attr>attributes</span>: {
                     <span class=hljs-attr>type</span>: <span class=hljs-string>"checkbox"</span>,
                     <span class=hljs-attr>checked</span>: initialVisibility, <span class=hljs-comment>// Define o estado inicial do checkbox</span>
                 },
             });
             checkbox.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"change"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                 e.<span class="hljs-title function_">stopPropagation</span>();
                 <span class=hljs-keyword>const</span> highlightData = <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">get</span>(id);
                 <span class=hljs-keyword>if</span> (highlightData) {
                     highlightData.<span class=hljs-property>visible</span> = e.<span class=hljs-property>target</span>.<span class=hljs-property>checked</span>; <span class=hljs-comment>// Atualiza o estado no objeto de dados</span>
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">toggleHighlightVisibility</span>(id, e.<span class=hljs-property>target</span>.<span class=hljs-property>checked</span>);
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveToStorage</span>(); <span class=hljs-comment>// Salva a mudança de visibilidade</span>
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkGlobalVisibilityState</span>(); <span class=hljs-comment>// NOVO: Atualiza o estado do botão "Hide/Show"</span>
                 }
             });
             <span class=hljs-keyword>return</span> checkbox;
         }

         <span class="hljs-title function_">createHighlightLink</span>(<span class=hljs-params>id, text</span>) {
             <span class=hljs-keyword>const</span> link = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElementSafely</span>(<span class=hljs-string>"a"</span>, {
                 <span class=hljs-attr>textContent</span>: <span class="hljs-variable language_">this</span>.escapeHTML(
                     text.<span class=hljs-property>length</span> &gt; <span class=hljs-number>30</span> ? <span class=hljs-string>`<span class=hljs-subst>${text.slice(<span class=hljs-number>0</span>, <span class=hljs-number>30</span>)}</span>…`</span> : text
                 ),
                 <span class=hljs-attr>style</span>: <span class=hljs-string>"text-decoration:none;cursor:pointer;"</span>,
                 <span class=hljs-attr>attributes</span>: {
                     <span class=hljs-attr>href</span>: <span class=hljs-string>`#<span class=hljs-subst>${id}</span>`</span>
                 },
             });
             link.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
                 e.<span class="hljs-title function_">preventDefault</span>();
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scrollToHighlight</span>(id);
             });
             <span class=hljs-keyword>return</span> link;
         }

         <span class="hljs-title function_">removeHighlightById</span>(<span class=hljs-params>id</span>) {
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>`[id^="<span class=hljs-subst>${id}</span>-"]`</span>).<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>el</span>) =&gt;</span> {
                 el.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"click"</span>, <span class="hljs-variable language_">this</span>.<span class=hljs-property>copyHighlightText</span>);
                 el.<span class="hljs-title function_">replaceWith</span>(...el.<span class=hljs-property>childNodes</span>);
             });
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">delete</span>(id);
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveToStorage</span>();
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>`li-<span class=hljs-subst>${id}</span>`</span>)?.<span class="hljs-title function_">remove</span>();
         }

         <span class="hljs-title function_">toggleHighlightVisibility</span>(<span class=hljs-params>id, visible</span>) {
             <span class=hljs-keyword>const</span> highlights = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>`[id^="<span class=hljs-subst>${id}</span>-"]`</span>);
             <span class=hljs-keyword>if</span> (!highlights.<span class=hljs-property>length</span>) <span class=hljs-keyword>return</span>;

             <span class=hljs-keyword>const</span> style = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHighlightStyle</span>(visible); <span class=hljs-comment>// Passa o estado de visibilidade</span>
             highlights.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>el</span>) =&gt;</span> {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyStyles</span>(el, style);
                 visible ? el.<span class=hljs-property>classList</span>.<span class="hljs-title function_">remove</span>(<span class=hljs-string>"hidden"</span>) : el.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>"hidden"</span>);
             });
         }

         <span class="hljs-title function_">scrollToHighlight</span>(<span class=hljs-params>id</span>) {
             <span class=hljs-keyword>const</span> firstPart = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>`<span class=hljs-subst>${id}</span>-0`</span>);
             <span class=hljs-keyword>if</span> (!firstPart) <span class=hljs-keyword>return</span>;

             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyStyles</span>(firstPart, <span class=hljs-string>"animation: highlight-pulse 0.5s 2;"</span>);
             firstPart.<span class="hljs-title function_">scrollIntoView</span>({
                 <span class=hljs-attr>behavior</span>: <span class=hljs-string>"smooth"</span>,
                 <span class=hljs-attr>block</span>: <span class=hljs-string>"center"</span>
             });

             <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> {
                 <span class=hljs-comment>// Reaplica o estilo original de visibilidade após a animação</span>
                 <span class=hljs-keyword>const</span> highlightData = <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">get</span>(id);
                 <span class=hljs-keyword>if</span> (highlightData) {
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyStyles</span>(
                         firstPart,
                         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHighlightStyle</span>(highlightData.<span class=hljs-property>visible</span>)
                     );
                 } <span class=hljs-keyword>else</span> {
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyStyles</span>(firstPart, <span class=hljs-string>""</span>); <span class=hljs-comment>// Se por algum motivo o destaque sumiu, limpa o estilo</span>
                 }
             }, <span class=hljs-number>1000</span>);
         }

         <span class="hljs-title function_">updateHighlightListUI</span>(<span class=hljs-params>filterText = <span class=hljs-string>""</span></span>) {
             <span class=hljs-keyword>if</span> (!<span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>) <span class=hljs-keyword>return</span>;

             <span class=hljs-keyword>const</span> list = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".highlight-list"</span>);
             <span class=hljs-keyword>if</span> (!list) <span class=hljs-keyword>return</span>;

             list.<span class=hljs-property>innerHTML</span> = <span class=hljs-string>""</span>; <span class=hljs-comment>// Clear existing items</span>

             <span class=hljs-keyword>const</span> highlightsArray = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">filterAndSortHighlights</span>(filterText);
             highlightsArray.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addHighlightItem</span>(item)); <span class=hljs-comment>// item agora inclui 'visible'</span>
         }

         <span class="hljs-title function_">filterAndSortHighlights</span>(<span class=hljs-params>filterText</span>) {
             <span class=hljs-keyword>let</span> highlightsArray = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">values</span>());

             <span class=hljs-keyword>if</span> (filterText) {
                 <span class=hljs-keyword>const</span> searchText = filterText.<span class="hljs-title function_">toLowerCase</span>();
                 highlightsArray = highlightsArray.<span class="hljs-title function_">filter</span>(<span class=hljs-function>(<span class=hljs-params>item</span>) =&gt;</span>
                     item.<span class=hljs-property>text</span>.<span class="hljs-title function_">toLowerCase</span>().<span class="hljs-title function_">includes</span>(searchText)
                 );
             }

             <span class=hljs-keyword>return</span> highlightsArray.<span class="hljs-title function_">sort</span>(<span class=hljs-function>(<span class=hljs-params>a, b</span>) =&gt;</span> {
                 <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> === <span class=hljs-string>"creation"</span>) {
                     <span class=hljs-keyword>return</span> a.<span class=hljs-property>createdAt</span> - b.<span class=hljs-property>createdAt</span>; <span class=hljs-comment>// Ordena por data de criação (mais antigo primeiro)</span>
                 } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>sortOrder</span> === <span class=hljs-string>"asc"</span>) {
                     <span class=hljs-keyword>const</span> textA = a.<span class=hljs-property>text</span>.<span class="hljs-title function_">toLowerCase</span>();
                     <span class=hljs-keyword>const</span> textB = b.<span class=hljs-property>text</span>.<span class="hljs-title function_">toLowerCase</span>();
                     <span class=hljs-keyword>return</span> textA.<span class="hljs-title function_">localeCompare</span>(textB); <span class=hljs-comment>// Ordenação alfabética A-Z</span>
                 } <span class=hljs-keyword>else</span> {
                     <span class=hljs-comment>// this.sortOrder === "desc"</span>
                     <span class=hljs-keyword>const</span> textA = a.<span class=hljs-property>text</span>.<span class="hljs-title function_">toLowerCase</span>();
                     <span class=hljs-keyword>const</span> textB = b.<span class=hljs-property>text</span>.<span class="hljs-title function_">toLowerCase</span>();
                     <span class=hljs-keyword>return</span> textB.<span class="hljs-title function_">localeCompare</span>(textA); <span class=hljs-comment>// Ordenação alfabética Z-A</span>
                 }
             });
         }

         <span class="hljs-title function_">clearHighlights</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>_, id</span>) =&gt;</span> {
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>`[id^="<span class=hljs-subst>${id}</span>-"]`</span>).<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>el</span>) =&gt;</span> {
                     el.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"click"</span>, <span class="hljs-variable language_">this</span>.<span class=hljs-property>copyHighlightText</span>);
                     el.<span class="hljs-title function_">replaceWith</span>(...el.<span class=hljs-property>childNodes</span>);
                 });
             });
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">clear</span>();
             <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class=hljs-string>"highlights"</span>);
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHighlightListUI</span>();
         }

         <span class=hljs-comment>// Este método agora é tratado por handleHideToggle e checkGlobalVisibilityState</span>
         <span class="hljs-title function_">toggleHighlightsVisibility</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(
                 <span class=hljs-string>"toggleHighlightsVisibility is deprecated. Use handleHideToggle."</span>
             );
         }

         <span class="hljs-title function_">enableDrag</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> element = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>;
             <span class=hljs-keyword>const</span> handle = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"popup-header"</span>);
             <span class=hljs-keyword>const</span> dragThreshold = <span class=hljs-number>3</span>;
             <span class=hljs-keyword>let</span> startX,
                 startY,
                 initialTop,
                 initialLeft,
                 isDragging = <span class=hljs-literal>false</span>;

             <span class=hljs-keyword>const</span> <span class="hljs-title function_">handleMouseDown</span> = (<span class=hljs-params>e</span>) =&gt; {
                 <span class=hljs-keyword>if</span> (e.<span class=hljs-property>button</span> !== <span class=hljs-number>0</span>) <span class=hljs-keyword>return</span>;
                 e.<span class="hljs-title function_">preventDefault</span>();
                 e.<span class="hljs-title function_">stopPropagation</span>();

                 element.<span class=hljs-property>style</span>.<span class=hljs-property>position</span> = <span class=hljs-string>"fixed"</span>;

                 startX = e.<span class=hljs-property>clientX</span>;
                 startY = e.<span class=hljs-property>clientY</span>;
                 initialTop = element.<span class=hljs-property>offsetTop</span>;
                 initialLeft = element.<span class=hljs-property>offsetLeft</span>;

                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"mousemove"</span>, handleMouseMove);
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"mouseup"</span>, handleMouseUp);
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"mouseleave"</span>, handleMouseUp);
             };

             <span class=hljs-keyword>const</span> <span class="hljs-title function_">handleMouseMove</span> = (<span class=hljs-params>e</span>) =&gt; {
                 <span class=hljs-keyword>const</span> dx = e.<span class=hljs-property>clientX</span> - startX;
                 <span class=hljs-keyword>const</span> dy = e.<span class=hljs-property>clientY</span> - startY;

                 <span class=hljs-keyword>if</span> (
                     !isDragging &amp;&amp;
                     (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(dx) &gt; dragThreshold || <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(dy) &gt; dragThreshold)
                 ) {
                     isDragging = <span class=hljs-literal>true</span>;
                     element.<span class=hljs-property>style</span>.<span class=hljs-property>userSelect</span> = <span class=hljs-string>"none"</span>;
                 }

                 <span class=hljs-keyword>if</span> (isDragging) {
                     e.<span class="hljs-title function_">preventDefault</span>();
                     e.<span class="hljs-title function_">stopImmediatePropagation</span>();

                     <span class=hljs-keyword>let</span> newTop = initialTop + dy;
                     <span class=hljs-keyword>let</span> newLeft = initialLeft + dx;

                     <span class=hljs-keyword>const</span> windowWidth = <span class="hljs-variable language_">window</span>.<span class=hljs-property>innerWidth</span>;
                     <span class=hljs-keyword>const</span> windowHeight = <span class="hljs-variable language_">window</span>.<span class=hljs-property>innerHeight</span>;
                     <span class=hljs-keyword>const</span> elementWidth = element.<span class=hljs-property>offsetWidth</span>;
                     <span class=hljs-keyword>const</span> elementHeight = element.<span class=hljs-property>offsetHeight</span>;

                     newTop = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class=hljs-number>0</span>, newTop);
                     newTop = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(newTop, windowHeight - elementHeight);

                     newLeft = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class=hljs-number>0</span>, newLeft);
                     newLeft = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(newLeft, windowWidth - elementWidth);

                     element.<span class=hljs-property>style</span>.<span class=hljs-property>top</span> = <span class=hljs-string>`<span class=hljs-subst>${newTop}</span>px`</span>;
                     element.<span class=hljs-property>style</span>.<span class=hljs-property>left</span> = <span class=hljs-string>`<span class=hljs-subst>${newLeft}</span>px`</span>;
                     element.<span class=hljs-property>style</span>.<span class=hljs-property>right</span> = <span class=hljs-string>"auto"</span>;
                     element.<span class=hljs-property>style</span>.<span class=hljs-property>bottom</span> = <span class=hljs-string>"auto"</span>;
                 }
             };

             <span class=hljs-keyword>const</span> <span class="hljs-title function_">handleMouseUp</span> = (<span class=hljs-params>e</span>) =&gt; {
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"mousemove"</span>, handleMouseMove);
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"mouseup"</span>, handleMouseUp);
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"mouseleave"</span>, handleMouseUp);

                 <span class=hljs-keyword>if</span> (isDragging) {
                     e.<span class="hljs-title function_">preventDefault</span>();
                     e.<span class="hljs-title function_">stopPropagation</span>();
                     element.<span class=hljs-property>style</span>.<span class=hljs-property>userSelect</span> = <span class=hljs-string>""</span>;
                     <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveUISettings</span>();
                 }
                 isDragging = <span class=hljs-literal>false</span>;
             };

             handle.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"mousedown"</span>, handleMouseDown);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>cleanupDragListeners</span> = <span class=hljs-function>() =&gt;</span> {
                 handle.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"mousedown"</span>, handleMouseDown);
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"mousemove"</span>, handleMouseMove);
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"mouseup"</span>, handleMouseUp);
                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"mouseleave"</span>, handleMouseUp);
             };
         }

         <span class="hljs-title function_">injectGlobalHighlightStyle</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> styleId = <span class=hljs-string>"highlight-style-injected"</span>;
             <span class=hljs-keyword>let</span> styleElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(styleId);
             <span class=hljs-keyword>if</span> (!styleElement) {
                 styleElement = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElementSafely</span>(<span class=hljs-string>"style"</span>, {
                     <span class=hljs-attr>id</span>: styleId
                 });
                 <span class="hljs-variable language_">document</span>.<span class=hljs-property>head</span>.<span class="hljs-title function_">appendChild</span>(styleElement);
             }
             styleElement.<span class=hljs-property>textContent</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span> ?
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span>.<span class="hljs-title function_">createHTML</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>styles</span>.<span class=hljs-property>global</span>) :
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>styles</span>.<span class=hljs-property>global</span>;
         }

         <span class="hljs-title function_">setupMutationObserver</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>mutationObserver</span> = <span class=hljs-keyword>new</span> <span class="hljs-title class_">MutationObserver</span>(<span class=hljs-function>(<span class=hljs-params>mutations</span>) =&gt;</span> {
                 mutations.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>mutation</span>) =&gt;</span> {
                     <span class=hljs-keyword>if</span> (mutation.<span class=hljs-property>type</span> === <span class=hljs-string>"childList"</span> &amp;&amp; mutation.<span class=hljs-property>addedNodes</span>.<span class=hljs-property>length</span> &gt; <span class=hljs-number>0</span>) {
                         <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>data, id</span>) =&gt;</span> {
                             <span class=hljs-keyword>if</span> (!<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>`<span class=hljs-subst>${id}</span>-0`</span>)) {
                                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleHighlightRestore</span>(id);
                             }
                         });
                     }
                 });
             });

             <span class="hljs-variable language_">this</span>.<span class=hljs-property>mutationObserver</span>.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>, {
                 <span class=hljs-attr>childList</span>: <span class=hljs-literal>true</span>,
                 <span class=hljs-attr>subtree</span>: <span class=hljs-literal>true</span>,
             });
         }

         <span class=hljs-comment>/* ========== TEMA CLARO/ESCURO ========== */</span>
         <span class="hljs-title function_">getSystemPreferredTheme</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>return</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">matchMedia</span>(<span class=hljs-string>"(prefers-color-scheme: dark)"</span>).<span class=hljs-property>matches</span> ?
                 <span class=hljs-string>"dark"</span> :
                 <span class=hljs-string>"light"</span>;
         }

         <span class="hljs-title function_">setupThemeDetection</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> prefersDarkScheme = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">matchMedia</span>(
                 <span class=hljs-string>"(prefers-color-scheme: dark)"</span>
             );
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSystemPreferredTheme</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyTheme</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span>);
             prefersDarkScheme.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"change"</span>, <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleThemeChange</span>);
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>mediaQueryList</span> = prefersDarkScheme;
         }

         <span class="hljs-title function_">handleThemeChange</span>(<span class=hljs-params>event</span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> = event.<span class=hljs-property>matches</span> ? <span class=hljs-string>"dark"</span> : <span class=hljs-string>"light"</span>;
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyTheme</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span>);
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveUISettings</span>();
             <span class=hljs-comment>// Reaplicar estilos de destaque (incluindo visibilidade)</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>highlightData, id</span>) =&gt;</span> {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">toggleHighlightVisibility</span>(id, highlightData.<span class=hljs-property>visible</span>);
             });
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHighlightListUI</span>(
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>?.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"search-input"</span>)?.<span class=hljs-property>value</span> || <span class=hljs-string>""</span>
             );
         }

         <span class="hljs-title function_">removeThemeListeners</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>mediaQueryList</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>mediaQueryList</span>.<span class="hljs-title function_">removeEventListener</span>(
                     <span class=hljs-string>"change"</span>,
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>handleThemeChange</span>
                 );
             }
         }

         <span class="hljs-title function_">applyTheme</span>(<span class=hljs-params>theme</span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> = theme;
             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>) {
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>classList</span>.<span class="hljs-title function_">remove</span>(<span class=hljs-string>"light-theme"</span>, <span class=hljs-string>"dark-theme"</span>);
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowHost</span>.<span class=hljs-property>classList</span>.<span class="hljs-title function_">add</span>(<span class=hljs-string>`<span class=hljs-subst>${theme}</span>-theme`</span>);
             }

             <span class="hljs-variable language_">this</span>.<span class=hljs-property>styles</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getStyles</span>(theme);

             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">injectGlobalHighlightStyle</span>();

             <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>) {
                 <span class=hljs-keyword>let</span> styleElement = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>"style"</span>);
                 <span class=hljs-keyword>if</span> (!styleElement) {
                     styleElement = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElementSafely</span>(<span class=hljs-string>"style"</span>);
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(styleElement);
                 }
                 styleElement.<span class=hljs-property>textContent</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span> ?
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>trustedTypesPolicy</span>.<span class="hljs-title function_">createHTML</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>styles</span>.<span class=hljs-property>popup</span>) :
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>styles</span>.<span class=hljs-property>popup</span>;
             }

             <span class=hljs-comment>// Reaplicar estilos a todos os destaques existentes com base em seu estado 'visible'</span>
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>highlights</span>.<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>highlightData, id</span>) =&gt;</span> {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">toggleHighlightVisibility</span>(id, highlightData.<span class=hljs-property>visible</span>);
             });

             <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>?.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>".highlight-list a"</span>).<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>link</span>) =&gt;</span> {
                 <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyStyles</span>(link, <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHighlightLinkStyle</span>(theme));
             });

             <span class=hljs-keyword>const</span> themeToggleBtn = <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>?.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"theme-toggle"</span>);
             <span class=hljs-keyword>if</span> (themeToggleBtn) {
                 themeToggleBtn.<span class=hljs-property>textContent</span> =
                     <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> === <span class=hljs-string>"dark"</span> ? <span class=hljs-string>"☀️ Light"</span> : <span class=hljs-string>"🌙 Dark"</span>;
             }
         }

         <span class="hljs-title function_">toggleTheme</span>(<span class=hljs-params></span>) {
             <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> = <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> === <span class=hljs-string>"light"</span> ? <span class=hljs-string>"dark"</span> : <span class=hljs-string>"light"</span>;
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyTheme</span>(<span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span>);
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveUISettings</span>();
             <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateHighlightListUI</span>(
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>shadowRoot</span>?.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>"search-input"</span>)?.<span class=hljs-property>value</span> || <span class=hljs-string>""</span>
             );
         }

         <span class="hljs-title function_">getHighlightLinkStyle</span>(<span class=hljs-params>theme</span>) {
             <span class=hljs-keyword>return</span> theme === <span class=hljs-string>"dark"</span> ?
                 <span class=hljs-string>"text-decoration:none;color:#9bc5ef;cursor:pointer;"</span> :
                 <span class=hljs-string>"text-decoration:none;color:#0645AD;cursor:pointer;"</span>;
         }

         <span class="hljs-title function_">getStyles</span>(<span class=hljs-params>theme</span>) {
             <span class=hljs-keyword>const</span> isDark = theme === <span class=hljs-string>"dark"</span>;
             <span class=hljs-keyword>return</span> {
                 <span class=hljs-attr>global</span>: <span class=hljs-string>`
          .highlight {
            background-color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#ffd700"</span> : <span class=hljs-string>"yellow"</span>}</span>;
            color: black;
            border-radius: 3px;
            padding: 0 2px;
            box-shadow: 0 0 0 1px <span class=hljs-subst>${
              isDark ? <span class=hljs-string>"rgba(255, 215, 0, 0.5)"</span> : <span class=hljs-string>"rgba(255, 255, 0, 0.5)"</span>
            }</span>;
            transition: all 0.3s ease;
            cursor: pointer;
          }

          .highlight.hidden {
            background-color: transparent !important;
            box-shadow: none !important;
          }

          .highlight.pulse-animation {
            animation: highlight-pulse 0.5s 2 !important;
            background-color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#ffd700"</span> : <span class=hljs-string>"yellow"</span>}</span> !important;
            box-shadow: 0 0 0 1px <span class=hljs-subst>${
              isDark ? <span class=hljs-string>"rgba(255, 215, 0, 0.5)"</span> : <span class=hljs-string>"rgba(255, 215, 0, 0.5)"</span>
            }</span>;
          }
          @keyframes highlight-pulse {
            0% { box-shadow: 0 0 0 0 <span class=hljs-subst>${
              isDark ? <span class=hljs-string>"rgba(255, 215, 0, 0.8)"</span> : <span class=hljs-string>"rgba(255, 215, 0, 0.8)"</span>
            }</span>; }
            50% { box-shadow: 0 0 0 15px <span class=hljs-subst>${
              isDark ? <span class=hljs-string>"rgba(255, 215, 0, 0)"</span> : <span class=hljs-string>"rgba(255, 215, 0, 0)"</span>
            }</span>; }
            100% { box-shadow: 0 0 0 0 <span class=hljs-subst>${
              isDark ? <span class=hljs-string>"rgba(255, 215, 0, 0.8)"</span> : <span class=hljs-string>"rgba(255, 215, 0, 0.8)"</span>
            }</span>; }
          }
        `</span>,
                 <span class=hljs-attr>popup</span>: <span class=hljs-string>`
          .popup {
            background: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#282c34"</span> : <span class=hljs-string>"#fffbe6"</span>}</span>;
            border: 2px solid <span class=hljs-subst>${isDark ? <span class=hljs-string>"#555"</span> : <span class=hljs-string>"#ccc"</span>}</span>;
            border-radius: 8px;
            font-family: sans-serif;
            width: 280px;
            max-width: 90vw;
            max-height: 70vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 2px 2px 12px rgba(0,0,0,0.1);
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#e0e0e0"</span> : <span class=hljs-string>"black"</span>}</span>;
          }
          .header {
            background: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#3c424a"</span> : <span class=hljs-string>"#f9e46c"</span>}</span>;
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#e0e0e0"</span> : <span class=hljs-string>"black"</span>}</span>;
            padding: 6px 10px;
            font-size: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            border-bottom: 1px solid <span class=hljs-subst>${isDark ? <span class=hljs-string>"#555"</span> : <span class=hljs-string>"#ccc"</span>}</span>;
          }
          .buttons button {
            margin-left: 4px;
            border: none;
            background: none;
            font-size: 1rem;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 3px;
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#e0e0e0"</span> : <span class=hljs-string>"black"</span>}</span>;
          }
          .buttons button:hover {
            background: <span class=hljs-subst>${isDark ? <span class=hljs-string>"rgba(255,255,255,0.1)"</span> : <span class=hljs-string>"rgba(0,0,0,0.1)"</span>}</span>;
          }
          .content {
            padding: 8px;
            overflow-y: auto;
            flex: 1;
          }
          .toolbar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            gap: 5px; /* Adicionado para espaçamento entre os botões */
          }
          .toolbar button {
            font-size: 0.75rem;
            padding: 4px 6px;
            border: 1px solid <span class=hljs-subst>${isDark ? <span class=hljs-string>"#888"</span> : <span class=hljs-string>"#888"</span>}</span>;
            background: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#444"</span> : <span class=hljs-string>"white"</span>}</span>;
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#e0e0e0"</span> : <span class=hljs-string>"black"</span>}</span>;
            border-radius: 5px;
            cursor: pointer;
            flex-grow: 1; /* Permite que os botões cresçam e preencham o espaço */
          }
          .toolbar button:hover {
            background: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#555"</span> : <span class=hljs-string>"#f0f0f0"</span>}</span>;
          }
          .search-sort-container {
            display: flex;
            gap: 5px;
            margin-bottom: 8px;
          }
          .search-wrapper {
            position: relative;
            flex: 1;
          }
          #search-input {
            width: 100%;
            padding: 4px 6px;
            padding-right: 24px;
            border: 1px solid <span class=hljs-subst>${isDark ? <span class=hljs-string>"#888"</span> : <span class=hljs-string>"#888"</span>}</span>;
            border-radius: 5px;
            font-size: 0.8rem;
            box-sizing: border-box;
            background: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#333"</span> : <span class=hljs-string>"white"</span>}</span>;
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#e0e0e0"</span> : <span class=hljs-string>"black"</span>}</span>;
          }
          .clear-search-btn {
            position: absolute;
            right: 6px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#bbb"</span> : <span class=hljs-string>"#999"</span>}</span>;
            cursor: pointer;
            font-size: 1rem;
            line-height: 1;
            padding: 0;
            display: none;
          }
          .clear-search-btn:hover {
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#eee"</span> : <span class=hljs-string>"#666"</span>}</span>;
          }
          .search-wrapper:has(#search-input:not(:placeholder-shown)) .clear-search-btn {
            display: block;
          }
          #sort-toggle {
            padding: 4px 6px;
            border: 1px solid <span class=hljs-subst>${isDark ? <span class=hljs-string>"#888"</span> : <span class=hljs-string>"#888"</span>}</span>;
            background: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#444"</span> : <span class=hljs-string>"white"</span>}</span>;
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#e0e0e0"</span> : <span class=hljs-string>"black"</span>}</span>;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            white-space: nowrap;
          }
          .instructions {
            font-size: 0.8rem;
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#aaa"</span> : <span class=hljs-string>"#666"</span>}</span>;
            margin: 4px 0;
            padding: 4px 8px;
            background: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#333"</span> : <span class=hljs-string>"#f0f0f0"</span>}</span>;
            border-radius: 4px;
            text-align: center;
          }
          .highlight-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 300px;
            overflow-y: auto;
          }
          .highlight-list li {
            margin: 4px 0;
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 4px;
            border-bottom: 1px solid <span class=hljs-subst>${isDark ? <span class=hljs-string>"#444"</span> : <span class=hljs-string>"#eee"</span>}</span>;
            overflow-x: hidden;
          }
          .highlight-list li:last-child {
            border-bottom: none;
          }
          .highlight-list input[type="checkbox"] {
            accent-color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#ffd700"</span> : <span class=hljs-string>"yellow"</span>}</span>;
          }
          .highlight-list input[type="checkbox"]:disabled {
            opacity: 0.5;
            cursor: not-allowed;
          }
          .highlight-list li.disabled {
            opacity: 0.6;
          }
          .highlight-list button {
            background: none;
            border: none;
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#ccc"</span> : <span class=hljs-string>"#999"</span>}</span>;
            font-size: 1rem;
            cursor: pointer;
            padding: 0 4px;
          }
          .highlight-list button:hover {
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#eee"</span> : <span class=hljs-string>"#666"</span>}</span>;
          }
          .highlight-list a {
            color: <span class=hljs-subst>${
              isDark ? <span class=hljs-string>"#9bc5ef"</span> : <span class=hljs-string>"#0645AD"</span>
            }</span>; /* Cor do link adaptada ao tema */
          }

          #hide-toggle.hidden-state {
            opacity: 0.7;
            background-color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#3a3f47"</span> : <span class=hljs-string>"#f0f0f0"</span>}</span>;
          }
          .highlight-manager-footer {
            padding: 8px;
            text-align: center;
            font-size: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 4px;
            flex-wrap: wrap;
            border-bottom-left-radius: 6px;
            border-bottom-right-radius: 6px;
            background: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#444"</span> : <span class=hljs-string>"#f0f0f0"</span>}</span>;
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#ddd"</span> : <span class=hljs-string>"#666"</span>}</span>;
            border-top: 1px solid <span class=hljs-subst>${isDark ? <span class=hljs-string>"#555"</span> : <span class=hljs-string>"#ccc"</span>}</span>;
          }
          .highlight-manager-footer a {
            color: <span class=hljs-subst>${isDark ? <span class=hljs-string>"#ddd"</span> : <span class=hljs-string>"#666"</span>}</span>;
            text-decoration: none;
          }
          .highlight-manager-footer a:hover {
            text-decoration: underline;
          }
        `</span>,
                 <span class=hljs-attr>feedback</span>: <span class=hljs-function>(<span class=hljs-params>type</span>) =&gt;</span> <span class=hljs-string>`
          position: fixed;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          padding: 8px 16px;
          border-radius: 4px;
          color: white;
          font-family: sans-serif;
          font-size: 14px;
          z-index: 2147483648;
          background: <span class=hljs-subst>${
            type === <span class=hljs-string>"error"</span>
              ? <span class=hljs-string>"#e74c3c"</span>
              : type === <span class=hljs-string>"warning"</span>
              ? <span class=hljs-string>"#f39c12"</span>
              : <span class=hljs-string>"#27ae60"</span>
          }</span>;
          box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        `</span>,
                 <span class=hljs-attr>shadowHost</span>: <span class=hljs-string>`
          position: fixed !important;
          top: 20px;
          right: 20px;
          max-width: 95vw;
          max-height: 95vh;
          overflow: hidden;
          resize: none !important;
          z-index: 2147483647;
        `</span>,
             };
         }

         <span class="hljs-title function_">getPopupHTML</span>(<span class=hljs-params></span>) {
             <span class=hljs-keyword>const</span> themeToggleButtonText =
                 <span class="hljs-variable language_">this</span>.<span class=hljs-property>currentTheme</span> === <span class=hljs-string>"dark"</span> ? <span class=hljs-string>"☀️ Light"</span> : <span class=hljs-string>"🌙 Dark"</span>;
             <span class=hljs-keyword>return</span> <span class=hljs-string>`
        &lt;div class="popup"&gt;
          &lt;div class="header" id="popup-header"&gt;
            &lt;strong&gt;Highlights&lt;/strong&gt;
            &lt;div class="buttons"&gt;
              &lt;button id="theme-toggle" title="Alternar Tema"&gt;<span class=hljs-subst>${themeToggleButtonText}</span>&lt;/button&gt;
              &lt;button id="btn-minimize" title="Minimizar/Maximizar"&gt;_&lt;/button&gt;
              &lt;button id="btn-close" title="Fechar"&gt;X&lt;/button&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;div class="content"&gt;
            &lt;div class="toolbar"&gt;
              &lt;button id="hide-toggle"&gt;<span class=hljs-subst>${
                // Texto inicial será definido por checkGlobalVisibilityState
                <span class="hljs-variable language_">this</span>.hidden
                  ? <span class="hljs-variable language_">this</span>.strings.showHighlights
                  : <span class="hljs-variable language_">this</span>.strings.hideHighlights
              }</span>&lt;/button&gt;
              &lt;button id="merge-highlights" title="Mesclar destaques visíveis"&gt;Merge&lt;/button&gt;
              &lt;button id="clear"&gt;Clear&lt;/button&gt;
            &lt;/div&gt;
            &lt;div class="search-sort-container"&gt;
              &lt;div class="search-wrapper"&gt;
                &lt;input type="text" id="search-input" placeholder="Search highlights..." /&gt;
                &lt;button id="clear-search" class="clear-search-btn"&gt;×&lt;/button&gt;
              &lt;/div&gt;
              &lt;button id="sort-toggle" title="Sort by text (A-Z)"&gt;↓ Creation Order&lt;/button&gt;
            &lt;/div&gt;
            &lt;p class="instructions"&gt;To highlight: Press "H" on selection or "Ctrl+Click".&lt;br&gt;To copy: "Click" on the highlight.&lt;/p&gt;
            &lt;ul class="highlight-list"&gt;&lt;/ul&gt;
          &lt;/div&gt;
          &lt;div class="highlight-manager-footer"&gt;
            &lt;span&gt;v20250816&lt;/span&gt;
            |
            &lt;a href="https://linktr.ee/magasine" target="_blank"&gt;by @magasine&lt;/a&gt;
            |
            &lt;a href="https://drive.google.com/file/d/1OBEWwQdb6QCERRy2fciS0bJxMsCaDNCR/view?usp=sharing" target="_blank"&gt;Help&lt;/a&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      `</span>;
         }

         <span class="hljs-title function_">getStableParentInfo</span>(<span class=hljs-params>node</span>) {
             <span class=hljs-keyword>let</span> current = node;
             <span class=hljs-keyword>while</span> (current &amp;&amp; current !== <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>) {
                 <span class=hljs-keyword>if</span> (current.<span class=hljs-property>id</span>) {
                     <span class=hljs-keyword>return</span> {
                         <span class=hljs-attr>selector</span>: <span class=hljs-string>`#<span class=hljs-subst>${current.id}</span>`</span>,
                         <span class=hljs-attr>element</span>: current
                     };
                 }
                 current = current.<span class=hljs-property>parentNode</span>;
             }
             <span class=hljs-keyword>return</span> {
                 <span class=hljs-attr>selector</span>: <span class=hljs-string>"body"</span>,
                 <span class=hljs-attr>element</span>: <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>
             };
         }
     }

     <span class=hljs-keyword>if</span> (
         <span class="hljs-variable language_">window</span>.<span class=hljs-property>highlightManagerInstance</span> &amp;&amp;
         <span class="hljs-variable language_">window</span>.<span class=hljs-property>highlightManagerInstance</span>.<span class="hljs-title function_">isUIVisible</span>()
     ) {
         <span class="hljs-variable language_">window</span>.<span class=hljs-property>highlightManagerInstance</span>.<span class="hljs-title function_">destroy</span>();
     } <span class=hljs-keyword>else</span> {
         <span class=hljs-keyword>new</span> <span class="hljs-title class_">HighlightManager</span>();
     }
 })();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://gist.githubusercontent.com/fmmagalhaes/2bd14c832d0d02a87837d6ceecfffd50/raw/ticketline.seats.js title="Ticketline seats" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Ticketline seats</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Ticketline seats</span></div></div></a> <a href=https://gist.githubusercontent.com/fmmagalhaes/2bd14c832d0d02a87837d6ceecfffd50/raw/ticketline.seats.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Adds seat count to Ticketline</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://gist.githubusercontent.com/fmmagalhaes/2bd14c832d0d02a87837d6ceecfffd50/raw/ticketline.seats.js rel=nofollow class=svelte-7rw83y>https://gist.githubusercontent.com/fmmagalhaes/2bd14c832d0d02a87837d6ceecfffd50/raw/ticketline.seats.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary>Show Media</summary></details> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Ticketline seats</span>
<span class=hljs-comment>// @author Francisco Magalhães</span>
<span class=hljs-comment>// @description Adds seat count to Ticketline</span>
<span class=hljs-comment>// @image https://pbs.twimg.com/profile_images/1339240167702474757/txG27Nh7_400x400.jpg</span>
<span class=hljs-comment>// @image https://pbs.twimg.com/profile_images/1574801217993195521/xAT9DkeX_400x400.jpg</span>

<span class=hljs-attr>javascript</span>: (<span class=hljs-function>() =&gt;</span> {
    <span class=hljs-keyword>const</span> table = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'#zoneSeatsMapTable'</span>);
    <span class=hljs-keyword>if</span> (!table) <span class=hljs-keyword>return</span>;

    <span class=hljs-keyword>const</span> <span class="hljs-title function_">updateSeatCount</span> = (<span class=hljs-params></span>) =&gt; {
        <span class=hljs-keyword>const</span> tbody = table.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'tbody'</span>);
        <span class=hljs-keyword>if</span> (!tbody) <span class=hljs-keyword>return</span>;

        <span class=hljs-keyword>const</span> countAvailable = tbody.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>'td a.available'</span>).<span class=hljs-property>length</span>;
        <span class=hljs-keyword>const</span> countBlocked = tbody.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>'td a.blocked'</span>).<span class=hljs-property>length</span>;

        <span class=hljs-keyword>let</span> result = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class=hljs-string>'seats-count'</span>) || <span class="hljs-title function_">createResultElement</span>();
        result.<span class=hljs-property>innerHTML</span> = <span class=hljs-string>`
            &lt;p style="color: #89A135;"&gt;Lugares disponíveis: <span class=hljs-subst>${countAvailable}</span>&lt;/p&gt;
            &lt;p style="color: #C72A33;"&gt;Lugares ocupados: <span class=hljs-subst>${countBlocked}</span>&lt;/p&gt;
        `</span>;
    };

    <span class=hljs-keyword>const</span> <span class="hljs-title function_">createResultElement</span> = (<span class=hljs-params></span>) =&gt; {
        <span class=hljs-keyword>const</span> result = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'div'</span>);
        result.<span class=hljs-property>id</span> = <span class=hljs-string>'seats-count'</span>;
        result.<span class=hljs-property>style</span>.<span class=hljs-property>fontWeight</span> = <span class=hljs-string>'bold'</span>;
        result.<span class=hljs-property>style</span>.<span class=hljs-property>textAlign</span> = <span class=hljs-string>'center'</span>;
        result.<span class=hljs-property>style</span>.<span class=hljs-property>padding</span> = <span class=hljs-string>'16px'</span>;
        table.<span class="hljs-title function_">before</span>(result);
        <span class=hljs-keyword>return</span> result;
    };

    <span class=hljs-keyword>new</span> <span class="hljs-title class_">MutationObserver</span>(<span class=hljs-function>() =&gt;</span> <span class="hljs-title function_">updateSeatCount</span>()).<span class="hljs-title function_">observe</span>(table, {
        <span class=hljs-attr>childList</span>: <span class=hljs-literal>true</span>,
        <span class=hljs-attr>subtree</span>: <span class=hljs-literal>true</span>
    });

    <span class="hljs-title function_">updateSeatCount</span>();
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href="https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20Click%20all%20radios%0A%2F%2F%20%40description%20Selects%20a%20random%20radio%20button%20from%20each%20uniquely%20named%20radio%20group.%0A%0Ajavascript%3A(()%20%3D%3E%20%7B%0A%20%20%20%20Object.values(Object.groupBy(document.querySelectorAll('input%5Btype%3D%22radio%22%5D')%2C%20e%20%3D%3E%20e.getAttribute(%22name%22))).forEach((arr)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20arr%5BMath.floor(Math.random()%20*%20arr.length)%5D%3F.click%3F.()%3B%0A%20%20%20%20%7D)%3B%0A%7D)()%3B" title="Click all radios" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Click all radios</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Click all radios</span></div></div></a> <a href="data:text/javascript,%2F%2F%20%40name%20Click%20all%20radios%0A%2F%2F%20%40description%20Selects%20a%20random%20radio%20button%20from%20each%20uniquely%20named%20radio%20group.%0A%0Ajavascript%3A(()%20%3D%3E%20%7B%0A%20%20%20%20Object.values(Object.groupBy(document.querySelectorAll('input%5Btype%3D%22radio%22%5D')%2C%20e%20%3D%3E%20e.getAttribute(%22name%22))).forEach((arr)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20arr%5BMath.floor(Math.random()%20*%20arr.length)%5D%3F.click%3F.()%3B%0A%20%20%20%20%7D)%3B%0A%7D)()%3B" class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Selects a random radio button from each uniquely named radio group.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href="data:text/javascript,%2F%2F%20%40name%20Click%20all%20radios%0A%2F%2F%20%40description%20Selects%20a%20random%20radio%20button%20from%20each%20uniquely%20named%20radio%20group.%0A%0Ajavascript%3A(()%20%3D%3E%20%7B%0A%20%20%20%20Object.values(Object.groupBy(document.querySelectorAll('input%5Btype%3D%22radio%22%5D')%2C%20e%20%3D%3E%20e.getAttribute(%22name%22))).forEach((arr)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20arr%5BMath.floor(Math.random()%20*%20arr.length)%5D%3F.click%3F.()%3B%0A%20%20%20%20%7D)%3B%0A%7D)()%3B" rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name Click all radios
// @description Selects a random radio button from each uniquely named radio group.
javascript:(() =&gt; {
 Object.values(Object.groupBy(document.querySelectorAll('input[type="radio"]'), e =&gt; e.getAttribute("name"))).forEach((arr) =&gt; {
 arr[Math.floor(Math.random() * arr.length)]?.click?.();
 });
})();</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Click all radios</span>
<span class=hljs-comment>// @description Selects a random radio button from each uniquely named radio group.</span>

<span class=hljs-attr>javascript</span>: (<span class=hljs-function>() =&gt;</span> {
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">groupBy</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>'input[type="radio"]'</span>), <span class=hljs-function><span class=hljs-params>e</span> =&gt;</span> e.<span class="hljs-title function_">getAttribute</span>(<span class=hljs-string>"name"</span>))).<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>arr</span>) =&gt;</span> {
        arr[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * arr.<span class=hljs-property>length</span>)]?.<span class=hljs-property>click</span>?.();
    });
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/userscripts/edit%20code%20blocks.user.js title="edit code blocks" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>edit code blocks</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">edit code blocks</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/userscripts/edit%20code%20blocks.user.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>make code blocks editable by adding the attribute "contenteditable"</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/userscripts/edit%20code%20blocks.user.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/userscripts/edit code blocks.user.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// ==UserScript==</span>
<span class=hljs-comment>// @name         edit code blocks</span>
<span class=hljs-comment>// @namespace    http://tampermonkey.net/</span>
<span class=hljs-comment>// @version      0.1</span>
<span class=hljs-comment>// @description  make code blocks editable by adding the attribute "contenteditable"</span>
<span class=hljs-comment>// @author       madacol</span>
<span class=hljs-comment>// @match        *://*.stackoverflow.com/*</span>
<span class=hljs-comment>// @match        *://*.askubuntu.com/*</span>
<span class=hljs-comment>// @match        *://*.stackexchange.com/*</span>
<span class=hljs-comment>// @match        *://*.github.com/*</span>
<span class=hljs-comment>// @grant        none</span>
<span class=hljs-comment>// ==/UserScript==</span>

<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>'pre'</span>).<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>code_block</span>) =&gt;</span> {
    code_block.<span class=hljs-property>contentEditable</span> = <span class=hljs-literal>true</span>;
    code_block.<span class=hljs-property>spellcheck</span> = <span class=hljs-literal>false</span>;
})</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://gist.githubusercontent.com/thde/f942bbd425a6c791c26ed83baf9bc6b1/raw/af9baf5b25917107174cda8b95e9e9f20ee0dcec/mob-mela-export.js title="mob.co.uk to Mela Exporter" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>mob.co.uk to Mela Exporter</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">mob.co.uk to Mela Exporter</span></div></div></a> <a href=https://gist.githubusercontent.com/thde/f942bbd425a6c791c26ed83baf9bc6b1/raw/af9baf5b25917107174cda8b95e9e9f20ee0dcec/mob-mela-export.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Export recipes from mob.co.uk into a .melarecipe file.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://gist.githubusercontent.com/thde/f942bbd425a6c791c26ed83baf9bc6b1/raw/af9baf5b25917107174cda8b95e9e9f20ee0dcec/mob-mela-export.js rel=nofollow class=svelte-7rw83y>https://gist.githubusercontent.com/thde/f942bbd425a6c791c26ed83baf9bc6b1/raw/af9baf5b25917107174cda8b95e9e9f20ee0dcec/mob-mela-export.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name mob.co.uk to Mela Exporter</span>
<span class=hljs-comment>// @description Export recipes from mob.co.uk into a .melarecipe file.</span>

<span class=hljs-keyword>const</span> <span class="hljs-title function_">main</span> = <span class=hljs-keyword>async</span> (<span class=hljs-params></span>) =&gt; {
    <span class=hljs-keyword>const</span> ingredients = [
        ...<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>"div.Ingredients__ingredient &gt; div"</span>),
    ];

    <span class=hljs-keyword>const</span> recipes = [
            ...<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>`script[type="application/ld+json"]`</span>),
        ]
        .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(e.<span class=hljs-property>innerText</span>))
        .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>s</span>) =&gt;</span> {
            <span class=hljs-keyword>if</span> (<span class=hljs-string>"@type"</span> <span class=hljs-keyword>in</span> s) <span class=hljs-keyword>return</span> s;
            <span class=hljs-keyword>if</span> (<span class=hljs-string>"@graph"</span> <span class=hljs-keyword>in</span> s) <span class=hljs-keyword>return</span> s[<span class=hljs-string>"@graph"</span>];
        })
        .<span class="hljs-title function_">flat</span>()
        .<span class="hljs-title function_">filter</span>(<span class=hljs-function>(<span class=hljs-params>s</span>) =&gt;</span> s[<span class=hljs-string>"@type"</span>] == <span class=hljs-string>"Recipe"</span>)
        .<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>r</span>) =&gt;</span> {
            <span class=hljs-keyword>const</span> updatedIngredients = r[<span class=hljs-string>"recipeIngredient"</span>].<span class="hljs-title function_">map</span>(
                <span class=hljs-function>(<span class=hljs-params>ingredient, index</span>) =&gt;</span> {
                    <span class=hljs-keyword>const</span> amount = ingredients[index].<span class=hljs-property>firstChild</span>.<span class=hljs-property>textContent</span>;
                    <span class=hljs-keyword>return</span> [amount, ingredient].<span class="hljs-title function_">join</span>(<span class=hljs-string>" "</span>);
                },
            );
            r[<span class=hljs-string>"recipeIngredient"</span>] = updatedIngredients;
            <span class=hljs-keyword>return</span> r;
        });

    <span class=hljs-keyword>if</span> (recipes.<span class=hljs-property>length</span> == <span class=hljs-number>0</span>) {
        <span class="hljs-title function_">alert</span>(<span class=hljs-string>"No recipes have been found!"</span>);
        <span class=hljs-keyword>return</span>;
    }

    recipes.<span class="hljs-title function_">forEach</span>(<span class=hljs-keyword>async</span> (r) =&gt; {
        <span class="hljs-title function_">download</span>(
            <span class=hljs-string>`<span class=hljs-subst>${r.name}</span>.melarecipe`</span>,
            <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class=hljs-keyword>await</span> <span class="hljs-title function_">convertRecipeToMela</span>(r)),
        );
    });
};

<span class=hljs-keyword>const</span> <span class="hljs-title function_">ingredientsMarkdown</span> = (<span class=hljs-params></span>) =&gt; [
    ...<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>".Ingredients__ingredient"</span>).<span class=hljs-property>parentElement</span>
    .<span class=hljs-property>childNodes</span>,
].<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
    <span class=hljs-keyword>if</span> (!e.<span class=hljs-property>className</span>.<span class="hljs-title function_">includes</span>(<span class=hljs-string>"Ingredients__ingredient"</span>)) {
        <span class=hljs-keyword>return</span> <span class=hljs-string>"# "</span> + e.<span class=hljs-property>textContent</span>.<span class="hljs-title function_">trim</span>();
    }

    <span class=hljs-keyword>return</span> [
            e.<span class=hljs-property>firstChild</span>.<span class=hljs-property>firstChild</span>.<span class=hljs-property>textContent</span>.<span class="hljs-title function_">trim</span>(),
            e.<span class=hljs-property>firstChild</span>.<span class=hljs-property>lastChild</span>.<span class=hljs-property>textContent</span>.<span class="hljs-title function_">trim</span>(),
        ]
        .<span class="hljs-title function_">filter</span>(<span class=hljs-function>(<span class=hljs-params>s</span>) =&gt;</span> s != <span class=hljs-string>""</span>)
        .<span class="hljs-title function_">join</span>(<span class=hljs-string>" "</span>);
});

<span class=hljs-comment>// https://mela.recipes/fileformat/index.html</span>
<span class=hljs-keyword>async</span> <span class=hljs-keyword>function</span> <span class="hljs-title function_">convertRecipeToMela</span>(<span class=hljs-params>recipe</span>) {
    <span class=hljs-keyword>const</span> {
        name,
        description,
        recipeYield,
        cookTime,
        prepTime,
        totalTime,
        recipeIngredient,
        recipeInstructions,
        image,
    } = recipe;

    <span class=hljs-comment>// Creating the Mela Recipe JSON format</span>
    <span class=hljs-keyword>return</span> {
        <span class=hljs-attr>id</span>: <span class="hljs-variable language_">window</span>.<span class=hljs-property>location</span>.<span class=hljs-property>host</span> + <span class="hljs-variable language_">window</span>.<span class=hljs-property>location</span>.<span class=hljs-property>pathname</span>,
        <span class=hljs-attr>title</span>: name,
        <span class=hljs-attr>text</span>: description,
        <span class=hljs-attr>images</span>: [<span class=hljs-keyword>await</span> <span class="hljs-title function_">fetchToBase64</span>(image)],
        <span class=hljs-attr>categories</span>: recipe.<span class=hljs-property>recipeCategory</span>.<span class="hljs-title function_">split</span>(<span class=hljs-string>", "</span>).<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>cat</span>) =&gt;</span> cat.<span class="hljs-title function_">trim</span>()),
        <span class=hljs-attr>yield</span>: <span class=hljs-string>`<span class=hljs-subst>${recipeYield}</span> servings`</span>,
        <span class=hljs-attr>prepTime</span>: <span class="hljs-title function_">formatTime</span>(prepTime),
        <span class=hljs-attr>cookTime</span>: <span class="hljs-title function_">formatTime</span>(cookTime),
        <span class=hljs-attr>totalTime</span>: <span class="hljs-title function_">formatTime</span>(totalTime),
        <span class=hljs-attr>ingredients</span>: <span class="hljs-title function_">ingredientsMarkdown</span>().<span class="hljs-title function_">join</span>(<span class=hljs-string>"\n"</span>),
        <span class=hljs-comment>//ingredients: recipeIngredient.join("\n"),</span>
        <span class=hljs-attr>instructions</span>: recipeInstructions.<span class="hljs-title function_">map</span>(<span class=hljs-function>(<span class=hljs-params>step</span>) =&gt;</span> step.<span class=hljs-property>text</span>).<span class="hljs-title function_">join</span>(<span class=hljs-string>"\n"</span>),
        <span class=hljs-attr>notes</span>: <span class=hljs-string>""</span>, <span class=hljs-comment>// Placeholder for notes</span>
        <span class=hljs-attr>link</span>: <span class="hljs-variable language_">window</span>.<span class=hljs-property>location</span>.<span class=hljs-property>href</span>,
    };
}

<span class=hljs-keyword>const</span> <span class="hljs-title function_">formatTime</span> = (<span class=hljs-params>time</span>) =&gt; {
    <span class=hljs-keyword>if</span> (!time) <span class=hljs-keyword>return</span> <span class=hljs-string>""</span>;
    <span class=hljs-keyword>const</span> match = time.<span class="hljs-title function_">match</span>(<span class=hljs-regexp>/PT(\d+)([HM])/</span>);
    <span class=hljs-keyword>if</span> (match) {
        <span class=hljs-keyword>return</span> <span class=hljs-string>`<span class=hljs-subst>${match[<span class=hljs-number>1</span>]}</span> <span class=hljs-subst>${match[<span class=hljs-number>2</span>] === <span class=hljs-string>"H"</span> ? <span class=hljs-string>"hours"</span> : <span class=hljs-string>"min"</span>}</span>`</span>;
    }
    <span class=hljs-keyword>return</span> <span class=hljs-string>""</span>;
};

<span class=hljs-keyword>const</span> <span class="hljs-title function_">fetchToBase64</span> = (<span class=hljs-params>url</span>) =&gt;
    <span class="hljs-title function_">fetch</span>(url)
    .<span class="hljs-title function_">then</span>(<span class=hljs-function>(<span class=hljs-params>response</span>) =&gt;</span> response.<span class="hljs-title function_">blob</span>())
    .<span class="hljs-title function_">then</span>(
        <span class=hljs-function>(<span class=hljs-params>blob</span>) =&gt;</span>
        <span class=hljs-keyword>new</span> <span class="hljs-title class_">Promise</span>(<span class=hljs-function>(<span class=hljs-params>resolve, reject</span>) =&gt;</span> {
            <span class=hljs-keyword>const</span> reader = <span class=hljs-keyword>new</span> <span class="hljs-title class_">FileReader</span>();
            reader.<span class=hljs-property>onloadend</span> = <span class=hljs-function>() =&gt;</span> <span class="hljs-title function_">resolve</span>(reader.<span class=hljs-property>result</span>);
            reader.<span class=hljs-property>onerror</span> = reject;
            reader.<span class="hljs-title function_">readAsDataURL</span>(blob);
        }),
    )
    .<span class="hljs-title function_">then</span>(<span class=hljs-function>(<span class=hljs-params>u</span>) =&gt;</span> u.<span class="hljs-title function_">replace</span>(<span class=hljs-string>"data:"</span>, <span class=hljs-string>""</span>).<span class="hljs-title function_">replace</span>(<span class=hljs-regexp>/^.+,/</span>, <span class=hljs-string>""</span>));

<span class=hljs-keyword>const</span> <span class="hljs-title function_">download</span> = (<span class=hljs-params>filename, text</span>) =&gt; {
    <span class=hljs-keyword>const</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"a"</span>);
    element.<span class="hljs-title function_">setAttribute</span>(
        <span class=hljs-string>"href"</span>,
        <span class=hljs-string>"data:text/json;charset=utf-8,"</span> + <span class=hljs-built_in>encodeURIComponent</span>(text),
    );
    element.<span class="hljs-title function_">setAttribute</span>(<span class=hljs-string>"download"</span>, filename);

    element.<span class=hljs-property>style</span>.<span class=hljs-property>display</span> = <span class=hljs-string>"none"</span>;
    <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(element);

    element.<span class="hljs-title function_">click</span>();

    <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">removeChild</span>(element);
};

<span class="hljs-title function_">main</span>();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#data:text/javascript, title=Javascript, data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Javascript,</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Javascript,</span></div></div></a> <a href=data:text/javascript, class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=data:text/javascript, rel=nofollow class=svelte-7rw83y>data:text/javascript,</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript></code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/form%20filler.js title="Form Restorer" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Form Restorer</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Form Restorer</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/form%20filler.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>This script stores the values of all form fields in localStorage. When the script is run again, it will ask the user to restore or replace them with the new ones.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/form%20filler.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/form filler.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Form Restorer</span>
<span class=hljs-comment>// @description This script stores the values of all form fields in localStorage. When the script is run again, it will ask the user to restore or replace them with the new ones.</span>

<span class=hljs-keyword>const</span> <span class="hljs-title function_">saveFormValues</span> = (<span class=hljs-params></span>) =&gt; {
    <span class=hljs-keyword>const</span> formData = [];
    [...<span class="hljs-variable language_">document</span>.<span class=hljs-property>forms</span>].<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>form, formIndex</span>) =&gt;</span> {
        formData[formIndex] = [];
        [...form.<span class=hljs-property>elements</span>].<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>element, elementIndex</span>) =&gt;</span> {
            <span class=hljs-keyword>const</span> type = element.<span class=hljs-property>type</span>.<span class="hljs-title function_">toLowerCase</span>();
            <span class=hljs-keyword>let</span> value = <span class=hljs-literal>null</span>;
            <span class=hljs-keyword>switch</span> (type) {
                <span class=hljs-keyword>case</span> <span class=hljs-string>'text'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'password'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'textarea'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'email'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'date'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'number'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'select-one'</span>:
                    value = element.<span class=hljs-property>value</span>;
                    <span class=hljs-keyword>break</span>;
                <span class=hljs-keyword>case</span> <span class=hljs-string>'checkbox'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'radio'</span>:
                    value = element.<span class=hljs-property>checked</span>;
                    <span class=hljs-keyword>break</span>;
                <span class=hljs-keyword>case</span> <span class=hljs-string>'select-multiple'</span>:
                    value = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(element.<span class=hljs-property>options</span>).<span class="hljs-title function_">map</span>(<span class=hljs-function><span class=hljs-params>option</span> =&gt;</span> option.<span class=hljs-property>selected</span>);
                    <span class=hljs-keyword>break</span>;
                <span class=hljs-attr>default</span>:
                    <span class=hljs-keyword>return</span>;
            }
            formData[formIndex][elementIndex] = {
                type,
                value
            };
        });
    });
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class=hljs-string>`_FormFiller_<span class=hljs-subst>${location.pathname}</span>`</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(formData));
};

<span class=hljs-keyword>const</span> <span class="hljs-title function_">loadFormValues</span> = (<span class=hljs-params>storedData</span>) =&gt; {
    <span class=hljs-keyword>if</span> (!storedData) <span class=hljs-keyword>return</span>;
    [...<span class="hljs-variable language_">document</span>.<span class=hljs-property>forms</span>].<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>form, formIndex</span>) =&gt;</span> {
        <span class=hljs-keyword>if</span> (!storedData[formIndex]) <span class=hljs-keyword>return</span>;
        [...form.<span class=hljs-property>elements</span>].<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>element, elementIndex</span>) =&gt;</span> {
            <span class=hljs-keyword>const</span> {
                type,
                value
            } = storedData[formIndex][elementIndex] || {};
            <span class=hljs-keyword>switch</span> (type) {
                <span class=hljs-keyword>case</span> <span class=hljs-string>'text'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'password'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'textarea'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'email'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'date'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'number'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'select-one'</span>:
                    element.<span class=hljs-property>value</span> = value;
                    <span class=hljs-keyword>break</span>;
                <span class=hljs-keyword>case</span> <span class=hljs-string>'checkbox'</span>:
                <span class=hljs-keyword>case</span> <span class=hljs-string>'radio'</span>:
                    element.<span class=hljs-property>checked</span> = value;
                    <span class=hljs-keyword>break</span>;
                <span class=hljs-keyword>case</span> <span class=hljs-string>'select-multiple'</span>:
                    <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(element.<span class=hljs-property>options</span>).<span class="hljs-title function_">forEach</span>(<span class=hljs-function>(<span class=hljs-params>option, idx</span>) =&gt;</span> {
                        option.<span class=hljs-property>selected</span> = value[idx];
                    });
                    <span class=hljs-keyword>break</span>;
            }
        });
    });
};

<span class=hljs-keyword>function</span> <span class="hljs-title function_">askUser</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>const</span> overlay = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'div'</span>);
    overlay.<span class=hljs-property>innerHTML</span> = <span class=hljs-comment>/*html*/</span> <span class=hljs-string>`
        &lt;div&gt;
            &lt;h2&gt;Form Filler&lt;/h2&gt;
            &lt;p&gt;Would you like to &lt;strong&gt;restore&lt;/strong&gt; or &lt;strong&gt;save&lt;/strong&gt; the form values?&lt;/p&gt;
            &lt;div class="buttons"&gt;
                &lt;button id="restore"&gt;Restore&lt;/button&gt;
                &lt;button id="save"&gt;Save&lt;/button&gt;
            &lt;/div&gt;
            &lt;h3&gt;Stored data:&lt;/h3&gt;
            &lt;pre&gt;<span class=hljs-subst>${<span class=hljs-built_in>JSON</span>.stringify(storedData, <span class=hljs-literal>null</span>, <span class=hljs-number>2</span>)}</span>&lt;/pre&gt;
        &lt;/div&gt;
    `</span>;
    overlay.<span class=hljs-property>style</span> = <span class=hljs-string>`
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        overflow: auto;
    `</span>;
    overlay.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'&amp;&gt; div'</span>).<span class=hljs-property>style</span> = <span class=hljs-string>`
        display: flex;
        flex-direction: column;
        max-height: 100%;
        max-width: 1000px;
        overflow: auto;
        background-color: white;
        padding: 0 20px;
        border-radius: 10px;
        margin: auto;
        color: black;
    `</span>;
    overlay.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'.buttons'</span>).<span class=hljs-property>style</span> = <span class=hljs-string>`
        display: flex;
        justify-content: space-around;
    `</span>;
    overlay.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>'button'</span>).<span class="hljs-title function_">forEach</span>(<span class=hljs-function><span class=hljs-params>button</span> =&gt;</span> {
        button.<span class=hljs-property>style</span> = <span class=hljs-string>`
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            background-color: #007bff;
            color: white;
        `</span>;
    });
    overlay.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'pre'</span>).<span class=hljs-property>style</span> = <span class=hljs-string>`
        white-space: pre-wrap;
        word-wrap: break-word;
        max-height: 80vh;
        min-height: 100px;
        overflow: auto;
    `</span>;
    <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(overlay);

    overlay.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'#restore'</span>).<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>'click'</span>, <span class=hljs-function>() =&gt;</span> {
        <span class="hljs-title function_">loadFormValues</span>(storedData);
        overlay.<span class="hljs-title function_">remove</span>();
    });

    overlay.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>'#save'</span>).<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>'click'</span>, <span class=hljs-function>() =&gt;</span> {
        <span class="hljs-title function_">saveFormValues</span>();
        overlay.<span class="hljs-title function_">remove</span>();
    });

    overlay.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>'click'</span>, <span class=hljs-function>(<span class=hljs-params>e</span>) =&gt;</span> {
        <span class=hljs-keyword>if</span> (e.<span class=hljs-property>target</span> === overlay) {
            overlay.<span class="hljs-title function_">remove</span>();
        }
    });
}

<span class=hljs-comment>// Detect if there are stored values and ask the user what to do</span>
<span class=hljs-keyword>const</span> storedData = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class=hljs-string>`_FormFiller_<span class=hljs-subst>${location.pathname}</span>`</span>));
<span class=hljs-keyword>if</span> (storedData) {
    <span class=hljs-comment>// show in overlay the choices to restore or save</span>
    <span class="hljs-title function_">askUser</span>();
} <span class=hljs-keyword>else</span> {
    <span class="hljs-title function_">saveFormValues</span>(); <span class=hljs-comment>// No stored data, save current form values</span>
}</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/No%20Hijack.js title="No Hijack" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>No Hijack</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">No Hijack</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/No%20Hijack.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Blocks common event hijacking techniques, like disabling paste, right-click, text selection, and some keyboard shortcuts. Run the bookmarklet again to undo.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/No%20Hijack.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/No Hijack.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name No Hijack</span>
<span class=hljs-comment>// @description Blocks common event hijacking techniques, like disabling paste, right-click, text selection, and some keyboard shortcuts. Run the bookmarklet again to undo.</span>

<span class=hljs-attr>javascript</span>: (<span class=hljs-function>() =&gt;</span> {
    <span class=hljs-comment>/* Undo the block */</span>
    <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">window</span>.<span class=hljs-property>_NoHijackHandlers</span>) {
        <span class=hljs-keyword>for</span> (<span class=hljs-keyword>const</span> [eventName, handler] <span class=hljs-keyword>of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(<span class="hljs-variable language_">window</span>.<span class=hljs-property>_NoHijackHandlers</span>)) {
            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(eventName, handler, <span class=hljs-literal>true</span>);
        }
        <span class="hljs-variable language_">window</span>.<span class=hljs-property>_NoHijackHandlers</span> = <span class=hljs-literal>null</span>;
        <span class=hljs-keyword>return</span>;
    }

    <span class=hljs-comment>/* Stop events from propagating */</span>
    <span class=hljs-keyword>const</span> <span class="hljs-title function_">block</span> = e =&gt; e.<span class="hljs-title function_">stopImmediatePropagation</span>();
    <span class="hljs-variable language_">window</span>.<span class=hljs-property>_NoHijackHandlers</span> = {
        <span class=hljs-attr>copy</span>: block,
        <span class=hljs-attr>cut</span>: block,
        <span class=hljs-attr>paste</span>: block,
        <span class=hljs-attr>contextmenu</span>: block,
        <span class=hljs-attr>selectstart</span>: block,
        <span class=hljs-attr>keydown</span>: <span class=hljs-function><span class=hljs-params>e</span> =&gt;</span> {
            <span class=hljs-keyword>if</span> (e.<span class=hljs-property>altKey</span> &amp;&amp; e.<span class=hljs-property>key</span>.<span class="hljs-title function_">match</span>(<span class=hljs-regexp>/[0-9]/</span>)) {
                e.<span class="hljs-title function_">stopImmediatePropagation</span>();
            }
        }
    };
    <span class=hljs-keyword>for</span> (<span class=hljs-keyword>const</span> [eventName, handler] <span class=hljs-keyword>of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(<span class="hljs-variable language_">window</span>.<span class=hljs-property>_NoHijackHandlers</span>)) {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(eventName, handler, <span class=hljs-literal>true</span>);
    }
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/kill%20sticky.js title="Kill Sticky" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Kill Sticky</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Kill Sticky</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/kill%20sticky.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Overrides sticky, fixed, and overflowing elements.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/kill%20sticky.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/kill sticky.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Kill Sticky</span>
<span class=hljs-comment>// @description Overrides sticky, fixed, and overflowing elements.</span>

<span class=hljs-attr>javascript</span>: (<span class=hljs-function>() =&gt;</span> {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class=hljs-string>'*'</span>).<span class="hljs-title function_">forEach</span>(<span class=hljs-function><span class=hljs-params>element</span> =&gt;</span> {
        <span class=hljs-keyword>const</span> style = <span class="hljs-title function_">getComputedStyle</span>(element);

        <span class=hljs-comment>// Remove sticky and fixed positioning</span>
        <span class=hljs-keyword>switch</span> (style.<span class=hljs-property>position</span>) {
            <span class=hljs-keyword>case</span> <span class=hljs-string>'sticky'</span>:
            <span class=hljs-keyword>case</span> <span class=hljs-string>'fixed'</span>:
                element.<span class=hljs-property>style</span>.<span class="hljs-title function_">setProperty</span>(<span class=hljs-string>'position'</span>, <span class=hljs-string>'static'</span>, <span class=hljs-string>'important'</span>);
                <span class=hljs-keyword>break</span>;
        }

        <span class=hljs-comment>// Remove overflow</span>
        <span class=hljs-keyword>switch</span> (style.<span class=hljs-property>overflow</span>) {
            <span class=hljs-keyword>case</span> <span class=hljs-string>'hidden'</span>:
            <span class=hljs-keyword>case</span> <span class=hljs-string>'scroll'</span>:
            <span class=hljs-keyword>case</span> <span class=hljs-string>'auto'</span>:
                element.<span class=hljs-property>style</span>.<span class="hljs-title function_">setProperty</span>(<span class=hljs-string>'overflow'</span>, <span class=hljs-string>'visible'</span>, <span class=hljs-string>'important'</span>);
                <span class=hljs-keyword>break</span>;
        }
    });
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href="https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20Open%20npm%20in%20Socket.dev%0A%0Ajavascript%3Alocation.href%3Ddocument.location.href.replace(%22www.npmjs.com%2F%22%2C%20'socket.dev%2Fnpm%2F')%3B" title="Open npm in Socket.dev" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Open npm in Socket.dev</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Open npm in Socket.dev</span></div></div></a> <a href="data:text/javascript,%2F%2F%20%40name%20Open%20npm%20in%20Socket.dev%0A%0Ajavascript%3Alocation.href%3Ddocument.location.href.replace(%22www.npmjs.com%2F%22%2C%20'socket.dev%2Fnpm%2F')%3B" class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href="data:text/javascript,%2F%2F%20%40name%20Open%20npm%20in%20Socket.dev%0A%0Ajavascript%3Alocation.href%3Ddocument.location.href.replace(%22www.npmjs.com%2F%22%2C%20'socket.dev%2Fnpm%2F')%3B" rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name Open npm in Socket.dev
javascript:location.href=document.location.href.replace("www.npmjs.com/", 'socket.dev/npm/');</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Open npm in Socket.dev</span>

<span class=hljs-attr>javascript</span>: location.<span class=hljs-property>href</span> = <span class="hljs-variable language_">document</span>.<span class=hljs-property>location</span>.<span class=hljs-property>href</span>.<span class="hljs-title function_">replace</span>(<span class=hljs-string>"www.npmjs.com/"</span>, <span class=hljs-string>'socket.dev/npm/'</span>);</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href="https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20IMDb%20or%20TMDB%20title%20in%20Letterboxd%0A%2F%2F%20%40description%20When%20used%20on%20a%20film's%20page%20on%20imdb.com%20or%20themoviedb.org%2C%20the%20Letterboxd%20page%20for%20that%20film%20will%20open%20in%20a%20new%20tabl%0A%0A(function()%20%7B%0A%09const%20url%20%3D%20window.location.href%3B%0A%09const%20imdbMatch%20%3D%20url.match(%2F%5Ehttps%3F%3A%5C%2F%5C%2F(%3F%3Awww%5C.)%3Fimdb%5C.com%5C%2Ftitle%5C%2F(tt%5Cd%2B)%2F)%3B%0A%09const%20tmdbMatch%20%3D%20url.match(%2F%5Ehttps%3F%3A%5C%2F%5C%2F(%3F%3Awww%5C.)%3Fthemoviedb%5C.org%5C%2Fmovie%5C%2F(%5Cd%2B)%2F)%3B%0A%09if%20(imdbMatch)%20%7B%0A%09%09const%20imdbID%20%3D%20imdbMatch%5B1%5D%3B%0A%09%09window.open(%60https%3A%2F%2Fletterboxd.com%2Fimdb%2F%24%7BimdbID%7D%60%2C%20'_blank')%3B%0A%09%7D%20else%20if%20(tmdbMatch)%20%7B%0A%09%09const%20tmdbID%20%3D%20tmdbMatch%5B1%5D%3B%0A%09%09window.open(%60https%3A%2F%2Fletterboxd.com%2Ftmdb%2F%24%7BtmdbID%7D%60%2C%20'_blank')%3B%0A%09%7D%20else%20%7B%0A%09%09alert(%22Only%20IMDb%20and%20TMDb%20*movie*%20pages%20are%20supported%20by%20this%20bookmarklet.%22)%3B%0A%09%7D%0A%7D)()%3B" title="IMDb or TMDB title in Letterboxd" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>IMDb or TMDB title in Letterboxd</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">IMDb or TMDB title in Letterboxd</span></div></div></a> <a href="data:text/javascript,%2F%2F%20%40name%20IMDb%20or%20TMDB%20title%20in%20Letterboxd%0A%2F%2F%20%40description%20When%20used%20on%20a%20film's%20page%20on%20imdb.com%20or%20themoviedb.org%2C%20the%20Letterboxd%20page%20for%20that%20film%20will%20open%20in%20a%20new%20tabl%0A%0A(function()%20%7B%0A%09const%20url%20%3D%20window.location.href%3B%0A%09const%20imdbMatch%20%3D%20url.match(%2F%5Ehttps%3F%3A%5C%2F%5C%2F(%3F%3Awww%5C.)%3Fimdb%5C.com%5C%2Ftitle%5C%2F(tt%5Cd%2B)%2F)%3B%0A%09const%20tmdbMatch%20%3D%20url.match(%2F%5Ehttps%3F%3A%5C%2F%5C%2F(%3F%3Awww%5C.)%3Fthemoviedb%5C.org%5C%2Fmovie%5C%2F(%5Cd%2B)%2F)%3B%0A%09if%20(imdbMatch)%20%7B%0A%09%09const%20imdbID%20%3D%20imdbMatch%5B1%5D%3B%0A%09%09window.open(%60https%3A%2F%2Fletterboxd.com%2Fimdb%2F%24%7BimdbID%7D%60%2C%20'_blank')%3B%0A%09%7D%20else%20if%20(tmdbMatch)%20%7B%0A%09%09const%20tmdbID%20%3D%20tmdbMatch%5B1%5D%3B%0A%09%09window.open(%60https%3A%2F%2Fletterboxd.com%2Ftmdb%2F%24%7BtmdbID%7D%60%2C%20'_blank')%3B%0A%09%7D%20else%20%7B%0A%09%09alert(%22Only%20IMDb%20and%20TMDb%20*movie*%20pages%20are%20supported%20by%20this%20bookmarklet.%22)%3B%0A%09%7D%0A%7D)()%3B" class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>When used on a film's page on imdb.com or themoviedb.org, the Letterboxd page for that film will open in a new tabl</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href="data:text/javascript,%2F%2F%20%40name%20IMDb%20or%20TMDB%20title%20in%20Letterboxd%0A%2F%2F%20%40description%20When%20used%20on%20a%20film's%20page%20on%20imdb.com%20or%20themoviedb.org%2C%20the%20Letterboxd%20page%20for%20that%20film%20will%20open%20in%20a%20new%20tabl%0A%0A(function()%20%7B%0A%09const%20url%20%3D%20window.location.href%3B%0A%09const%20imdbMatch%20%3D%20url.match(%2F%5Ehttps%3F%3A%5C%2F%5C%2F(%3F%3Awww%5C.)%3Fimdb%5C.com%5C%2Ftitle%5C%2F(tt%5Cd%2B)%2F)%3B%0A%09const%20tmdbMatch%20%3D%20url.match(%2F%5Ehttps%3F%3A%5C%2F%5C%2F(%3F%3Awww%5C.)%3Fthemoviedb%5C.org%5C%2Fmovie%5C%2F(%5Cd%2B)%2F)%3B%0A%09if%20(imdbMatch)%20%7B%0A%09%09const%20imdbID%20%3D%20imdbMatch%5B1%5D%3B%0A%09%09window.open(%60https%3A%2F%2Fletterboxd.com%2Fimdb%2F%24%7BimdbID%7D%60%2C%20'_blank')%3B%0A%09%7D%20else%20if%20(tmdbMatch)%20%7B%0A%09%09const%20tmdbID%20%3D%20tmdbMatch%5B1%5D%3B%0A%09%09window.open(%60https%3A%2F%2Fletterboxd.com%2Ftmdb%2F%24%7BtmdbID%7D%60%2C%20'_blank')%3B%0A%09%7D%20else%20%7B%0A%09%09alert(%22Only%20IMDb%20and%20TMDb%20*movie*%20pages%20are%20supported%20by%20this%20bookmarklet.%22)%3B%0A%09%7D%0A%7D)()%3B" rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name IMDb or TMDB title in Letterboxd
// @description When used on a film's page on imdb.com or themoviedb.org, the Letterboxd page for that film will open in a new tabl
(function() {
 const url = window.location.href;
 const imdbMatch = url.match(/^https?:\/\/(?:www\.)?imdb\.com\/title\/(tt\d+)/);
 const tmdbMatch = url.match(/^https?:\/\/(?:www\.)?themoviedb\.org\/movie\/(\d+)/);
 if (imdbMatch) {
 const imdbID = imdbMatch[1];
 window.open(`https://letterboxd.com/imdb/${imdbID}`, '_blank');
 } else if (tmdbMatch) {
 const tmdbID = tmdbMatch[1];
 window.open(`https://letterboxd.com/tmdb/${tmdbID}`, '_blank');
 } else {
 alert("Only IMDb and TMDb *movie* pages are supported by this bookmarklet.");
 }
})();</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name IMDb or TMDB title in Letterboxd</span>
<span class=hljs-comment>// @description When used on a film's page on imdb.com or themoviedb.org, the Letterboxd page for that film will open in a new tabl</span>

(<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>const</span> url = <span class="hljs-variable language_">window</span>.<span class=hljs-property>location</span>.<span class=hljs-property>href</span>;
    <span class=hljs-keyword>const</span> imdbMatch = url.<span class="hljs-title function_">match</span>(<span class=hljs-regexp>/^https?:\/\/(?:www\.)?imdb\.com\/title\/(tt\d+)/</span>);
    <span class=hljs-keyword>const</span> tmdbMatch = url.<span class="hljs-title function_">match</span>(<span class=hljs-regexp>/^https?:\/\/(?:www\.)?themoviedb\.org\/movie\/(\d+)/</span>);
    <span class=hljs-keyword>if</span> (imdbMatch) {
        <span class=hljs-keyword>const</span> imdbID = imdbMatch[<span class=hljs-number>1</span>];
        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">open</span>(<span class=hljs-string>`https://letterboxd.com/imdb/<span class=hljs-subst>${imdbID}</span>`</span>, <span class=hljs-string>'_blank'</span>);
    } <span class=hljs-keyword>else</span> <span class=hljs-keyword>if</span> (tmdbMatch) {
        <span class=hljs-keyword>const</span> tmdbID = tmdbMatch[<span class=hljs-number>1</span>];
        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">open</span>(<span class=hljs-string>`https://letterboxd.com/tmdb/<span class=hljs-subst>${tmdbID}</span>`</span>, <span class=hljs-string>'_blank'</span>);
    } <span class=hljs-keyword>else</span> {
        <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Only IMDb and TMDb *movie* pages are supported by this bookmarklet."</span>);
    }
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Js%20to%20Bookmarklet.js title="Js to Bookmarklet" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Js to Bookmarklet</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Js to Bookmarklet</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Js%20to%20Bookmarklet.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Show a bookmarklet link with the selected JavaScript code.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Js%20to%20Bookmarklet.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/Js to Bookmarklet.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Js to Bookmarklet</span>
<span class=hljs-comment>// @description Show a bookmarklet link with the selected JavaScript code.</span>

(<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-comment>// Get selected text</span>
    <span class=hljs-keyword>const</span> selection = <span class="hljs-variable language_">window</span>.<span class=hljs-property>getSelection</span> ? <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>().<span class="hljs-title function_">toString</span>() : <span class="hljs-variable language_">document</span>.<span class=hljs-property>selection</span>.<span class="hljs-title function_">createRange</span>().<span class=hljs-property>text</span>;
    <span class=hljs-keyword>if</span> (!selection) <span class=hljs-keyword>return</span> <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Please select some JavaScript code."</span>);

    <span class=hljs-comment>// validate it is valid javascript code</span>
    <span class=hljs-keyword>try</span> {
        <span class=hljs-keyword>new</span> <span class="hljs-title class_">Function</span>(selection);
    } <span class=hljs-keyword>catch</span> (e) {
        <span class=hljs-keyword>return</span> <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Invalid JavaScript code selected."</span>);
    }

    <span class=hljs-comment>// Create bookmarklet link</span>
    <span class=hljs-keyword>const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'a'</span>);
    a.<span class=hljs-property>href</span> = <span class=hljs-string>`javascript:(()=&gt;{<span class=hljs-subst>${<span class=hljs-built_in>encodeURIComponent</span>(selection)}</span>})();`</span>;
    a.<span class=hljs-property>textContent</span> = <span class=hljs-string>'Drag to bookmarks bar to save.'</span>;

    <span class=hljs-comment>// Show link in a modal</span>
    <span class="hljs-title function_">showModal</span>(a);

    <span class=hljs-keyword>function</span> <span class="hljs-title function_">showModal</span>(<span class=hljs-params>HtmlContent</span>) {
        <span class=hljs-keyword>const</span> modal = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'dialog'</span>);
        modal.<span class="hljs-title function_">appendChild</span>(<span class="hljs-title class_">HtmlContent</span>);
        <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(modal);
        modal.<span class="hljs-title function_">showModal</span>();
        <span class=hljs-comment>// close modal when clicking outside its content</span>
        modal.<span class=hljs-property>onclick</span> = <span class=hljs-function><span class=hljs-params>e</span> =&gt;</span> {
            <span class=hljs-keyword>if</span> (e.<span class=hljs-property>target</span> === modal) modal.<span class="hljs-title function_">remove</span>();
        };
    }
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://gist.githubusercontent.com/magasine/ef7f1767a9044beae406bde315e513cc/raw/e0ecb4b3155b514277158f9af458415c5ecf41b9/ClickAndDownload.js title=ClickAndDownload data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>ClickAndDownload</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">ClickAndDownload</span></div></div></a> <a href=https://gist.githubusercontent.com/magasine/ef7f1767a9044beae406bde315e513cc/raw/e0ecb4b3155b514277158f9af458415c5ecf41b9/ClickAndDownload.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://gist.githubusercontent.com/magasine/ef7f1767a9044beae406bde315e513cc/raw/e0ecb4b3155b514277158f9af458415c5ecf41b9/ClickAndDownload.js rel=nofollow class=svelte-7rw83y>https://gist.githubusercontent.com/magasine/ef7f1767a9044beae406bde315e513cc/raw/e0ecb4b3155b514277158f9af458415c5ecf41b9/ClickAndDownload.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript> <span class="hljs-title function_">void</span>(<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
     <span class=hljs-comment>// Mostrar prompt para seleção do tipo de download</span>
     <span class=hljs-keyword>var</span> format = <span class="hljs-title function_">prompt</span>(
         <span class=hljs-string>"Selecione o tipo de download:\n\n1. Texto\n2. HTML\n3. JSON\n4. CSV\n5. Imagem\n6. Vídeo\n\nDigite o número correspondente:"</span>,
         <span class=hljs-string>"1"</span>
     );

     <span class=hljs-comment>// Mapear opções</span>
     <span class=hljs-keyword>var</span> formatMap = {
         <span class=hljs-number>1</span>: <span class=hljs-string>"text"</span>,
         <span class=hljs-number>2</span>: <span class=hljs-string>"html"</span>,
         <span class=hljs-number>3</span>: <span class=hljs-string>"json"</span>,
         <span class=hljs-number>4</span>: <span class=hljs-string>"csv"</span>,
         <span class=hljs-number>5</span>: <span class=hljs-string>"image"</span>,
         <span class=hljs-number>6</span>: <span class=hljs-string>"video"</span>,
     };

     <span class=hljs-comment>// Se o usuário cancelou, não fazer nada</span>
     <span class=hljs-keyword>if</span> (format === <span class=hljs-literal>null</span>) <span class=hljs-keyword>return</span>;

     <span class=hljs-comment>// Validar a escolha</span>
     <span class=hljs-keyword>if</span> (!formatMap[format]) {
         <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Opção inválida. Use um número de 1 a 6."</span>);
         <span class=hljs-keyword>return</span>;
     }

     <span class=hljs-keyword>var</span> selectedFormat = formatMap[format];

     <span class=hljs-comment>// Função para fazer download do conteúdo</span>
     <span class=hljs-keyword>function</span> <span class="hljs-title function_">downloadContent</span>(<span class=hljs-params>content, filename, type = <span class=hljs-string>"text/plain"</span></span>) {
         <span class=hljs-keyword>const</span> blob = <span class=hljs-keyword>new</span> <span class="hljs-title class_">Blob</span>([content], {
             <span class=hljs-attr>type</span>: <span class=hljs-string>`<span class=hljs-subst>${type}</span>;charset=utf-8`</span>
         });
         <span class=hljs-keyword>const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
         <span class=hljs-keyword>const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"a"</span>);
         a.<span class=hljs-property>href</span> = url;
         a.<span class=hljs-property>download</span> = filename;
         <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(a);
         a.<span class="hljs-title function_">click</span>();
         <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> {
             <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">removeChild</span>(a);
             <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(url);
         }, <span class=hljs-number>100</span>);
     }

     <span class=hljs-comment>// Função para fazer download de mídia (imagem/vídeo)</span>
     <span class=hljs-keyword>function</span> <span class="hljs-title function_">downloadMedia</span>(<span class=hljs-params>src, filename</span>) {
         <span class=hljs-keyword>const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"a"</span>);
         a.<span class=hljs-property>href</span> = src;
         a.<span class=hljs-property>download</span> = filename;
         <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(a);
         a.<span class="hljs-title function_">click</span>();
         <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> {
             <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">removeChild</span>(a);
         }, <span class=hljs-number>100</span>);
     }

     <span class=hljs-comment>// Criar overlay para seleção de elemento</span>
     <span class=hljs-keyword>var</span> overlay = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"div"</span>);
     <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(overlay.<span class=hljs-property>style</span>, {
         <span class=hljs-attr>position</span>: <span class=hljs-string>"fixed"</span>,
         <span class=hljs-attr>top</span>: <span class=hljs-number>0</span>,
         <span class=hljs-attr>left</span>: <span class=hljs-number>0</span>,
         <span class=hljs-attr>width</span>: <span class=hljs-string>"100vw"</span>,
         <span class=hljs-attr>height</span>: <span class=hljs-string>"100vh"</span>,
         <span class=hljs-attr>zIndex</span>: <span class=hljs-number>99999999</span>,
         <span class=hljs-attr>background</span>: <span class=hljs-string>"transparent"</span>,
         <span class=hljs-attr>cursor</span>: <span class=hljs-string>"crosshair"</span>,
     });

     <span class=hljs-keyword>var</span> highlightBox = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"div"</span>);
     <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(highlightBox.<span class=hljs-property>style</span>, {
         <span class=hljs-attr>position</span>: <span class=hljs-string>"fixed"</span>,
         <span class=hljs-attr>background</span>: <span class=hljs-string>"rgba(0, 128, 255, 0.25)"</span>,
         <span class=hljs-attr>outline</span>: <span class=hljs-string>"1px solid rgba(0, 128, 255, 0.5)"</span>,
         <span class=hljs-attr>pointerEvents</span>: <span class=hljs-string>"none"</span>,
         <span class=hljs-attr>zIndex</span>: <span class=hljs-number>99999998</span>,
         <span class=hljs-attr>display</span>: <span class=hljs-string>"none"</span>,
     });

     <span class=hljs-comment>// Painel de informação</span>
     <span class=hljs-keyword>var</span> infoPanel = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>"div"</span>);
     <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(infoPanel.<span class=hljs-property>style</span>, {
         <span class=hljs-attr>position</span>: <span class=hljs-string>"fixed"</span>,
         <span class=hljs-attr>top</span>: <span class=hljs-string>"10px"</span>,
         <span class=hljs-attr>left</span>: <span class=hljs-string>"10px"</span>,
         <span class=hljs-attr>background</span>: <span class=hljs-string>"rgba(0, 0, 0, 0.7)"</span>,
         <span class=hljs-attr>color</span>: <span class=hljs-string>"white"</span>,
         <span class=hljs-attr>padding</span>: <span class=hljs-string>"8px 12px"</span>,
         <span class=hljs-attr>borderRadius</span>: <span class=hljs-string>"4px"</span>,
         <span class=hljs-attr>fontSize</span>: <span class=hljs-string>"14px"</span>,
         <span class=hljs-attr>zIndex</span>: <span class=hljs-number>100000000</span>,
         <span class=hljs-attr>pointerEvents</span>: <span class=hljs-string>"none"</span>,
     });

     infoPanel.<span class=hljs-property>textContent</span> = <span class=hljs-string>`Modo: <span class=hljs-subst>${selectedFormat.toUpperCase()}</span> - Clique em um elemento para baixar`</span>;

     <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">append</span>(overlay);
     <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">append</span>(highlightBox);
     <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">append</span>(infoPanel);

     <span class=hljs-comment>// Evento de movimento do mouse para destacar elementos</span>
     <span class=hljs-keyword>function</span> <span class="hljs-title function_">handleMouseMove</span>(<span class=hljs-params>e</span>) {
         <span class=hljs-comment>// Obter elemento sob o cursor</span>
         overlay.<span class=hljs-property>style</span>.<span class=hljs-property>pointerEvents</span> = <span class=hljs-string>"none"</span>;
         <span class=hljs-keyword>var</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">elementFromPoint</span>(e.<span class=hljs-property>clientX</span>, e.<span class=hljs-property>clientY</span>);
         overlay.<span class=hljs-property>style</span>.<span class=hljs-property>pointerEvents</span> = <span class=hljs-string>"auto"</span>;

         <span class=hljs-keyword>if</span> (
             element &amp;&amp;
             element !== overlay &amp;&amp;
             element !== highlightBox &amp;&amp;
             element !== infoPanel
         ) {
             <span class=hljs-keyword>var</span> rect = element.<span class="hljs-title function_">getBoundingClientRect</span>();
             <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(highlightBox.<span class=hljs-property>style</span>, {
                 <span class=hljs-attr>display</span>: <span class=hljs-string>"block"</span>,
                 <span class=hljs-attr>top</span>: rect.<span class=hljs-property>top</span> + <span class=hljs-string>"px"</span>,
                 <span class=hljs-attr>left</span>: rect.<span class=hljs-property>left</span> + <span class=hljs-string>"px"</span>,
                 <span class=hljs-attr>width</span>: rect.<span class=hljs-property>width</span> + <span class=hljs-string>"px"</span>,
                 <span class=hljs-attr>height</span>: rect.<span class=hljs-property>height</span> + <span class=hljs-string>"px"</span>,
             });
         } <span class=hljs-keyword>else</span> {
             highlightBox.<span class=hljs-property>style</span>.<span class=hljs-property>display</span> = <span class=hljs-string>"none"</span>;
         }
     }

     <span class=hljs-comment>// Evento de clique para processar o download</span>
     <span class=hljs-keyword>function</span> <span class="hljs-title function_">handleClick</span>(<span class=hljs-params>e</span>) {
         <span class=hljs-comment>// Obter elemento sob o cursor</span>
         overlay.<span class=hljs-property>style</span>.<span class=hljs-property>pointerEvents</span> = <span class=hljs-string>"none"</span>;
         <span class=hljs-keyword>var</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">elementFromPoint</span>(e.<span class=hljs-property>clientX</span>, e.<span class=hljs-property>clientY</span>);
         overlay.<span class=hljs-property>style</span>.<span class=hljs-property>pointerEvents</span> = <span class=hljs-string>"auto"</span>;

         <span class=hljs-keyword>if</span> (
             element &amp;&amp;
             element !== overlay &amp;&amp;
             element !== highlightBox &amp;&amp;
             element !== infoPanel
         ) {
             <span class=hljs-comment>// Gerar nome de arquivo com base no conteúdo</span>
             <span class=hljs-keyword>var</span> firstLine = (element.<span class=hljs-property>textContent</span> || <span class=hljs-string>""</span>).<span class="hljs-title function_">split</span>(<span class=hljs-string>"\n"</span>)[<span class=hljs-number>0</span>] || <span class=hljs-string>""</span>;
             <span class=hljs-keyword>var</span> baseFilename =
                 firstLine
                 .<span class="hljs-title function_">substring</span>(<span class=hljs-number>0</span>, <span class=hljs-number>30</span>)
                 .<span class="hljs-title function_">replace</span>(<span class=hljs-regexp>/[^a-z0-9]/gi</span>, <span class=hljs-string>"_"</span>)
                 .<span class="hljs-title function_">toLowerCase</span>() || <span class=hljs-string>"conteudo"</span>;

             <span class=hljs-comment>// Processar conforme o formato selecionado</span>
             <span class=hljs-keyword>switch</span> (selectedFormat) {
                 <span class=hljs-keyword>case</span> <span class=hljs-string>"text"</span>:
                     <span class=hljs-keyword>var</span> text = element.<span class=hljs-property>textContent</span> || element.<span class=hljs-property>value</span> || <span class=hljs-string>""</span>;
                     text = text
                         .<span class="hljs-title function_">replace</span>(<span class=hljs-regexp>/\n[ \n]+\n/g</span>, <span class=hljs-string>"\n"</span>)
                         .<span class="hljs-title function_">replace</span>(<span class=hljs-regexp>/\n\n+/g</span>, <span class=hljs-string>"\n\n"</span>)
                         .<span class="hljs-title function_">replace</span>(<span class=hljs-regexp>/^\n+|\n+$/g</span>, <span class=hljs-string>""</span>);
                     <span class="hljs-title function_">downloadContent</span>(text, baseFilename + <span class=hljs-string>".txt"</span>, <span class=hljs-string>"text/plain"</span>);
                     <span class=hljs-keyword>break</span>;

                 <span class=hljs-keyword>case</span> <span class=hljs-string>"html"</span>:
                     <span class="hljs-title function_">downloadContent</span>(
                         element.<span class=hljs-property>innerHTML</span>,
                         baseFilename + <span class=hljs-string>".html"</span>,
                         <span class=hljs-string>"text/html"</span>
                     );
                     <span class=hljs-keyword>break</span>;

                 <span class=hljs-keyword>case</span> <span class=hljs-string>"json"</span>:
                     <span class=hljs-keyword>try</span> {
                         <span class=hljs-keyword>var</span> jsonContent = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(element.<span class=hljs-property>textContent</span>.<span class="hljs-title function_">trim</span>());
                         <span class="hljs-title function_">downloadContent</span>(
                             <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(jsonContent, <span class=hljs-literal>null</span>, <span class=hljs-number>2</span>),
                             baseFilename + <span class=hljs-string>".json"</span>,
                             <span class=hljs-string>"application/json"</span>
                         );
                     } <span class=hljs-keyword>catch</span> (e) {
                         <span class=hljs-comment>// Se não for JSON válido, criar um objeto JSON com o texto</span>
                         <span class="hljs-title function_">downloadContent</span>(
                             <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
                                 <span class=hljs-attr>content</span>: element.<span class=hljs-property>textContent</span>
                             }, <span class=hljs-literal>null</span>, <span class=hljs-number>2</span>),
                             baseFilename + <span class=hljs-string>".json"</span>,
                             <span class=hljs-string>"application/json"</span>
                         );
                     }
                     <span class=hljs-keyword>break</span>;

                 <span class=hljs-keyword>case</span> <span class=hljs-string>"csv"</span>:
                     <span class=hljs-keyword>var</span> text = element.<span class=hljs-property>textContent</span> || element.<span class=hljs-property>value</span> || <span class=hljs-string>""</span>;
                     <span class="hljs-title function_">downloadContent</span>(text, baseFilename + <span class=hljs-string>".csv"</span>, <span class=hljs-string>"text/csv"</span>);
                     <span class=hljs-keyword>break</span>;

                 <span class=hljs-keyword>case</span> <span class=hljs-string>"image"</span>:
                     <span class=hljs-comment>// Verificar se é uma tag de imagem ou tem background image</span>
                     <span class=hljs-keyword>if</span> (element.<span class=hljs-property>tagName</span> === <span class=hljs-string>"IMG"</span>) {
                         <span class="hljs-title function_">downloadMedia</span>(element.<span class=hljs-property>src</span>, baseFilename + <span class=hljs-string>".jpg"</span>);
                     } <span class=hljs-keyword>else</span> {
                         <span class=hljs-keyword>var</span> style = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(element);
                         <span class=hljs-keyword>var</span> bgImage = style.<span class=hljs-property>backgroundImage</span>;
                         <span class=hljs-keyword>if</span> (bgImage &amp;&amp; bgImage !== <span class=hljs-string>"none"</span>) {
                             <span class=hljs-keyword>var</span> urlMatch = bgImage.<span class="hljs-title function_">match</span>(<span class=hljs-regexp>/url\(["']?(.*?)["']?\)/</span>);
                             <span class=hljs-keyword>if</span> (urlMatch &amp;&amp; urlMatch[<span class=hljs-number>1</span>]) {
                                 <span class="hljs-title function_">downloadMedia</span>(urlMatch[<span class=hljs-number>1</span>], baseFilename + <span class=hljs-string>".jpg"</span>);
                             }
                         } <span class=hljs-keyword>else</span> {
                             <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Elemento não contém uma imagem detectável."</span>);
                         }
                     }
                     <span class=hljs-keyword>break</span>;

                 <span class=hljs-keyword>case</span> <span class=hljs-string>"video"</span>:
                     <span class=hljs-comment>// Verificar se é uma tag de vídeo</span>
                     <span class=hljs-keyword>if</span> (element.<span class=hljs-property>tagName</span> === <span class=hljs-string>"VIDEO"</span>) {
                         <span class=hljs-keyword>if</span> (element.<span class=hljs-property>src</span>) {
                             <span class="hljs-title function_">downloadMedia</span>(element.<span class=hljs-property>src</span>, baseFilename + <span class=hljs-string>".mp4"</span>);
                         } <span class=hljs-keyword>else</span> {
                             <span class=hljs-comment>// Tentar encontrar a source do vídeo</span>
                             <span class=hljs-keyword>var</span> source = element.<span class="hljs-title function_">querySelector</span>(<span class=hljs-string>"source"</span>);
                             <span class=hljs-keyword>if</span> (source &amp;&amp; source.<span class=hljs-property>src</span>) {
                                 <span class="hljs-title function_">downloadMedia</span>(source.<span class=hljs-property>src</span>, baseFilename + <span class=hljs-string>".mp4"</span>);
                             } <span class=hljs-keyword>else</span> {
                                 <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Não foi possível encontrar a fonte do vídeo."</span>);
                             }
                         }
                     } <span class=hljs-keyword>else</span> {
                         <span class="hljs-title function_">alert</span>(<span class=hljs-string>"Elemento não é um vídeo."</span>);
                     }
                     <span class=hljs-keyword>break</span>;
             }

             <span class=hljs-comment>// Remover os elementos da overlay</span>
             <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">removeChild</span>(overlay);
             <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">removeChild</span>(highlightBox);
             <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">removeChild</span>(infoPanel);
             <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"mousemove"</span>, handleMouseMove);
             overlay.<span class="hljs-title function_">removeEventListener</span>(<span class=hljs-string>"click"</span>, handleClick);
         }
     }

     <span class=hljs-comment>// Adicionar event listeners</span>
     <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"mousemove"</span>, handleMouseMove);
     overlay.<span class="hljs-title function_">addEventListener</span>(<span class=hljs-string>"click"</span>, handleClick);
 })();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#data:text/javascript,%2F%2F%20%40name%20CDA%20Press%20%26%20Daily%20Bee%20-%20Add%20Article%20Credits%0A%2F%2F%20%40description%20Add%20additional%20free%20article%20credits%20to%20cdapress.com%20and%20bonnercountydailybee.com%0A%0Ajavascript%3A(function()%7Bif(document.location.host%20%3D%3D%3D%20%22bonnercountydailybee.com%22%20%7C%7C%20document.location.host%20%3D%3D%3D%20%22cdapress.com%22)%7Bdocument.cookie%3D%22content_meter%3D-9999%3B%20path%3D%2F%22%7D%7D)()%3B title="CDA Press &amp; Daily Bee - Add Article Credits" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>CDA Press &amp; Daily Bee - Add Article Credits</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">CDA Press &amp; Daily Bee - Add Article Credits</span></div></div></a> <a href=data:text/javascript,%2F%2F%20%40name%20CDA%20Press%20%26%20Daily%20Bee%20-%20Add%20Article%20Credits%0A%2F%2F%20%40description%20Add%20additional%20free%20article%20credits%20to%20cdapress.com%20and%20bonnercountydailybee.com%0A%0Ajavascript%3A(function()%7Bif(document.location.host%20%3D%3D%3D%20%22bonnercountydailybee.com%22%20%7C%7C%20document.location.host%20%3D%3D%3D%20%22cdapress.com%22)%7Bdocument.cookie%3D%22content_meter%3D-9999%3B%20path%3D%2F%22%7D%7D)()%3B class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Add additional free article credits to cdapress.com and bonnercountydailybee.com</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=data:text/javascript,%2F%2F%20%40name%20CDA%20Press%20%26%20Daily%20Bee%20-%20Add%20Article%20Credits%0A%2F%2F%20%40description%20Add%20additional%20free%20article%20credits%20to%20cdapress.com%20and%20bonnercountydailybee.com%0A%0Ajavascript%3A(function()%7Bif(document.location.host%20%3D%3D%3D%20%22bonnercountydailybee.com%22%20%7C%7C%20document.location.host%20%3D%3D%3D%20%22cdapress.com%22)%7Bdocument.cookie%3D%22content_meter%3D-9999%3B%20path%3D%2F%22%7D%7D)()%3B rel=nofollow class=svelte-7rw83y>data:text/javascript,// @name CDA Press &amp; Daily Bee - Add Article Credits
// @description Add additional free article credits to cdapress.com and bonnercountydailybee.com
javascript:(function(){if(document.location.host === "bonnercountydailybee.com" || document.location.host === "cdapress.com"){document.cookie="content_meter=-9999; path=/"}})();</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name CDA Press &amp; Daily Bee - Add Article Credits</span>
<span class=hljs-comment>// @description Add additional free article credits to cdapress.com and bonnercountydailybee.com</span>

<span class=hljs-attr>javascript</span>: (<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>if</span> (<span class="hljs-variable language_">document</span>.<span class=hljs-property>location</span>.<span class=hljs-property>host</span> === <span class=hljs-string>"bonnercountydailybee.com"</span> || <span class="hljs-variable language_">document</span>.<span class=hljs-property>location</span>.<span class=hljs-property>host</span> === <span class=hljs-string>"cdapress.com"</span>) {
        <span class="hljs-variable language_">document</span>.<span class=hljs-property>cookie</span> = <span class=hljs-string>"content_meter=-9999; path=/"</span>
    }
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div><div class="box svelte-1dueqvt"><article class=svelte-7rw83y><div class="title_row svelte-7rw83y"><div class="title svelte-7rw83y"><a href=https://getbookmarklets.com/scripts#https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/link%20to%20text%20fragment.js title="Link to selected text" data-sveltekit-preload-data=tap class=svelte-7rw83y><h1 class=svelte-7rw83y>Link to selected text</h1></a></div> <div class="install svelte-nfnxt8"><a href=javascript:void(0) class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="label svelte-nfnxt8"></span> <span class="name svelte-nfnxt8">Link to selected text</span></div></div></a> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/link%20to%20text%20fragment.js class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div disabled class=svelte-unqhbb>Install as Userscript</div></div></a> <a class=svelte-1xwhxdh><div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><div class=svelte-unqhbb disabled><span class="share-icon svelte-nfnxt8 sf-hidden">🔗</span> Share</div></div></a></div></div> <p class=svelte-7rw83y>Creates a link that scrolls to the selected text on the page, and copies it to the clipboard.</p> <div class="source_url svelte-7rw83y"><span class=svelte-7rw83y>Source URL:</span> <a href=https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/link%20to%20text%20fragment.js rel=nofollow class=svelte-7rw83y>https://raw.githubusercontent.com/madacol/web-automation/master/bookmarklets/link to text fragment.js</a></div> <details class="script-details svelte-27attn"><template shadowrootmode=closed><slot name=internal-main-summary><summary>Details</summary></slot><slot></slot></template><summary class=source>Source code</summary> <div class="source_editor svelte-1udr1bn"><div class="source svelte-1udr1bn"><pre class=svelte-1udr1bn><code class=language-javascript><span class=hljs-comment>// @name Link to selected text</span>
<span class=hljs-comment>// @description Creates a link that scrolls to the selected text on the page, and copies it to the clipboard.</span>

(<span class=hljs-keyword>function</span>(<span class=hljs-params></span>) {
    <span class=hljs-keyword>const</span> selection = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>().<span class="hljs-title function_">getRangeAt</span>(<span class=hljs-number>0</span>).<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">trim</span>();
    <span class=hljs-keyword>if</span> (!selection) {
        <span class=hljs-keyword>return</span> <span class="hljs-title function_">alert</span>(<span class=hljs-string>'Please select some text on the page.'</span>);
    }
    <span class=hljs-keyword>const</span> baseUri = <span class="hljs-variable language_">window</span>.<span class=hljs-property>location</span>.<span class=hljs-property>href</span>.<span class="hljs-title function_">split</span>(<span class=hljs-string>'#'</span>)[<span class=hljs-number>0</span>];
    <span class=hljs-keyword>const</span> newUrl = <span class=hljs-string>`<span class=hljs-subst>${baseUri}</span>#:~:text=<span class=hljs-subst>${<span class=hljs-built_in>encodeURIComponent</span>(selection)}</span>`</span>;

    <span class=hljs-comment>// Copy selected text to clipboard</span>
    navigator.<span class=hljs-property>clipboard</span>.<span class="hljs-title function_">writeText</span>(newUrl)
        .<span class="hljs-title function_">then</span>(<span class=hljs-function>() =&gt;</span> {
            <span class=hljs-keyword>const</span> modal = <span class="hljs-title function_">showModal</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(<span class=hljs-string>`Copied to clipboard`</span>));
            <span class=hljs-built_in>setTimeout</span>(<span class=hljs-function>() =&gt;</span> modal.<span class="hljs-title function_">remove</span>(), <span class=hljs-number>2000</span>);
        })

    <span class=hljs-keyword>function</span> <span class="hljs-title function_">showModal</span>(<span class=hljs-params>HtmlContent</span>) {
        <span class=hljs-keyword>const</span> modal = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class=hljs-string>'dialog'</span>);
        modal.<span class="hljs-title function_">appendChild</span>(<span class="hljs-title class_">HtmlContent</span>);
        <span class="hljs-variable language_">document</span>.<span class=hljs-property>body</span>.<span class="hljs-title function_">appendChild</span>(modal);
        modal.<span class="hljs-title function_">showModal</span>();
        <span class=hljs-comment>// close modal when clicking outside its content</span>
        modal.<span class=hljs-property>onclick</span> = <span class=hljs-function><span class=hljs-params>e</span> =&gt;</span> {
            <span class=hljs-keyword>if</span> (e.<span class=hljs-property>target</span> === modal) modal.<span class="hljs-title function_">remove</span>();
        };
        <span class=hljs-keyword>return</span> modal
    }
})();</code></pre> <button type=button class=svelte-1udr1bn>Copy code</button></div> <div style=display:contents;--background-color:var(--primary-color);--background-hover-color:var(--primary-hover-color);--color:white;--darkreader-bg--background-color:var(--darkreader-bg--primary-color);--darkreader-text--color:var(--darkreader-text-ffffff,#e8e6e3);--darkreader-bg--background-hover-color:var(--darkreader-bg--primary-hover-color)><button type=button class=svelte-rcq3hf>🖉 Edit</button></div></div></details></article></div></div></div></div> <footer class=svelte-139cmml><div class="social svelte-139cmml"><a href=https://github.com/madacol/getbookmarklets class=svelte-139cmml>Github</a></div></footer> <div id=svelte-announcer aria-live=assertive aria-atomic=true style="position:absolute;left:0;top:0;clip:rect(0 0 0 0);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px"></div>
 
 
 </div>
 
<div class=altq-root><div class=qr-toast></div></div><protonpass-root-fb24 data-protonpass-role=root data-protonpass-theme=dark><template shadowrootmode=closed></template></protonpass-root-fb24><div class="autocopy-notification hide sf-hidden"></div><div style=position:fixed;z-index:2147483647;opacity:0.9;display:none;top:10px;right:10px><template shadowrootmode=open><style class="darkreader darkreader--inline" media=screen>[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-border-short] {
  border: var(--darkreader-inline-border-short) !important;
}
[data-darkreader-inline-border-bottom-short] {
  border-bottom: var(--darkreader-inline-border-bottom-short) !important;
}
[data-darkreader-inline-border-left-short] {
  border-left: var(--darkreader-inline-border-left-short) !important;
}
[data-darkreader-inline-border-right-short] {
  border-right: var(--darkreader-inline-border-right-short) !important;
}
[data-darkreader-inline-border-top-short] {
  border-top: var(--darkreader-inline-border-top-short) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--override" media=screen>.vimvixen-hint {
    background-color: var(--darkreader-background-ffd76e, #684b00) !important;
    border-color: var(--darkreader-background-c59d00, #9e7e00) !important;
    color: var(--darkreader-text-302505, #d7d4cf) !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: var(--darkreader-background-add8e6, #1b4958) !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: var(--darkreader-background-cfecf5, #0f3a47) !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: var(--darkreader-background-f5f5f5, #1e2021) !important;
}
.tou-uknfeu {
    background-color: var(--darkreader-background-faedda, #432c09) !important;
}
.tou-6i3zyv {
    background-color: var(--darkreader-background-85c3d8, #245d70) !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
select {
    --darkreader-bg--form-control-background-color: rgba(22, 22, 22, 0) !important;
}
select * {
    background-color: var(--darkreader-neutral-background) !important;
}
body#tumblr {
    --darkreader-bg--secondary-accent: 31, 32, 34 !important;
    --darkreader-bg--white: 23, 23, 23 !important;
    --darkreader-text--black: 228, 224, 218 !important;
}
:host {
    --d2l-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-button-icon-background-color-hover: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-color-ferrite: var(--darkreader-neutral-text) !important;
    --d2l-color-sylvite: var(--darkreader-bg--d2l-color-sylvite) !important;
    --d2l-dropdown-background-color: var(--darkreader-neutral-background) !important;
    --d2l-dropdown-border-color: var(--darkreader-border--d2l-color-mica) !important;
    --d2l-input-backgroud-color: var(--darkreader-neutral-background) !important;
    --d2l-menu-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-tooltip-background-color: var(--darkreader-neutral-background) !important;
    --d2l-tooltip-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
:host([_floating]) .d2l-floating-buttons-container {
    background-color: var(--darkreader-neutral-background) !important;
    border-top-color: var(--darkreader-border--d2l-color-mica) !important;
    opacity: 0.88 !important;
}
d2l-card {
    background: var(--darkreader-neutral-background) !important;
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
d2l-dropdown-content > div,
d2l-menu-item {
    background-color: var(--darkreader-neutral-background) !important;
    border-radius: 10px !important;
}
d2l-empty-state-simple {
    border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-button-filter > ul > li > a.vui-button {
    border-color: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-label-text:has(.d2l-button-subtle-content):hover,
.d2l-label-text:has(.d2l-button-subtle-content):focus,
.d2l-label-text:has(.d2l-button-subtle-content):active {
    background-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-navigation-centerer {
    color: inherit !important;
}
.d2l-tabs-layout {
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
.d2l-input,
.d2l-calendar-date,
.d2l-htmleditor-container {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-collapsible-panel {
    border: 1px solid var(--darkreader-border--d2l-color-mica) !important;
    border-radius: 0.4rem !important;
}
.d2l-collapsible-panel-divider {
    border-bottom: 1px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-w2d-flex {
    border-bottom: 2px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-collapsible-panel scrolled,
.d2l-collapsible-panel-header,
.d2l-w2d-collection-fixed {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-loading-spinner-bg {
    fill: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-loading-spinner-bg-stroke {
    stroke: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-loading-spinner-wrapper svg path,
.d2l-loading-spinner-wrapper svg circle {
    fill: var(--darkreader-neutral-background) !important;
}
embed[type="application/pdf"] { filter: invert(100%) contrast(90%); }</style><style class="darkreader darkreader--invert" media=screen>.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, img.Wirisformula, a[data-testid="headerMediumLogo"]>svg, .d2l-navigation-link-image-container, .d2l-iframe-loading-container {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><div data-shown=true class=sf-hidden><style>.number-indicator{position:relative;background:rgb(0 0 0/80%)!important}.number-indicator::after{content:attr(data-number);position:absolute;bottom:0;right:0;color:#40a9ff;font-size:14px;font-weight:bold;background:rgb(0 0 0/80%);border-radius:10px;padding:3px 5px}.copy-link:active{color:#ccc}.download-btn:hover{text-decoration:none}.download-btn:active{opacity:0.9}.m3u8-item{color:white;font-family:"Arial";margin-bottom:5px;display:flex;flex-direction:row;background:rgb(0 0 0/80%);padding:3px 10px;border-radius:3px;font-size:13px;user-select:none}[data-shown="false"]{opacity:0.8;zoom:0.8}[data-shown="false"]:hover{opacity:1}[data-shown="false"] .m3u8-item{display:none}</style></div></template></div><div><template shadowrootmode=closed><style class=sf-hidden>;</style><style class=sf-hidden>;</style><style class=sf-hidden>;</style></template></div><div data-wordglance style=position:fixed;top:0px;left:0px;width:0px;height:0px;z-index:999999;pointer-events:none><template shadowrootmode=open><style class="darkreader darkreader--inline sf-hidden" media=screen>[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-border-short] {
  border: var(--darkreader-inline-border-short) !important;
}
[data-darkreader-inline-border-bottom-short] {
  border-bottom: var(--darkreader-inline-border-bottom-short) !important;
}
[data-darkreader-inline-border-left-short] {
  border-left: var(--darkreader-inline-border-left-short) !important;
}
[data-darkreader-inline-border-right-short] {
  border-right: var(--darkreader-inline-border-right-short) !important;
}
[data-darkreader-inline-border-top-short] {
  border-top: var(--darkreader-inline-border-top-short) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--override sf-hidden" media=screen>.vimvixen-hint {
    background-color: var(--darkreader-background-ffd76e, #684b00) !important;
    border-color: var(--darkreader-background-c59d00, #9e7e00) !important;
    color: var(--darkreader-text-302505, #d7d4cf) !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: var(--darkreader-background-add8e6, #1b4958) !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: var(--darkreader-background-cfecf5, #0f3a47) !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: var(--darkreader-background-f5f5f5, #1e2021) !important;
}
.tou-uknfeu {
    background-color: var(--darkreader-background-faedda, #432c09) !important;
}
.tou-6i3zyv {
    background-color: var(--darkreader-background-85c3d8, #245d70) !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
select {
    --darkreader-bg--form-control-background-color: rgba(22, 22, 22, 0) !important;
}
select * {
    background-color: var(--darkreader-neutral-background) !important;
}
body#tumblr {
    --darkreader-bg--secondary-accent: 31, 32, 34 !important;
    --darkreader-bg--white: 23, 23, 23 !important;
    --darkreader-text--black: 228, 224, 218 !important;
}
:host {
    --d2l-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-button-icon-background-color-hover: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-color-ferrite: var(--darkreader-neutral-text) !important;
    --d2l-color-sylvite: var(--darkreader-bg--d2l-color-sylvite) !important;
    --d2l-dropdown-background-color: var(--darkreader-neutral-background) !important;
    --d2l-dropdown-border-color: var(--darkreader-border--d2l-color-mica) !important;
    --d2l-input-backgroud-color: var(--darkreader-neutral-background) !important;
    --d2l-menu-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-tooltip-background-color: var(--darkreader-neutral-background) !important;
    --d2l-tooltip-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
:host([_floating]) .d2l-floating-buttons-container {
    background-color: var(--darkreader-neutral-background) !important;
    border-top-color: var(--darkreader-border--d2l-color-mica) !important;
    opacity: 0.88 !important;
}
d2l-card {
    background: var(--darkreader-neutral-background) !important;
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
d2l-dropdown-content > div,
d2l-menu-item {
    background-color: var(--darkreader-neutral-background) !important;
    border-radius: 10px !important;
}
d2l-empty-state-simple {
    border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-button-filter > ul > li > a.vui-button {
    border-color: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-label-text:has(.d2l-button-subtle-content):hover,
.d2l-label-text:has(.d2l-button-subtle-content):focus,
.d2l-label-text:has(.d2l-button-subtle-content):active {
    background-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-navigation-centerer {
    color: inherit !important;
}
.d2l-tabs-layout {
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
.d2l-input,
.d2l-calendar-date,
.d2l-htmleditor-container {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-collapsible-panel {
    border: 1px solid var(--darkreader-border--d2l-color-mica) !important;
    border-radius: 0.4rem !important;
}
.d2l-collapsible-panel-divider {
    border-bottom: 1px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-w2d-flex {
    border-bottom: 2px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-collapsible-panel scrolled,
.d2l-collapsible-panel-header,
.d2l-w2d-collection-fixed {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-loading-spinner-bg {
    fill: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-loading-spinner-bg-stroke {
    stroke: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-loading-spinner-wrapper svg path,
.d2l-loading-spinner-wrapper svg circle {
    fill: var(--darkreader-neutral-background) !important;
}
embed[type="application/pdf"] { filter: invert(100%) contrast(90%); }</style><style class="darkreader darkreader--invert sf-hidden" media=screen>.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, img.Wirisformula, a[data-testid="headerMediumLogo"]>svg, .d2l-navigation-link-image-container, .d2l-iframe-loading-container {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><style class=sf-hidden>.wordglance-tooltip{position:absolute;background:#ffffff;border:1px solid #e0e0e0;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15);padding:16px;max-width:320px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;font-size:14px;line-height:1.5;display:none;pointer-events:auto;transition:opacity 0.3s ease,transform 0.3s ease;word-wrap:break-word;overflow-wrap:break-word;opacity:0;transform:translateY(-10px) scale(0.95);will-change:transform,opacity;color:#2c3e50;contain:layout style paint;z-index:99999}.wordglance-tooltip.show{opacity:1;transform:translateY(0) scale(1)}.wordglance-tooltip.dark-mode{background:#1a1a1a;border-color:#333333;color:#e0e0e0;box-shadow:0 4px 12px rgba(0,0,0,0.4)}.wordglance-trigger-icon{position:absolute;background:#3498db;color:white;border:none;border-radius:50%;width:24px;height:24px;font-size:12px;cursor:pointer;display:none;box-shadow:0 2px 8px rgba(0,0,0,0.2);transition:transform 0.25s ease,background-color 0.25s ease;font-weight:bold;opacity:0;transform:scale(0.8);will-change:transform,opacity;pointer-events:auto;z-index:9999}@media (hover:none) and (pointer:coarse){.wordglance-trigger-icon{width:32px;height:32px;font-size:16px}}.wordglance-trigger-icon.show{opacity:1;transform:scale(1)}.wordglance-trigger-icon:hover{background:#2980b9;transform:scale(1.1)}.wordglance-trigger-icon.dark-mode{background:#ff6b6b}.wordglance-trigger-icon.dark-mode:hover{background:#ff5252}.wordglance-tooltip .definition-section{margin-bottom:16px}.wordglance-tooltip .translation-section{margin-bottom:0}.wordglance-tooltip .section-title{font-weight:600;color:#2c3e50;margin-bottom:8px;font-size:12px;text-transform:uppercase;letter-spacing:0.5px;display:flex;justify-content:space-between;align-items:center}.wordglance-tooltip.dark-mode .section-title{color:#cccccc}.wordglance-tooltip .slider-controls{display:flex;gap:4px;align-items:center}.wordglance-tooltip .slider-button{background:none;border:none;border-radius:3px;width:20px;height:20px;font-size:12px;cursor:pointer;color:#7f8c8d;display:flex;align-items:center;justify-content:center;transition:color 0.2s}.wordglance-tooltip .slider-button:hover{color:#2c3e50}.wordglance-tooltip .slider-button:disabled{opacity:0.4;cursor:not-allowed}.wordglance-tooltip.dark-mode .slider-button{color:#cccccc}.wordglance-tooltip.dark-mode .slider-button:hover:not(:disabled){color:#ffffff}.wordglance-tooltip .slider-info{font-size:11px;color:#7f8c8d;margin:0 4px;white-space:nowrap}.wordglance-tooltip .content-container{position:relative;overflow:hidden;height:auto;transition:height 0.4s cubic-bezier(0.25,0.46,0.45,0.94);will-change:height}.wordglance-tooltip .content-slider{display:flex;transition:transform 0.3s ease;width:100%;height:auto;will-change:transform}.wordglance-tooltip .content-page{min-width:100%;max-width:100%;flex-shrink:0;word-wrap:break-word;overflow-wrap:break-word;box-sizing:border-box;height:auto}.wordglance-tooltip .definition-item{margin-bottom:8px;padding-bottom:8px;border-bottom:1px solid #f8f9fa;word-wrap:break-word;overflow-wrap:break-word}.wordglance-tooltip.dark-mode .definition-item{border-bottom-color:#333333}.wordglance-tooltip .definition-item:last-child{border-bottom:none;margin-bottom:0;padding-bottom:0}.wordglance-tooltip .part-of-speech{color:#7f8c8d;font-style:italic;font-size:12px;margin-right:8px}.wordglance-tooltip.dark-mode .part-of-speech{color:#cccccc}.wordglance-tooltip .definition-text{color:#2c3e50;margin-bottom:4px;word-wrap:break-word;overflow-wrap:break-word}.wordglance-tooltip.dark-mode .definition-text{color:#e0e0e0}.wordglance-tooltip .translation-item{margin-bottom:4px;word-wrap:break-word;overflow-wrap:break-word}.wordglance-tooltip .translation-grid{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;min-height:80px;position:relative;border-radius:4px;overflow:hidden}.wordglance-tooltip .translation-grid::before{content:"";position:absolute;top:50%;left:10%;right:10%;height:2px;background:#e0e0e0;transform:translateY(-1px);z-index:3}.wordglance-tooltip .translation-grid::after{content:"";position:absolute;top:5%;bottom:5%;left:50%;width:2px;background:#e0e0e0;transform:translateX(-1px);z-index:3}.wordglance-tooltip.dark-mode .translation-grid::before,.wordglance-tooltip.dark-mode .translation-grid::after{background:#333333}.wordglance-tooltip .translation-text{color:#27ae60;font-weight:500;font-size:14px;word-wrap:break-word;overflow-wrap:break-word;padding:12px 8px;display:flex;align-items:center;justify-content:center;text-align:center;min-height:20px;background:#ffffff;position:relative;z-index:2}.wordglance-tooltip.dark-mode .translation-text{color:#4fc3f7;background:#1a1a1a}.wordglance-tooltip .example{font-style:italic;color:#7f8c8d;font-size:12px;margin-top:4px}.wordglance-tooltip.dark-mode .example{color:#cccccc}.wordglance-tooltip .loading{color:#7f8c8d;font-style:italic}.wordglance-tooltip.dark-mode .loading{color:#cccccc}.wordglance-tooltip .error{color:#e74c3c;font-size:13px}.wordglance-tooltip.dark-mode .error{color:#ff6b6b}.wordglance-tooltip .info{color:rgb(0,60,170);font-size:14px;font-weight:600;text-align:center;padding:20px 16px;line-height:1.4;font-style:italic}.wordglance-tooltip.dark-mode .info{color:rgb(172,219,52)}.wordglance-tooltip .synonyms-antonyms-section{margin-top:12px}.wordglance-tooltip .synonyms,.wordglance-tooltip .antonyms{margin-top:4px}.wordglance-tooltip .synonyms-label,.wordglance-tooltip .antonyms-label{font-weight:600;color:#2c3e50}.wordglance-tooltip.dark-mode .synonyms-label,.wordglance-tooltip.dark-mode .antonyms-label{color:#cccccc}.wordglance-tooltip .synonyms-list,.wordglance-tooltip .antonyms-list{color:#7f8c8d;font-style:italic}.wordglance-tooltip.dark-mode .synonyms-list,.wordglance-tooltip.dark-mode .antonyms-list{color:#cccccc}</style><div class=wordglance-root style=position:fixed;pointer-events:none;top:0px;left:0px;width:100vw;height:100vh><button class=wordglance-trigger-icon aria-label="Look up word definition and translation" style=display:none>📖</button><div class=wordglance-tooltip style=display:none></div></div></template></div><contextsearch-widgets id=contextsearch-widgets style=--cs-zoom:2;--cs-scale:calc(1/var(--cs-zoom,1)*var(--cs-custom-scale,1))><template shadowrootmode=open><style class="darkreader darkreader--inline sf-hidden" media=screen>[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-border-short] {
  border: var(--darkreader-inline-border-short) !important;
}
[data-darkreader-inline-border-bottom-short] {
  border-bottom: var(--darkreader-inline-border-bottom-short) !important;
}
[data-darkreader-inline-border-left-short] {
  border-left: var(--darkreader-inline-border-left-short) !important;
}
[data-darkreader-inline-border-right-short] {
  border-right: var(--darkreader-inline-border-right-short) !important;
}
[data-darkreader-inline-border-top-short] {
  border-top: var(--darkreader-inline-border-top-short) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--override sf-hidden" media=screen>.vimvixen-hint {
    background-color: var(--darkreader-background-ffd76e, #684b00) !important;
    border-color: var(--darkreader-background-c59d00, #9e7e00) !important;
    color: var(--darkreader-text-302505, #d7d4cf) !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: var(--darkreader-background-add8e6, #1b4958) !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: var(--darkreader-background-cfecf5, #0f3a47) !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: var(--darkreader-background-f5f5f5, #1e2021) !important;
}
.tou-uknfeu {
    background-color: var(--darkreader-background-faedda, #432c09) !important;
}
.tou-6i3zyv {
    background-color: var(--darkreader-background-85c3d8, #245d70) !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
select {
    --darkreader-bg--form-control-background-color: rgba(22, 22, 22, 0) !important;
}
select * {
    background-color: var(--darkreader-neutral-background) !important;
}
body#tumblr {
    --darkreader-bg--secondary-accent: 31, 32, 34 !important;
    --darkreader-bg--white: 23, 23, 23 !important;
    --darkreader-text--black: 228, 224, 218 !important;
}
:host {
    --d2l-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-button-icon-background-color-hover: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-color-ferrite: var(--darkreader-neutral-text) !important;
    --d2l-color-sylvite: var(--darkreader-bg--d2l-color-sylvite) !important;
    --d2l-dropdown-background-color: var(--darkreader-neutral-background) !important;
    --d2l-dropdown-border-color: var(--darkreader-border--d2l-color-mica) !important;
    --d2l-input-backgroud-color: var(--darkreader-neutral-background) !important;
    --d2l-menu-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-tooltip-background-color: var(--darkreader-neutral-background) !important;
    --d2l-tooltip-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
:host([_floating]) .d2l-floating-buttons-container {
    background-color: var(--darkreader-neutral-background) !important;
    border-top-color: var(--darkreader-border--d2l-color-mica) !important;
    opacity: 0.88 !important;
}
d2l-card {
    background: var(--darkreader-neutral-background) !important;
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
d2l-dropdown-content > div,
d2l-menu-item {
    background-color: var(--darkreader-neutral-background) !important;
    border-radius: 10px !important;
}
d2l-empty-state-simple {
    border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-button-filter > ul > li > a.vui-button {
    border-color: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-label-text:has(.d2l-button-subtle-content):hover,
.d2l-label-text:has(.d2l-button-subtle-content):focus,
.d2l-label-text:has(.d2l-button-subtle-content):active {
    background-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-navigation-centerer {
    color: inherit !important;
}
.d2l-tabs-layout {
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
.d2l-input,
.d2l-calendar-date,
.d2l-htmleditor-container {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-collapsible-panel {
    border: 1px solid var(--darkreader-border--d2l-color-mica) !important;
    border-radius: 0.4rem !important;
}
.d2l-collapsible-panel-divider {
    border-bottom: 1px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-w2d-flex {
    border-bottom: 2px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-collapsible-panel scrolled,
.d2l-collapsible-panel-header,
.d2l-w2d-collection-fixed {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-loading-spinner-bg {
    fill: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-loading-spinner-bg-stroke {
    stroke: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-loading-spinner-wrapper svg path,
.d2l-loading-spinner-wrapper svg circle {
    fill: var(--darkreader-neutral-background) !important;
}
embed[type="application/pdf"] { filter: invert(100%) contrast(90%); }</style><style class="darkreader darkreader--invert sf-hidden" media=screen>.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, img.Wirisformula, a[data-testid="headerMediumLogo"]>svg, .d2l-navigation-link-image-container, .d2l-iframe-loading-container {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style>
 <style class=sf-hidden>:host{all:initial!important}</style></template></contextsearch-widgets><script data-template-shadow-root>(()=>{document.currentScript.remove();processNode(document);function processNode(node){node.querySelectorAll("template[shadowrootmode]").forEach(element=>{let shadowRoot = element.parentElement.shadowRoot;if (!shadowRoot) {try {shadowRoot=element.parentElement.attachShadow({mode:element.getAttribute("shadowrootmode"),delegatesFocus:element.getAttribute("shadowrootdelegatesfocus")!=null,clonable:element.getAttribute("shadowrootclonable")!=null,serializable:element.getAttribute("shadowrootserializable")!=null});shadowRoot.innerHTML=element.innerHTML;element.remove()} catch (error) {} if (shadowRoot) {processNode(shadowRoot)}}})}})()</script>